<?xml version="1.0" encoding="utf-8" ?>
<otrs_package version="1.1">
    <Name>ServiceImportExport</Name>
    <Version>6.0.0</Version>
    <Vendor>AddonsForOTRS</Vendor>
    <URL>https://otrsaddons.com/</URL>
    <License>GNU AFFERO GENERAL PUBLIC LICENSE Version 3, November 2007</License>
    <Description Lang="en">Provides ImportExportBackend for Service, SLA and Service2CustomerUsers.</Description>
    <Framework>6.0.x</Framework>
    <PackageRequired Version="5.0.1">ImportExport</PackageRequired>
	
    <CodeInstall Type="post">
    $Kernel::OM-&gt;Get('var::packagesetup::ServiceImportExport')-&gt;CodeInstall();
    
    </CodeInstall>
    <CodeUpgrade Type="post">
    $Kernel::OM-&gt;Get('var::packagesetup::ServiceImportExport')-&gt;CodeUpgrade();
    
    </CodeUpgrade>
    <CodeUninstall Type="pre">
    $Kernel::OM-&gt;Get('var::packagesetup::ServiceImportExport')-&gt;CodeUninstall();
    
    </CodeUninstall>
    <CodeReinstall Type="post">
    $Kernel::OM-&gt;Get('var::packagesetup::ServiceImportExport')-&gt;CodeReinstall();
    
    </CodeReinstall>
    <BuildDate>2015-11-17 12:18:37</BuildDate>
    <BuildHost>cvs.intra.cape-it.de</BuildHost>
    <Filelist>
        <File Location="Kernel/Config/Files/XML/ServiceImportExport.xml" Permission="644" Encode="Base64">PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPG90cnNfY29uZmlnIHZlcnNpb249IjIuMCIgaW5pdD0iQXBwbGljYXRpb24iPgogICAgPENWUz4kSWQ6IFNlcnZpY2VJbXBvcnRFeHBvcnQueG1sLHYgMS4zIDIwMTMvMDIvMTggMTI6NTk6MzQgYWxpdHZpbm92YSBFeHAgJDwvQ1ZTPgogICAgPFNldHRpbmcgTmFtZT0iSW1wb3J0RXhwb3J0OjpPYmplY3RCYWNrZW5kUmVnaXN0cmF0aW9uIyMjU2VydmljZTJDdXN0b21lclVzZXIiIFJlcXVpcmVkPSIwIiBWYWxpZD0iMSI+CiAgICAgICAgPERlc2NyaXB0aW9uIFRyYW5zbGF0YWJsZT0iMSI+T2JqZWN0IGJhY2tlbmQgbW9kdWxlIHJlZ2lzdHJhdGlvbiBmb3IgdGhlIGltcG9ydC9leHBvcnQgbW9kdWxlLjwvRGVzY3JpcHRpb24+CiAgICAgICAgPE5hdmlnYXRpb24+T2JqZWN0QmFja2VuZDo6TW9kdWxlUmVnaXN0cmF0aW9uPC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgPEhhc2g+CiAgICAgICAgICAgICAgICA8SXRlbSBLZXk9Ik1vZHVsZSI+S2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydDo6T2JqZWN0QmFja2VuZDo6U2VydmljZTJDdXN0b21lclVzZXI8L0l0ZW0+CiAgICAgICAgICAgICAgICA8SXRlbSBLZXk9Ik5hbWUiPlNlcnZpY2UyQ3VzdG9tZXJVc2VyPC9JdGVtPgogICAgICAgICAgICA8L0hhc2g+CiAgICAgICAgPC9WYWx1ZT4KICAgIDwvU2V0dGluZz4KICAgIDxTZXR0aW5nIE5hbWU9IkltcG9ydEV4cG9ydDo6T2JqZWN0QmFja2VuZFJlZ2lzdHJhdGlvbiMjI1NlcnZpY2UiIFJlcXVpcmVkPSIwIiBWYWxpZD0iMSI+CiAgICAgICAgPERlc2NyaXB0aW9uIFRyYW5zbGF0YWJsZT0iMSI+T2JqZWN0IGJhY2tlbmQgbW9kdWxlIHJlZ2lzdHJhdGlvbiBmb3IgdGhlIGltcG9ydC9leHBvcnQgbW9kdWxlLjwvRGVzY3JpcHRpb24+CiAgICAgICAgPE5hdmlnYXRpb24+T2JqZWN0QmFja2VuZDo6TW9kdWxlUmVnaXN0cmF0aW9uPC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgPEhhc2g+CiAgICAgICAgICAgICAgICA8SXRlbSBLZXk9Ik1vZHVsZSI+S2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydDo6T2JqZWN0QmFja2VuZDo6U2VydmljZTwvSXRlbT4KICAgICAgICAgICAgICAgIDxJdGVtIEtleT0iTmFtZSI+U2VydmljZTwvSXRlbT4KICAgICAgICAgICAgPC9IYXNoPgogICAgICAgIDwvVmFsdWU+CiAgICA8L1NldHRpbmc+CiAgICA8U2V0dGluZyBOYW1lPSJJbXBvcnRFeHBvcnQ6Ok9iamVjdEJhY2tlbmRSZWdpc3RyYXRpb24jIyNTTEEiIFJlcXVpcmVkPSIwIiBWYWxpZD0iMSI+CiAgICAgICAgPERlc2NyaXB0aW9uIFRyYW5zbGF0YWJsZT0iMSI+T2JqZWN0IGJhY2tlbmQgbW9kdWxlIHJlZ2lzdHJhdGlvbiBmb3IgdGhlIGltcG9ydC9leHBvcnQgbW9kdWxlLjwvRGVzY3JpcHRpb24+CiAgICAgICAgPE5hdmlnYXRpb24+T2JqZWN0QmFja2VuZDo6TW9kdWxlUmVnaXN0cmF0aW9uPC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgPEhhc2g+CiAgICAgICAgICAgICAgICA8SXRlbSBLZXk9Ik1vZHVsZSI+S2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydDo6T2JqZWN0QmFja2VuZDo6U0xBPC9JdGVtPgogICAgICAgICAgICAgICAgPEl0ZW0gS2V5PSJOYW1lIj5TTEE8L0l0ZW0+CiAgICAgICAgICAgIDwvSGFzaD4KICAgICAgICA8L1ZhbHVlPgogICAgPC9TZXR0aW5nPgogICAgPFNldHRpbmcgTmFtZT0iSW1wb3J0RXhwb3J0OjpTZXJ2aWNlSW1wb3J0RXhwb3J0OjpGb3JjZUNTVk1hcHBpbmdSZWNyZWF0aW9uIiBSZXF1aXJlZD0iMSIgVmFsaWQ9IjEiPgogICAgICAgIDxEZXNjcmlwdGlvbiBUcmFuc2xhdGFibGU9IjEiPkRlZmluZXMgaWYgQ1NWLW1hcHBpbmdzIGFyZSByZS1jcmVhdGVkIG9uIG5leHQgcGFja2FnZSByZWluc3RhbGxhdGlvbiBvciB1cGdyYWRlIGlmIGFscmVhZHkgZXhpc3RlbnQuPC9EZXNjcmlwdGlvbj4KICAgICAgICA8TmF2aWdhdGlvbj5TZXJ2aWNlSW1wb3J0RXhwb3J0PC9OYXZpZ2F0aW9uPgogICAgICAgIDxWYWx1ZT4KICAgICAgICAgICAgPEl0ZW0gVmFsdWVUeXBlPSJDaGVja2JveCI+MDwvSXRlbT4KICAgICAgICA8L1ZhbHVlPgogICAgPC9TZXR0aW5nPiAgIAoKPC9vdHJzX2NvbmZpZz4K</File>
        <File Location="Kernel/System/ImportExport/ObjectBackend/Service.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbC9TeXN0ZW0vSW1wb3J0RXhwb3J0L09iamVjdEJhY2tlbmQvU2VydmljZS5wbQojLSBpbXBvcnQvZXhwb3J0IGJhY2tlbmQgZm9yIHNlcnZpY2UgZGVmaW5pdGlvbnMKIwojIENvcHlyaWdodCAoQykgMjAwNi0yMDE1IGMuYS5wLmUuIElUIEdtYkgsIGh0dHA6Ly93d3cuY2FwZS1pdC5kZQojCiMgd3JpdHRlbi9lZGl0ZWQgYnk6CiMgKiBTdGVmYW4oZG90KU1laGxpZyhhdCljYXBlKGRhc2gpaXQoZG90KWRlCiMgKiBBbm5hKGRvdClMaXR2aW5vdmEoYXQpY2FwZShkYXNoKWl0KGRvdClkZQojICogRnJhbmsoZG90KU9iZXJlbmRlcihhdCljYXBlKGRhc2gpaXQoZG90KWRlCiMgKiBUaG9tYXMoZG90KUxhbmdlKGF0KWNhcGUoZGFzaClpdChkb3QpZGUKIwojIC0tCiMgJElkOiBTZXJ2aWNlLnBtLHYgMS4yMSAyMDE1LzExLzE3IDA1OjQ0OjE4IHRsYW5nZSBFeHAgJAojIC0tCiMgVGhpcyBzb2Z0d2FyZSBjb21lcyB3aXRoIEFCU09MVVRFTFkgTk8gV0FSUkFOVFkuIEZvciBkZXRhaWxzLCBzZWUgCiMgdGhlIGVuY2xvc2VkIGZpbGUgQ09QWUlORyBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbiAoQUdQTCkuIElmIHlvdSAKIyBkaWQgbm90IHJlY2VpdmUgdGhpcyBmaWxlLCBzZWUgaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL2FncGwudHh0LiAKIyAtLQoKcGFja2FnZSBLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0OjpPYmplY3RCYWNrZW5kOjpTZXJ2aWNlOwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwoKb3VyIEBPYmplY3REZXBlbmRlbmNpZXMgPSAoCiAgICAnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcsCiAgICAnS2VybmVsOjpTeXN0ZW06OkR5bmFtaWNGaWVsZCcsCiAgICAnS2VybmVsOjpTeXN0ZW06OlBhY2thZ2UnLAogICAgJ0tlcm5lbDo6U3lzdGVtOjpRdWV1ZScsCiAgICAnS2VybmVsOjpTeXN0ZW06OlNlcnZpY2UnLAogICAgJ0tlcm5lbDo6U3lzdGVtOjpUeXBlJywKICAgICdLZXJuZWw6OlN5c3RlbTo6VmFsaWQnLCAgICAKICAgICdLZXJuZWw6OlN5c3RlbTo6TG9nJywKICAgICdLZXJuZWw6OlN5c3RlbTo6TWFpbicsCiAgICAnS2VybmVsOjpTeXN0ZW06OlVzZXInLAogICAgJ0tlcm5lbDo6Q29uZmlnJwopOwoKPWhlYWQxIE5BTUUKCktlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQ6Ok9iamVjdEJhY2tlbmQ6OkN1c3RvbWVyVXNlciAtIGltcG9ydC9leHBvcnQgYmFja2VuZCBmb3IgQ3VzdG9tZXJVc2VyCgo9aGVhZDEgU1lOT1BTSVMKCkFsbCBmdW5jdGlvbnMgdG8gaW1wb3J0IGFuZCBleHBvcnQgQ3VzdG9tZXJVc2VyIGVudHJpZXMKCj1vdmVyIDQKCj1jdXQKCj1pdGVtIG5ldygpCgpjcmVhdGUgYW4gb2JqZWN0CgogICAgdXNlIEtlcm5lbDo6Q29uZmlnOwogICAgdXNlIEtlcm5lbDo6U3lzdGVtOjpEQjsKICAgIHVzZSBLZXJuZWw6OlN5c3RlbTo6TG9nOwogICAgdXNlIEtlcm5lbDo6U3lzdGVtOjpNYWluOwogICAgdXNlIEtlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQ6Ok9iamVjdEJhY2tlbmQ6OkN1c3RvbWVyVXNlcjsKCiAgICBteSAkQ29uZmlnT2JqZWN0ID0gS2VybmVsOjpDb25maWctPm5ldygpOwogICAgbXkgJExvZ09iamVjdCA9IEtlcm5lbDo6U3lzdGVtOjpMb2ctPm5ldygKICAgICAgICBDb25maWdPYmplY3QgPT4gJENvbmZpZ09iamVjdCwKICAgICk7CiAgICBteSAkTWFpbk9iamVjdCA9IEtlcm5lbDo6U3lzdGVtOjpNYWluLT5uZXcoCiAgICAgICAgQ29uZmlnT2JqZWN0ID0+ICRDb25maWdPYmplY3QsCiAgICAgICAgTG9nT2JqZWN0ICAgID0+ICRMb2dPYmplY3QsCiAgICApOwogICAgbXkgJERCT2JqZWN0ID0gS2VybmVsOjpTeXN0ZW06OkRCLT5uZXcoCiAgICAgICAgQ29uZmlnT2JqZWN0ID0+ICRDb25maWdPYmplY3QsCiAgICAgICAgTG9nT2JqZWN0ICAgID0+ICRMb2dPYmplY3QsCiAgICAgICAgTWFpbk9iamVjdCAgID0+ICRNYWluT2JqZWN0LAogICAgKTsKICAgIG15ICRCYWNrZW5kT2JqZWN0ID0gS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydDo6T2JqZWN0QmFja2VuZDo6Q3VzdG9tZXJVc2VyLT5uZXcoCiAgICAgICAgQ29uZmlnT2JqZWN0ICAgICAgID0+ICRDb25maWdPYmplY3QsCiAgICAgICAgTG9nT2JqZWN0ICAgICAgICAgID0+ICRMb2dPYmplY3QsCiAgICAgICAgREJPYmplY3QgICAgICAgICAgID0+ICREQk9iamVjdCwKICAgICAgICBNYWluT2JqZWN0ICAgICAgICAgPT4gJE1haW5PYmplY3QsCiAgICAgICAgSW1wb3J0RXhwb3J0T2JqZWN0ID0+ICRJbXBvcnRFeHBvcnRPYmplY3QsCiAgICApOwoKPWN1dAoKc3ViIG5ldyB7CiAgICBteSAoICRUeXBlLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgYWxsb2NhdGUgbmV3IGhhc2ggZm9yIG9iamVjdAogICAgbXkgJFNlbGYgPSB7fTsKICAgIGJsZXNzKCAkU2VsZiwgJFR5cGUgKTsKCiAgICBpZiAoJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlBhY2thZ2UnKS0+UGFja2FnZUlzSW5zdGFsbGVkKCBOYW1lID0+ICdJVFNNQ29yZScgKSApIHsKICAgICAgICBpZiAoICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpNYWluJyktPlJlcXVpcmUoJ0tlcm5lbDo6U3lzdGVtOjpHZW5lcmFsQ2F0YWxvZycpICkgewoKICAgICAgICAgICAgaWYgKCAhJFNlbGYtPntHZW5lcmFsQ2F0YWxvZ09iamVjdH0gKSB7CiAgICAgICAgICAgICAgICAkU2VsZi0+e0dlbmVyYWxDYXRhbG9nT2JqZWN0fSA9IEtlcm5lbDo6U3lzdGVtOjpHZW5lcmFsQ2F0YWxvZy0+bmV3KCAleyRTZWxmfSApOwogICAgICAgICAgICB9CiAgICAgICAgICAgICMgZ2V0IHNlcnZpY2UgdHlwZSBsaXN0CiAgICAgICAgICAgICRTZWxmLT57U2VydmljZVR5cGVMaXN0fSA9ICRTZWxmLT57R2VuZXJhbENhdGFsb2dPYmplY3R9LT5JdGVtTGlzdCgKICAgICAgICAgICAgICAgIENsYXNzID0+ICdJVFNNOjpTZXJ2aWNlOjpUeXBlJywKICAgICAgICAgICAgKTsKICAgICAgICAgICAgbXkgJVRtcEhhc2ggPSByZXZlcnNlKCAleyAkU2VsZi0+e1NlcnZpY2VUeXBlTGlzdH0gfSApOwogICAgICAgICAgICAkU2VsZi0+e1JldmVyc2VTZXJ2aWNlVHlwZUxpc3R9ID0gXCVUbXBIYXNoOwoKICAgICAgICAgICAgIyBnZXQgY3JpdGljYWxpdHkgbGlzdAogICAgICAgICAgICBteSAkSVRTTUNyaXRpY2FsaXR5ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkR5bmFtaWNGaWVsZCcpLT5EeW5hbWljRmllbGRHZXQoCiAgICAgICAgICAgICAgICBOYW1lID0+ICdJVFNNQ3JpdGljYWxpdHknLAogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoICRJVFNNQ3JpdGljYWxpdHkgJiYgJElUU01Dcml0aWNhbGl0eS0+eydGaWVsZFR5cGUnfSBlcSAnRHJvcGRvd24nICYmICRJVFNNQ3JpdGljYWxpdHktPnsnT2JqZWN0VHlwZSd9IGVxICdUaWNrZXQnICkgewogICAgICAgICAgICAgICAgJFNlbGYtPntDcml0aWNhbGl0eUxpc3R9ID0gJElUU01Dcml0aWNhbGl0eS0+eydDb25maWcnfS0+eydQb3NzaWJsZVZhbHVlcyd9OwogICAgICAgICAgICAgICAgbXkgJVRtcEhhc2gyID0gcmV2ZXJzZSggJXsgJFNlbGYtPntDcml0aWNhbGl0eUxpc3R9IH0gKTsKICAgICAgICAgICAgICAgICRTZWxmLT57UmV2ZXJzZUNyaXRpY2FsaXR5TGlzdH0gPSBcJVRtcEhhc2gyOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuICRTZWxmOwp9Cgo9aXRlbSBPYmplY3RBdHRyaWJ1dGVzR2V0KCkKCmdldCB0aGUgb2JqZWN0IGF0dHJpYnV0ZXMgb2YgYW4gb2JqZWN0IGFzIGFycmF5L2hhc2ggcmVmZXJlbmNlCgogICAgbXkgJEF0dHJpYnV0ZXMgPSAkT2JqZWN0QmFja2VuZC0+T2JqZWN0QXR0cmlidXRlc0dldCgKICAgICAgICBVc2VySUQgPT4gMSwKICAgICk7Cgo9Y3V0CgpzdWIgT2JqZWN0QXR0cmlidXRlc0dldCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgY2hlY2sgbmVlZGVkIG9iamVjdAogICAgaWYgKCAhJFBhcmFte1VzZXJJRH0gKSB7CiAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpCiAgICAgICAgICAgIC0+TG9nKCBQcmlvcml0eSA9PiAnZXJyb3InLCBNZXNzYWdlID0+ICdOZWVkIFVzZXJJRCEnICk7CiAgICAgICAgcmV0dXJuOwogICAgfQogICAgbXkgJVZhbGlkbGlzdCAgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VmFsaWQnKS0+VmFsaWRMaXN0KCk7CiAgICBteSAkQXR0cmlidXRlcyA9IFsKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdEZWZhdWx0VmFsaWQnLAogICAgICAgICAgICBOYW1lICA9PiAnRGVmYXVsdCBWYWxpZGl0eScsCiAgICAgICAgICAgIElucHV0ID0+IHsKICAgICAgICAgICAgICAgIFR5cGUgICAgICAgICA9PiAnU2VsZWN0aW9uJywKICAgICAgICAgICAgICAgIERhdGEgICAgICAgICA9PiBcJVZhbGlkbGlzdCwKICAgICAgICAgICAgICAgIFJlcXVpcmVkICAgICA9PiAxLAogICAgICAgICAgICAgICAgVHJhbnNsYXRpb24gID0+IDEsCiAgICAgICAgICAgICAgICBQb3NzaWJsZU5vbmUgPT4gMCwKICAgICAgICAgICAgICAgIFZhbHVlRGVmYXVsdCA9PiAxLAogICAgICAgICAgICB9LAogICAgICAgIH0sCiAgICBdOwogICAgaWYgKCAkU2VsZi0+e1NlcnZpY2VUeXBlTGlzdH0gKSB7CiAgICAgICAgbXkgJFNlcnZpY2VUeXBlRGVmYXVsdCA9IHsKICAgICAgICAgICAgS2V5ICAgPT4gJ0RlZmF1bHRTZXJ2aWNlVHlwZUlEJywKICAgICAgICAgICAgTmFtZSAgPT4gJ0RlZmF1bHQgU2VydmljZSBUeXBlJywKICAgICAgICAgICAgSW5wdXQgPT4gewogICAgICAgICAgICAgICAgVHlwZSAgICAgICAgID0+ICdTZWxlY3Rpb24nLAogICAgICAgICAgICAgICAgRGF0YSAgICAgICAgID0+ICRTZWxmLT57U2VydmljZVR5cGVMaXN0fSwKICAgICAgICAgICAgICAgIFJlcXVpcmVkICAgICA9PiAxLAogICAgICAgICAgICAgICAgVHJhbnNsYXRpb24gID0+IDAsCiAgICAgICAgICAgICAgICBQb3NzaWJsZU5vbmUgPT4gMCwKICAgICAgICAgICAgfSwKICAgICAgICB9OwogICAgICAgIHB1c2goIEB7JEF0dHJpYnV0ZXN9LCAkU2VydmljZVR5cGVEZWZhdWx0ICk7CiAgICB9CiAgICBpZiAoICRTZWxmLT57Q3JpdGljYWxpdHlMaXN0fSApIHsKICAgICAgICBteSAkQ3JpdGljYWxpdHlEZWZhdWx0ID0gewogICAgICAgICAgICBLZXkgICA9PiAnRGVmYXVsdENyaXRpY2FsaXR5SUQnLAogICAgICAgICAgICBOYW1lICA9PiAnRGVmYXVsdCBDcml0aWNhbGl0eScsCiAgICAgICAgICAgIElucHV0ID0+IHsKICAgICAgICAgICAgICAgIFR5cGUgICAgICAgICA9PiAnU2VsZWN0aW9uJywKICAgICAgICAgICAgICAgIERhdGEgICAgICAgICA9PiAkU2VsZi0+e0NyaXRpY2FsaXR5TGlzdH0sCiAgICAgICAgICAgICAgICBSZXF1aXJlZCAgICAgPT4gMSwKICAgICAgICAgICAgICAgIFRyYW5zbGF0aW9uICA9PiAwLAogICAgICAgICAgICAgICAgUG9zc2libGVOb25lID0+IDAsCiAgICAgICAgICAgIH0sCiAgICAgICAgfTsKICAgICAgICBwdXNoKCBAeyRBdHRyaWJ1dGVzfSwgJENyaXRpY2FsaXR5RGVmYXVsdCApOwogICAgfQogICAgcmV0dXJuICRBdHRyaWJ1dGVzOwp9Cgo9aXRlbSBNYXBwaW5nT2JqZWN0QXR0cmlidXRlc0dldCgpCgpnZXQgdGhlIG1hcHBpbmcgYXR0cmlidXRlcyBvZiBhbiBvYmplY3QgYXMgYXJyYXkvaGFzaCByZWZlcmVuY2UKCiAgICBteSAkQXR0cmlidXRlcyA9ICRPYmplY3RCYWNrZW5kLT5NYXBwaW5nT2JqZWN0QXR0cmlidXRlc0dldCgKICAgICAgICBUZW1wbGF0ZUlEID0+IDEyMywKICAgICAgICBVc2VySUQgICAgID0+IDEsCiAgICApOwoKPWN1dAoKc3ViIE1hcHBpbmdPYmplY3RBdHRyaWJ1dGVzR2V0IHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgIyBjaGVjayBuZWVkZWQgc3R1ZmYKICAgIGZvciBteSAkQXJndW1lbnQgKHF3KFRlbXBsYXRlSUQgVXNlcklEKSkgewogICAgICAgIGlmICggISRQYXJhbXskQXJndW1lbnR9ICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiTmVlZCAkQXJndW1lbnQhIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KCiAgICAjIGdldCBvYmplY3QgZGF0YQogICAgbXkgJE9iamVjdERhdGEgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0JyktPk9iamVjdERhdGFHZXQoCiAgICAgICAgVGVtcGxhdGVJRCA9PiAkUGFyYW17VGVtcGxhdGVJRH0sCiAgICAgICAgVXNlcklEICAgICA9PiAkUGFyYW17VXNlcklEfSwKICAgICk7CiAgICBteSAkRWxlbWVudExpc3QgPSBbCiAgICAgICAgewogICAgICAgICAgICBLZXkgICA9PiAnU2VydmljZUlEJywKICAgICAgICAgICAgVmFsdWUgPT4gJ1NlcnZpY2UgSUQnLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBLZXkgICA9PiAnTmFtZScsCiAgICAgICAgICAgIFZhbHVlID0+ICdGdWxsIFNlcnZpY2UgTmFtZScsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdOYW1lU2hvcnQnLAogICAgICAgICAgICBWYWx1ZSA9PiAnU2hvcnQgU2VydmljZSBOYW1lJywKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgS2V5ICAgPT4gJ1ZhbGlkJywKICAgICAgICAgICAgVmFsdWUgPT4gJ1ZhbGlkaXR5JywKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgS2V5ICAgPT4gJ0NvbW1lbnQnLAogICAgICAgICAgICBWYWx1ZSA9PiAnQ29tbWVudCcsCiAgICAgICAgfSwKICAgIF07CgogICAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgIyBnZXQgcHJlZmVyZW5jZXMuLi4KICAgIG15ICVQcmVmZXJlbmNlcyA9ICgpOwogICAgaWYgKCAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpLT5HZXQoJ1NlcnZpY2VQcmVmZXJlbmNlcycpICkgewogICAgICAgICVQcmVmZXJlbmNlcyA9ICV7ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyktPkdldCgnU2VydmljZVByZWZlcmVuY2VzJykgfTsKICAgIH0KICAgIGZvciBteSAkSXRlbSAoIHNvcnQga2V5cyAlUHJlZmVyZW5jZXMgKSB7CiAgICAgICAgaWYgKAogICAgICAgICAgICAkUHJlZmVyZW5jZXN7JEl0ZW19LT57U2VsZWN0aW9uU291cmNlfQogICAgICAgICAgICAmJiAkUHJlZmVyZW5jZXN7JEl0ZW19LT57UHJlZktleX0gPX4gL14oLispSUQkLwogICAgICAgICAgICApCiAgICAgICAgewogICAgICAgICAgICBteSAkTmFtZVBhcnQgPSAkMTsKICAgICAgICAgICAgcHVzaCgKICAgICAgICAgICAgICAgIEB7JEVsZW1lbnRMaXN0fSwKICAgICAgICAgICAgICAgIHsgS2V5ID0+ICROYW1lUGFydCwgVmFsdWUgPT4gJFByZWZlcmVuY2VzeyRJdGVtfS0+e0xhYmVsfSB9CiAgICAgICAgICAgICk7CiAgICAgICAgfQoKICAgICAgICBpZiAoICRQcmVmZXJlbmNlc3skSXRlbX0tPntQcmVmS2V5fSA9fiAvXiguKylJRCQvICkgewogICAgICAgICAgICBteSAkTmFtZVBhcnQgPSAkMTsKICAgICAgICAgICAgcHVzaCgKICAgICAgICAgICAgICAgIEB7JEVsZW1lbnRMaXN0fSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBLZXkgICA9PiAkUHJlZmVyZW5jZXN7JEl0ZW19LT57UHJlZktleX0sCiAgICAgICAgICAgICAgICAgICAgVmFsdWUgPT4gJFByZWZlcmVuY2VzeyRJdGVtfS0+e0xhYmVsfSAuICIgKElEKSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHB1c2goCiAgICAgICAgICAgICAgICBAeyRFbGVtZW50TGlzdH0sCiAgICAgICAgICAgICAgICB7IEtleSA9PiAkUHJlZmVyZW5jZXN7JEl0ZW19LT57UHJlZktleX0sIFZhbHVlID0+ICRQcmVmZXJlbmNlc3skSXRlbX0tPntMYWJlbH0gfQogICAgICAgICAgICApOwogICAgICAgIH0KCiAgICB9CgogICAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgIyB1c2luZyBjaXJpdGNhbGl0eS9zZXJ2aWNldHlwZS1saXN0IGFzIGluZGljYXRvciBmb3IgSVRTTS1pbnN0YWxsYXRpb24uLi4KICAgIGlmICggJFNlbGYtPntDcml0aWNhbGl0eUxpc3R9ICYmICRTZWxmLT57U2VydmljZVR5cGVMaXN0fSApIHsKICAgICAgICBteSAkRWxlbWVudExpc3RJVFNNID0gWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBLZXkgICA9PiAnVHlwZScsCiAgICAgICAgICAgICAgICBWYWx1ZSA9PiAnU2VydmljZSBUeXBlIChJVFNNIG9ubHkpJywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgS2V5ICAgPT4gJ0NyaXRpY2FsaXR5JywKICAgICAgICAgICAgICAgIFZhbHVlID0+ICdDcml0aWNhbGl0eSAoSVRTTSBvbmx5KScsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIEtleSAgID0+ICdDdXJJbmNpU3RhdGUnLAogICAgICAgICAgICAgICAgVmFsdWUgPT4gJ0N1cnJlbnQgSW5jaWRlbnQgU3RhdGUgKElUU00gb25seSknLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBLZXkgICA9PiAnQ3VySW5jaVN0YXRlVHlwZScsCiAgICAgICAgICAgICAgICBWYWx1ZSA9PiAnQ3VycmVudCBJbmNpZGVudCBTdGF0ZSBUeXBlIChJVFNNIG9ubHkpJywKICAgICAgICAgICAgfSwKICAgICAgICBdOwogICAgICAgIG15IEBUbXBBcnJheSA9ICggQHskRWxlbWVudExpc3R9LCBAeyRFbGVtZW50TGlzdElUU019ICk7CiAgICAgICAgJEVsZW1lbnRMaXN0ID0gXEBUbXBBcnJheTsKICAgIH0KICAgIG15ICRBdHRyaWJ1dGVzID0gWwogICAgICAgIHsKICAgICAgICAgICAgS2V5ICAgPT4gJ0tleScsCiAgICAgICAgICAgIE5hbWUgID0+ICdLZXknLAogICAgICAgICAgICBJbnB1dCA9PiB7CiAgICAgICAgICAgICAgICBUeXBlICAgICAgICAgPT4gJ1NlbGVjdGlvbicsCiAgICAgICAgICAgICAgICBEYXRhICAgICAgICAgPT4gJEVsZW1lbnRMaXN0LAogICAgICAgICAgICAgICAgUmVxdWlyZWQgICAgID0+IDEsCiAgICAgICAgICAgICAgICBUcmFuc2xhdGlvbiAgPT4gMSwKICAgICAgICAgICAgICAgIFBvc3NpYmxlTm9uZSA9PiAxLAogICAgICAgICAgICB9LAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBLZXkgICA9PiAnSWRlbnRpZmllcicsCiAgICAgICAgICAgIE5hbWUgID0+ICdJZGVudGlmaWVyJywKICAgICAgICAgICAgSW5wdXQgPT4geyBUeXBlID0+ICdDaGVja2JveCcsIH0sCiAgICAgICAgfSwKICAgIF07CgogICAgcmV0dXJuICRBdHRyaWJ1dGVzOyAgICAKfQoKPWl0ZW0gU2VhcmNoQXR0cmlidXRlc0dldCgpCgpnZXQgdGhlIHNlYXJjaCBvYmplY3QgYXR0cmlidXRlcyBvZiBhbiBvYmplY3QgYXMgYXJyYXkvaGFzaCByZWZlcmVuY2UKCiAgICBteSAkQXR0cmlidXRlTGlzdCA9ICRPYmplY3RCYWNrZW5kLT5TZWFyY2hBdHRyaWJ1dGVzR2V0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gMTIzLAogICAgICAgIFVzZXJJRCAgICAgPT4gMSwKICAgICk7Cgo9Y3V0CgpzdWIgU2VhcmNoQXR0cmlidXRlc0dldCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgY2hlY2sgbmVlZGVkIHN0dWZmCiAgICBmb3IgbXkgJEFyZ3VtZW50IChxdyhUZW1wbGF0ZUlEIFVzZXJJRCkpIHsKICAgICAgICBpZiAoICEkUGFyYW17JEFyZ3VtZW50fSApIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5lZWQgJEFyZ3VtZW50ISIsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CiAgICBteSAkQXR0cmlidXRlTGlzdCA9IFsKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdTZXJ2aWNlTmFtZScsCiAgICAgICAgICAgIE5hbWUgID0+ICdTZXJ2aWNlIE5hbWUnLAogICAgICAgICAgICBJbnB1dCA9PiB7CiAgICAgICAgICAgICAgICBUeXBlICAgICAgPT4gJ1RleHQnLAogICAgICAgICAgICAgICAgU2l6ZSAgICAgID0+IDgwLAogICAgICAgICAgICAgICAgTWF4TGVuZ3RoID0+IDI1NSwKICAgICAgICAgICAgfSwKICAgICAgICB9LAogICAgXTsKICAgIHJldHVybiAkQXR0cmlidXRlTGlzdDsKfQoKPWl0ZW0gRXhwb3J0RGF0YUdldCgpCgpnZXQgZXhwb3J0IGRhdGEgYXMgMkQtYXJyYXktaGFzaCByZWZlcmVuY2UKCiAgICBteSAkRXhwb3J0RGF0YSA9ICRPYmplY3RCYWNrZW5kLT5FeHBvcnREYXRhR2V0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gMTIzLAogICAgICAgIFVzZXJJRCAgICAgPT4gMSwKICAgICk7Cgo9Y3V0CgpzdWIgRXhwb3J0RGF0YUdldCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgY2hlY2sgbmVlZGVkIHN0dWZmCiAgICBmb3IgbXkgJEFyZ3VtZW50IChxdyhUZW1wbGF0ZUlEIFVzZXJJRCkpIHsKICAgICAgICBpZiAoICEkUGFyYW17JEFyZ3VtZW50fSApIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5lZWQgJEFyZ3VtZW50ISIsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CgogICAgIyBnZXQgb2JqZWN0IGRhdGEKICAgIG15ICRPYmplY3REYXRhID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5PYmplY3REYXRhR2V0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gJFBhcmFte1RlbXBsYXRlSUR9LAogICAgICAgIFVzZXJJRCAgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICApOwoKICAgICMgY2hlY2sgb2JqZWN0IGRhdGEKICAgIGlmICggISRPYmplY3REYXRhIHx8IHJlZiAkT2JqZWN0RGF0YSBuZSAnSEFTSCcgKSB7CiAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJObyBvYmplY3QgZGF0YSBmb3VuZCBmb3IgdGhlIHRlbXBsYXRlIGlkICRQYXJhbXtUZW1wbGF0ZUlEfSIsCiAgICAgICAgKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgIyBnZXQgdGhlIG1hcHBpbmcgbGlzdAogICAgbXkgJE1hcHBpbmdMaXN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5NYXBwaW5nTGlzdCgKICAgICAgICBUZW1wbGF0ZUlEID0+ICRQYXJhbXtUZW1wbGF0ZUlEfSwKICAgICAgICBVc2VySUQgICAgID0+ICRQYXJhbXtVc2VySUR9LAogICAgKTsKCiAgICAjIGNoZWNrIHRoZSBtYXBwaW5nIGxpc3QKICAgIGlmICggISRNYXBwaW5nTGlzdCB8fCByZWYgJE1hcHBpbmdMaXN0IG5lICdBUlJBWScgfHwgIUB7JE1hcHBpbmdMaXN0fSApIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIHZhbGlkIG1hcHBpbmcgbGlzdCBmb3VuZCBmb3IgdGhlIHRlbXBsYXRlIGlkICRQYXJhbXtUZW1wbGF0ZUlEfSIsCiAgICAgICAgKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgIyBjcmVhdGUgdGhlIG1hcHBpbmcgb2JqZWN0IGxpc3QKICAgIG15IEBNYXBwaW5nT2JqZWN0TGlzdDsKICAgIGZvciBteSAkTWFwcGluZ0lEICggQHskTWFwcGluZ0xpc3R9ICkgewoKICAgICAgICAjIGdldCBtYXBwaW5nIG9iamVjdCBkYXRhCiAgICAgICAgbXkgJE1hcHBpbmdPYmplY3REYXRhID0KICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5NYXBwaW5nT2JqZWN0RGF0YUdldCgKICAgICAgICAgICAgTWFwcGluZ0lEID0+ICRNYXBwaW5nSUQsCiAgICAgICAgICAgIFVzZXJJRCAgICA9PiAkUGFyYW17VXNlcklEfSwKICAgICAgICAgICAgKTsKCiAgICAgICAgIyBjaGVjayBtYXBwaW5nIG9iamVjdCBkYXRhCiAgICAgICAgaWYgKCAhJE1hcHBpbmdPYmplY3REYXRhIHx8IHJlZiAkTWFwcGluZ09iamVjdERhdGEgbmUgJ0hBU0gnICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiTm8gdmFsaWQgbWFwcGluZyBsaXN0IGZvdW5kIGZvciB0aGUgdGVtcGxhdGUgaWQgJFBhcmFte1RlbXBsYXRlSUR9IiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBwdXNoKCBATWFwcGluZ09iamVjdExpc3QsICRNYXBwaW5nT2JqZWN0RGF0YSApOwogICAgfQoKICAgICMgZ2V0IHNlYXJjaCBkYXRhCiAgICBteSAkU2VhcmNoRGF0YSA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQnKS0+U2VhcmNoRGF0YUdldCgKICAgICAgICBUZW1wbGF0ZUlEID0+ICRQYXJhbXtUZW1wbGF0ZUlEfSwKICAgICAgICBVc2VySUQgICAgID0+ICRQYXJhbXtVc2VySUR9LAogICAgKTsKICAgIGlmICggJFNlYXJjaERhdGEgJiYgcmVmKCRTZWFyY2hEYXRhKSBuZSAnSEFTSCcgKSB7CiAgICAgICAgJFNlYXJjaERhdGEgPSAwOwogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICBNZXNzYWdlID0+CiAgICAgICAgICAgICAgICAiU2VydmljZTJDdXN0b21lclVzZXI6IHNlYXJjaCBkYXRhIGlzIG5vdCBhIGhhc2ggcmVmIC0gaWdub3Jpbmcgc2VhcmNoIGxpbWl0YXRpb24uIiwKICAgICAgICApOwogICAgfQogICAgbXkgQFNlcnZpY2VMaXN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlNlcnZpY2UnKS0+U2VydmljZVNlYXJjaCgKICAgICAgICBOYW1lICA9PiAkU2VhcmNoRGF0YS0+e1NlcnZpY2VOYW1lfSB8fCAnJywKICAgICAgICBMaW1pdCA9PiAkU2VhcmNoRGF0YS0+e0xpbWl0fSAgICAgICB8fCAnMCcsCiAgICAgICAgVXNlcklEID0+IDEsCgogICAgICAgICMgbm8gZnVydGhlciByZXN0cmljdGlvbiB5ZXQuLi4KICAgICAgICAjVHlwZUlEcyAgICAgICAgPT4gMiwKICAgICAgICAjQ3JpdGljYWxpdHlJRHMgPT4gMSwKICAgICk7CgogICAgIyBleHBvcnQgZGF0YS4uLgogICAgbXkgQEV4cG9ydERhdGE7CgogICAgIyBnZXQgcHJlZmVyZW5jZXMgY29uZmlndXJhdGlvbi4uLgogICAgbXkgJVByZWZlcmVuY2VzID0gKCk7CiAgICBpZiAoICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyktPkdldCgnU2VydmljZVByZWZlcmVuY2VzJykgKSB7CiAgICAgICAgbXkgJVByZWZDb25maWcgPSAleyAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpLT5HZXQoJ1NlcnZpY2VQcmVmZXJlbmNlcycpIH07CiAgICAgICAgZm9yIG15ICRDdXJyS2V5ICgga2V5cyglUHJlZkNvbmZpZykgKSB7CiAgICAgICAgICAgIG15ICVDdXJyUHJlZnMgPSAoKTsKICAgICAgICAgICAgJEN1cnJQcmVmc3tMYWJlbH0gICAgICAgICAgICAgICA9ICRQcmVmQ29uZmlneyRDdXJyS2V5fS0+e0xhYmVsfTsKICAgICAgICAgICAgJEN1cnJQcmVmc3tTZWxlY3Rpb25Tb3VyY2V9ICAgICA9ICRQcmVmQ29uZmlneyRDdXJyS2V5fS0+e1NlbGVjdGlvblNvdXJjZX07CiAgICAgICAgICAgICRDdXJyUHJlZnN7R2VuZXJhbENhdGFsb2dDbGFzc30gPSAkUHJlZkNvbmZpZ3skQ3VycktleX0tPntHZW5lcmFsQ2F0YWxvZ0NsYXNzfTsKICAgICAgICAgICAgJFByZWZlcmVuY2VzeyAkUHJlZkNvbmZpZ3skQ3VycktleX0tPntQcmVmS2V5fSB9ID0gXCVDdXJyUHJlZnM7CiAgICAgICAgfQogICAgfQoKCiAgICBmb3IgbXkgJFNlcnZpY2VJRCAoQFNlcnZpY2VMaXN0KSB7CiAgICAgICAgbXkgJVNlcnZpY2VEYXRhID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlNlcnZpY2UnKS0+U2VydmljZUdldCgKICAgICAgICAgICAgU2VydmljZUlEID0+ICRTZXJ2aWNlSUQsCiAgICAgICAgICAgIFVzZXJJRCAgICA9PiAxLCAgICAgICAgICAgICMgbm8gcGVybWlzc2lvbiByZXN0cmljdGlvbiBmb3IgdGhpcyBleHBvcnQKICAgICAgICApOwoKICAgICAgICAjZXhwb3J0IHZhbGlkIHN0cmluZyBpbnN0ZWFkIG9mIElELi4uCiAgICAgICAgJFNlcnZpY2VEYXRhe1ZhbGlkfSA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpWYWxpZCcpLT5WYWxpZExvb2t1cCgKICAgICAgICAgICAgVmFsaWRJRCA9PiAkU2VydmljZURhdGF7VmFsaWRJRH0sCiAgICAgICAgKTsKCiAgICAgICAgaWYgKCRTZXJ2aWNlRGF0YXtUeXBlSUR9KXsKICAgICAgICAgICAgJFNlcnZpY2VEYXRhe1R5cGV9ID0gJFNlbGYtPntTZXJ2aWNlVHlwZUxpc3R9LT57JFNlcnZpY2VEYXRhe1R5cGVJRH19OwogICAgICAgIH0KCiAgICAgICAgUFJFRkVSRU5DRUNIRUNLOgogICAgICAgIGZvciBteSAkQ3VycktleSAoIGtleXMoJVNlcnZpY2VEYXRhKSApIHsKCiAgICAgICAgICAgICMgY2hlY2sgaWYgdGhpcyBpcyBhIHByZWZlcmVuY2UuLi4KICAgICAgICAgICAgbmV4dCBQUkVGRVJFTkNFQ0hFQ0sgaWYgKCAhJFByZWZlcmVuY2VzeyRDdXJyS2V5fSApOwoKICAgICAgICAgICAgIyBjaGVjayBpZiB0aGlzIGlzIGFuIElELWF0dHJpYnV0ZS4uLgogICAgICAgICAgICBuZXh0IFBSRUZFUkVOQ0VDSEVDSyBpZiAoICRDdXJyS2V5ICF+IC9eKC4rKUlEJC8gKTsKICAgICAgICAgICAgbXkgJE5hbWVQYXJ0ID0gJDE7CgogICAgICAgICAgICAjIHNraXAgaWYgYW4gYXR0cmlidXRlIHdpdGggYSBzaW1pbGFyIG5hbWUgYnV0IG5vICJJRCIgc3VmZml4IGV4aXN0cy4uLgogICAgICAgICAgICBuZXh0IFBSRUZFUkVOQ0VDSEVDSyBpZiAoICRTZXJ2aWNlRGF0YXskTmFtZVBhcnR9ICk7CgogICAgICAgICAgICAjIGNoZWNrIGZvciBzb3VyY2Ugb2YgcHJlZmVyZW5jZS4uLgogICAgICAgICAgICBteSAlU2VsZWN0aW9uTGlzdCA9ICgpOwogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAkUHJlZmVyZW5jZXN7JEN1cnJLZXl9LT57U2VsZWN0aW9uU291cmNlfQogICAgICAgICAgICAgICAgJiYgJFByZWZlcmVuY2VzeyRDdXJyS2V5fS0+e1NlbGVjdGlvblNvdXJjZX0gZXEgJ1F1ZXVlTGlzdCcKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJVNlbGVjdGlvbkxpc3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6UXVldWUnKS0+UXVldWVMaXN0KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzaWYgKCAKICAgICAgICAgICAgICAgICAgICAkUHJlZmVyZW5jZXN7JEN1cnJLZXl9LT57U2VsZWN0aW9uU291cmNlfQogICAgICAgICAgICAgICAgICAgICYmICRQcmVmZXJlbmNlc3skQ3VycktleX0tPntTZWxlY3Rpb25Tb3VyY2V9IGVxICdVc2VyTGlzdCcgCiAgICAgICAgICAgICAgICAgICAgKSAKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJVNlbGVjdGlvbkxpc3QgPSBLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpVc2VyT2JqZWN0JyktPlVzZXJMaXN0KAogICAgICAgICAgICAgICAgICAgICNUeXBlICA9PiAnTG9uZycsCiAgICAgICAgICAgICAgICAgICAgVmFsaWQgPT4gMSwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzaWYgKAogICAgICAgICAgICAgICAgJFByZWZlcmVuY2VzeyRDdXJyS2V5fS0+e1NlbGVjdGlvblNvdXJjZX0KICAgICAgICAgICAgICAgICYmICRQcmVmZXJlbmNlc3skQ3VycktleX0tPntTZWxlY3Rpb25Tb3VyY2V9IGVxICdUeXBlTGlzdCcKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgJVNlbGVjdGlvbkxpc3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VHlwZScpLT5UeXBlTGlzdCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2lmICgKICAgICAgICAgICAgICAgICggJFByZWZlcmVuY2VzeyRDdXJyS2V5fS0+e1NlbGVjdGlvblNvdXJjZX0gKQogICAgICAgICAgICAgICAgJiYKICAgICAgICAgICAgICAgICggJFByZWZlcmVuY2VzeyRDdXJyS2V5fS0+e1NlbGVjdGlvblNvdXJjZX0gZXEgJ0dlbmVyYWxDYXRhbG9nJyApCiAgICAgICAgICAgICAgICAmJgogICAgICAgICAgICAgICAgKCAkUHJlZmVyZW5jZXN7JEN1cnJLZXl9LT57R2VuZXJhbENhdGFsb2dDbGFzc30gKSAmJgogICAgICAgICAgICAgICAgJFNlbGYtPntHZW5lcmFsQ2F0YWxvZ09iamVjdH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbXkgJEl0ZW1MaXN0UmVmID0gJFNlbGYtPntHZW5lcmFsQ2F0YWxvZ09iamVjdH0tPkl0ZW1MaXN0KAogICAgICAgICAgICAgICAgICAgIENsYXNzID0+ICRQcmVmZXJlbmNlc3skQ3VycktleX0tPntHZW5lcmFsQ2F0YWxvZ0NsYXNzfSwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBpZiAoICRJdGVtTGlzdFJlZiAmJiByZWYoJEl0ZW1MaXN0UmVmKSBlcSAnSEFTSCcgKSB7CiAgICAgICAgICAgICAgICAgICAgJVNlbGVjdGlvbkxpc3QgPSAleyRJdGVtTGlzdFJlZn07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgY3JlYXRlIG5vbi1JRCB2YWx1ZSBmb3IgZXhwb3J0Li4uCiAgICAgICAgICAgICRTZXJ2aWNlRGF0YXskTmFtZVBhcnR9ID0gJFNlbGVjdGlvbkxpc3R7ICRTZXJ2aWNlRGF0YXskQ3VycktleX0gfQogICAgICAgICAgICAgICAgfHwgJFNlcnZpY2VEYXRheyRDdXJyS2V5fTsKCiAgICAgICAgfQoKICAgICAgICBteSBAQ3VyclJvdyA9IHF3e307CiAgICAgICAgZm9yIG15ICRNYXBwaW5nT2JqZWN0IChATWFwcGluZ09iamVjdExpc3QpIHsKICAgICAgICAgICAgbXkgJEtleSA9ICRNYXBwaW5nT2JqZWN0LT57S2V5fTsKICAgICAgICAgICAgaWYgKCAkTWFwcGluZ09iamVjdC0+e0tleX0gJiYgJFNlcnZpY2VEYXRheyAkTWFwcGluZ09iamVjdC0+e0tleX0gfSApIHsKICAgICAgICAgICAgICAgIHB1c2goIEBDdXJyUm93LCAkU2VydmljZURhdGF7ICRNYXBwaW5nT2JqZWN0LT57S2V5fSB9ICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBwdXNoKCBAQ3VyclJvdywgJy0nICk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcHVzaCBARXhwb3J0RGF0YSwgXEBDdXJyUm93OwogICAgfQogICAgcmV0dXJuIFxARXhwb3J0RGF0YTsKfQoKPWl0ZW0gSW1wb3J0RGF0YVNhdmUoKQoKaW1wb3J0IG9uZSByb3cgb2YgdGhlIGltcG9ydCBkYXRhCgogICAgbXkgJENvbmZpZ0l0ZW1JRCA9ICRPYmplY3RCYWNrZW5kLT5JbXBvcnREYXRhU2F2ZSgKICAgICAgICBUZW1wbGF0ZUlEICAgID0+IDEyMywKICAgICAgICBJbXBvcnREYXRhUm93ID0+ICRBcnJheVJlZiwKICAgICAgICBVc2VySUQgICAgICAgID0+IDEsCiAgICApOwoKPWN1dAoKc3ViIEltcG9ydERhdGFTYXZlIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgIyBjaGVjayBuZWVkZWQgc3R1ZmYKICAgIGZvciBteSAkQXJndW1lbnQgKHF3KFRlbXBsYXRlSUQgSW1wb3J0RGF0YVJvdyBVc2VySUQpKSB7CiAgICAgICAgaWYgKCAhJFBhcmFteyRBcmd1bWVudH0gKSB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJOZWVkICRBcmd1bWVudCEiLAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm4gKCB1bmRlZiwgJ0ZhaWxlZCcgKTsKICAgICAgICB9CiAgICB9CgogICAgIyBjaGVjayBpbXBvcnQgZGF0YSByb3cKICAgIGlmICggcmVmICRQYXJhbXtJbXBvcnREYXRhUm93fSBuZSAnQVJSQVknICkgewogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICBNZXNzYWdlICA9PiAnSW1wb3J0RGF0YVJvdyBtdXN0IGJlIGFuIGFycmF5IHJlZmVyZW5jZScsCiAgICAgICAgKTsKICAgICAgICByZXR1cm4gKCB1bmRlZiwgJ0ZhaWxlZCcgKTsKICAgIH0KCiAgICAjIGdldCBvYmplY3QgZGF0YQogICAgbXkgJE9iamVjdERhdGEgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0JyktPk9iamVjdERhdGFHZXQoCiAgICAgICAgVGVtcGxhdGVJRCA9PiAkUGFyYW17VGVtcGxhdGVJRH0sCiAgICAgICAgVXNlcklEICAgICA9PiAkUGFyYW17VXNlcklEfSwKICAgICk7CgogICAgIyBjaGVjayBvYmplY3QgZGF0YQogICAgaWYgKCAhJE9iamVjdERhdGEgfHwgcmVmICRPYmplY3REYXRhIG5lICdIQVNIJyApIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIG9iamVjdCBkYXRhIGZvdW5kIGZvciB0aGUgdGVtcGxhdGUgaWQgJFBhcmFte1RlbXBsYXRlSUR9IiwKICAgICAgICApOwogICAgICAgIHJldHVybiAoIHVuZGVmLCAnRmFpbGVkJyApOwogICAgfQoKICAgICMgZ2V0IHRoZSBtYXBwaW5nIGxpc3QKICAgIG15ICRNYXBwaW5nTGlzdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQnKS0+TWFwcGluZ0xpc3QoCiAgICAgICAgVGVtcGxhdGVJRCA9PiAkUGFyYW17VGVtcGxhdGVJRH0sCiAgICAgICAgVXNlcklEICAgICA9PiAkUGFyYW17VXNlcklEfSwKICAgICk7CgogICAgIyBjaGVjayB0aGUgbWFwcGluZyBsaXN0CiAgICBpZiAoICEkTWFwcGluZ0xpc3QgfHwgcmVmICRNYXBwaW5nTGlzdCBuZSAnQVJSQVknIHx8ICFAeyRNYXBwaW5nTGlzdH0gKSB7CiAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJObyB2YWxpZCBtYXBwaW5nIGxpc3QgZm91bmQgZm9yIHRoZSB0ZW1wbGF0ZSBpZCAkUGFyYW17VGVtcGxhdGVJRH0iLAogICAgICAgICk7CiAgICAgICAgcmV0dXJuICggdW5kZWYsICdGYWlsZWQnICk7CiAgICB9CgogICAgIyBjcmVhdGUgdGhlIG1hcHBpbmcgb2JqZWN0IGxpc3QKICAgIG15IEBNYXBwaW5nT2JqZWN0TGlzdDsKICAgIG15ICVJZGVudGlmaWVyOwogICAgbXkgJENvdW50ZXIgICAgICAgICAgICAgID0gMDsKICAgIG15ICVOZXdTZXJ2aWNlRGF0YSAgICAgICA9IHF3e307CiAgICBteSAkU2VydmljZUlkZW50aWZpZXJLZXkgPSAiIjsKCiAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICNCVUlMRCBNQVBQSU5HIFRBQkxFLi4uCiAgICBmb3IgbXkgJE1hcHBpbmdJRCAoIEB7JE1hcHBpbmdMaXN0fSApIHsKCiAgICAgICAgIyBnZXQgbWFwcGluZyBvYmplY3QgZGF0YQogICAgICAgIG15ICRNYXBwaW5nT2JqZWN0RGF0YSA9CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQnKS0+TWFwcGluZ09iamVjdERhdGFHZXQoCiAgICAgICAgICAgIE1hcHBpbmdJRCA9PiAkTWFwcGluZ0lELAogICAgICAgICAgICBVc2VySUQgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICAgICAgICAgICk7CgogICAgICAgICMgY2hlY2sgbWFwcGluZyBvYmplY3QgZGF0YQogICAgICAgIGlmICggISRNYXBwaW5nT2JqZWN0RGF0YSB8fCByZWYgJE1hcHBpbmdPYmplY3REYXRhIG5lICdIQVNIJyApIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIHZhbGlkIG1hcHBpbmcgbGlzdCBmb3VuZCBmb3IgdGVtcGxhdGUgaWQgJFBhcmFte1RlbXBsYXRlSUR9IiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuICggdW5kZWYsICdGYWlsZWQnICk7CiAgICAgICAgfQogICAgICAgIHB1c2goIEBNYXBwaW5nT2JqZWN0TGlzdCwgJE1hcHBpbmdPYmplY3REYXRhICk7CiAgICAgICAgaWYgKAogICAgICAgICAgICAkTWFwcGluZ09iamVjdERhdGEtPntJZGVudGlmaWVyfQogICAgICAgICAgICAmJiAkSWRlbnRpZmllcnsgJE1hcHBpbmdPYmplY3REYXRhLT57S2V5fSB9CiAgICAgICAgICAgICkKICAgICAgICB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJDYW4ndCBpbXBvcnQgdGhpcyBlbnRpdHkuICIKICAgICAgICAgICAgICAgICAgICAuICInJE1hcHBpbmdPYmplY3REYXRhLT57S2V5fScgaGFzIGJlZW4gdXNlZCBtdWx0aXBsZSAiCiAgICAgICAgICAgICAgICAgICAgLiAidGltZXMgYXMgaWRlbnRpZmllciAobGluZSAkUGFyYW17Q291bnRlcn0pLiEiLAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm4gKCB1bmRlZiwgJ0ZhaWxlZCcgKTsKICAgICAgICB9CiAgICAgICAgZWxzaWYgKCAkTWFwcGluZ09iamVjdERhdGEtPntJZGVudGlmaWVyfSApIHsKICAgICAgICAgICAgJElkZW50aWZpZXJ7ICRNYXBwaW5nT2JqZWN0RGF0YS0+e0tleX0gfSA9CiAgICAgICAgICAgICAgICAkUGFyYW17SW1wb3J0RGF0YVJvd30tPlskQ291bnRlcl07CiAgICAgICAgICAgICRTZXJ2aWNlSWRlbnRpZmllcktleSA9ICRNYXBwaW5nT2JqZWN0RGF0YS0+e0tleX07CiAgICAgICAgfQogICAgICAgICROZXdTZXJ2aWNlRGF0YXsgJE1hcHBpbmdPYmplY3REYXRhLT57S2V5fSB9ID0KICAgICAgICAgICAgJFBhcmFte0ltcG9ydERhdGFSb3d9LT5bJENvdW50ZXJdOwoKICAgICAgICAjRU8gc3BlY2lhbCB0cmVhdG1lbnQKICAgICAgICAkQ291bnRlcisrOwogICAgfQoKICAgICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgIyBETyBUSEUgSU1QT1JULi4uCiAgICAjKDApIFByZXByb2Nlc3MgZGF0YS4uLgogICAgaWYgKCAhJE5ld1NlcnZpY2VEYXRhe0Z1bGxOYW1lfSApIHsKICAgICAgICAkTmV3U2VydmljZURhdGF7RnVsbE5hbWV9ID0gJE5ld1NlcnZpY2VEYXRhe05hbWV9OwogICAgfQoKICAgICMgbG9va3VwIFZhbGlkLUlELi4uCiAgICBpZiAoICEkTmV3U2VydmljZURhdGF7VmFsaWRJRH0gJiYgJE5ld1NlcnZpY2VEYXRhe1ZhbGlkfSApIHsKICAgICAgICAkTmV3U2VydmljZURhdGF7VmFsaWRJRH0gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VmFsaWQnKS0+VmFsaWRMb29rdXAoCiAgICAgICAgICAgIFZhbGlkID0+ICROZXdTZXJ2aWNlRGF0YXtWYWxpZH0KICAgICAgICApOwogICAgfQoKICAgICMgZGVmYXVsdCB2YWxpZGl0eS4uLgogICAgaWYgKCAhJE5ld1NlcnZpY2VEYXRhe1ZhbGlkSUR9ICkgewogICAgICAgICROZXdTZXJ2aWNlRGF0YXtWYWxpZElEfSA9ICRPYmplY3REYXRhLT57RGVmYXVsdFZhbGlkfSB8fCAxOwogICAgfQoKICAgICMgbG9va3VwIGNyaXRpY2FsaXR5LUlELi4uCiAgICBpZiAoCiAgICAgICAgJFNlbGYtPntSZXZlcnNlQ3JpdGljYWxpdHlMaXN0fQogICAgICAgICYmICROZXdTZXJ2aWNlRGF0YXtDcml0aWNhbGl0eX0KICAgICAgICAmJiAkU2VsZi0+e1JldmVyc2VDcml0aWNhbGl0eUxpc3R9LT57ICROZXdTZXJ2aWNlRGF0YXtDcml0aWNhbGl0eX0gfQogICAgICAgICkKICAgIHsKICAgICAgICAkTmV3U2VydmljZURhdGF7Q3JpdGljYWxpdHlJRH0gPQogICAgICAgICAgICAkU2VsZi0+e1JldmVyc2VDcml0aWNhbGl0eUxpc3R9LT57ICROZXdTZXJ2aWNlRGF0YXtDcml0aWNhbGl0eX0gfTsKICAgIH0KICAgIGlmICggISROZXdTZXJ2aWNlRGF0YXtDcml0aWNhbGl0eUlEfSApIHsKICAgICAgICAkTmV3U2VydmljZURhdGF7Q3JpdGljYWxpdHlJRH0gPSAkT2JqZWN0RGF0YS0+e0RlZmF1bHRDcml0aWNhbGl0eUlEfTsKICAgIH0KCiAgICAjIGxvb2t1cCB0eXBlLUlELi4uCiAgICBpZiAoCiAgICAgICAgJFNlbGYtPntSZXZlcnNlU2VydmljZVR5cGVMaXN0fQogICAgICAgICYmICROZXdTZXJ2aWNlRGF0YXtUeXBlfQogICAgICAgICYmICRTZWxmLT57UmV2ZXJzZVNlcnZpY2VUeXBlTGlzdH0tPnsgJE5ld1NlcnZpY2VEYXRhe1R5cGV9IH0KICAgICAgICApCiAgICB7CiAgICAgICAgJE5ld1NlcnZpY2VEYXRhe1R5cGVJRH0gPSAkU2VsZi0+e1JldmVyc2VTZXJ2aWNlVHlwZUxpc3R9LT57ICROZXdTZXJ2aWNlRGF0YXtUeXBlfSB9OwogICAgfQogICAgaWYgKCAhJE5ld1NlcnZpY2VEYXRhe1R5cGVJRH0gKSB7CiAgICAgICAgJE5ld1NlcnZpY2VEYXRhe1R5cGVJRH0gPSAkT2JqZWN0RGF0YS0+e0RlZmF1bHRTZXJ2aWNlVHlwZUlEfTsKICAgIH0KICAgIGlmICggJE5ld1NlcnZpY2VEYXRhe05hbWV9ICYmICROZXdTZXJ2aWNlRGF0YXtOYW1lfSA9fiAvOjovICkgewogICAgICAgIG15IEBOYW1lUGFydHNBcnIgPSBzcGxpdCggIjo6IiwgJE5ld1NlcnZpY2VEYXRhe05hbWV9ICk7CiAgICAgICAgJE5ld1NlcnZpY2VEYXRhe05hbWV9ICAgICA9IHBvcChATmFtZVBhcnRzQXJyKTsKICAgICAgICAkTmV3U2VydmljZURhdGF7UGFyZW50SUR9ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlNlcnZpY2UnKS0+U2VydmljZUxvb2t1cCgKICAgICAgICAgICAgTmFtZSA9PiBqb2luKCAiOjoiLCBATmFtZVBhcnRzQXJyICksCiAgICAgICAgKTsKICAgIH0KCiAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAjIHByZXBhcmUgcHJlZmVyZW5jZXMuLi4KCiAgICAjIGdldCBwcmVmZXJlbmNlcyBjb25maWd1cmF0aW9uLi4uCiAgICBteSAlUHJlZmVyZW5jZXMgPSAoKTsKICAgIGlmICggJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpDb25maWcnKS0+R2V0KCdTZXJ2aWNlUHJlZmVyZW5jZXMnKSApIHsKICAgICAgICBteSAlUHJlZkNvbmZpZyA9ICV7ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyktPkdldCgnU2VydmljZVByZWZlcmVuY2VzJykgfTsKICAgICAgICBmb3IgbXkgJEN1cnJLZXkgKCBrZXlzKCVQcmVmQ29uZmlnKSApIHsKICAgICAgICAgICAgbXkgJUN1cnJQcmVmcyA9ICgpOwogICAgICAgICAgICAkQ3VyclByZWZze0xhYmVsfSAgICAgICAgICAgICAgID0gJFByZWZDb25maWd7JEN1cnJLZXl9LT57TGFiZWx9OwogICAgICAgICAgICAkQ3VyclByZWZze1NlbGVjdGlvblNvdXJjZX0gICAgID0gJFByZWZDb25maWd7JEN1cnJLZXl9LT57U2VsZWN0aW9uU291cmNlfTsKICAgICAgICAgICAgJEN1cnJQcmVmc3tHZW5lcmFsQ2F0YWxvZ0NsYXNzfSA9ICRQcmVmQ29uZmlneyRDdXJyS2V5fS0+e0dlbmVyYWxDYXRhbG9nQ2xhc3N9OwogICAgICAgICAgICAkUHJlZmVyZW5jZXN7ICRQcmVmQ29uZmlneyRDdXJyS2V5fS0+e1ByZWZLZXl9IH0gPSBcJUN1cnJQcmVmczsKICAgICAgICB9CiAgICB9CgogICAgUFJFRkVSRU5DRUNIRUNLOgogICAgZm9yIG15ICRDdXJyS2V5ICgga2V5cyglTmV3U2VydmljZURhdGEpICkgewogICAgICAgIG15ICRDdXJyVXNlZEtleSA9ICIiOwogICAgICAgIG15ICROYW1lUGFydCAgICA9ICRDdXJyS2V5OwogICAgICAgIGlmICggJEN1cnJLZXkgPX4gL14oLispSUQkLyApIHsKICAgICAgICAgICAgJE5hbWVQYXJ0ICAgID0gJDE7CiAgICAgICAgICAgICRDdXJyVXNlZEtleSA9ICRDdXJyS2V5OwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJEN1cnJVc2VkS2V5ID0gJEN1cnJLZXkgLiAiSUQiOwogICAgICAgIH0KCiAgICAgICAgIyBza2lwIGlmIG5vIHByZWZlcmVuY2Ugd2l0aCBzYW1lIG5hbWUgYnV0IHN1ZmZpeCAiSUQiIGV4aXN0cy4uLgogICAgICAgIG5leHQgUFJFRkVSRU5DRUNIRUNLIGlmICggISRQcmVmZXJlbmNlc3skQ3VyclVzZWRLZXl9ICk7CgogICAgICAgICMgc2tpcCBpZiBubyBTZWxlY3Rpb25Tb3VyY2Ugc3BlY2lmaWVkLi4KICAgICAgICBuZXh0IFBSRUZFUkVOQ0VDSEVDSyBpZiAoICEkUHJlZmVyZW5jZXN7JEN1cnJVc2VkS2V5fS0+e1NlbGVjdGlvblNvdXJjZX0gKTsKCiAgICAgICAgIyBjaGVjayBmb3Igc291cmNlIG9mIHByZWZlcmVuY2UuLi4KICAgICAgICBteSAlU2VsZWN0aW9uTGlzdCA9ICgpOwogICAgICAgIGlmICggJFByZWZlcmVuY2VzeyRDdXJyVXNlZEtleX0tPntTZWxlY3Rpb25Tb3VyY2V9IGVxICdRdWV1ZUxpc3QnICkgewogICAgICAgICAgICAlU2VsZWN0aW9uTGlzdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpRdWV1ZScpLT5RdWV1ZUxpc3QoKTsKICAgICAgICB9CiAgICAgICAgZWxzaWYgKCAkUHJlZmVyZW5jZXN7JEN1cnJVc2VkS2V5fS0+e1NlbGVjdGlvblNvdXJjZX0gZXEgJ1R5cGVMaXN0JyApIHsKICAgICAgICAgICAgJVNlbGVjdGlvbkxpc3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VHlwZScpLT5UeXBlTGlzdCgpOwogICAgICAgIH0KICAgICAgICBlbHNpZiAoCiAgICAgICAgICAgICggJFByZWZlcmVuY2VzeyRDdXJyVXNlZEtleX0tPntTZWxlY3Rpb25Tb3VyY2V9IGVxICdHZW5lcmFsQ2F0YWxvZycgKQogICAgICAgICAgICAmJgogICAgICAgICAgICAoICRQcmVmZXJlbmNlc3skQ3VyclVzZWRLZXl9LT57R2VuZXJhbENhdGFsb2dDbGFzc30gKSAmJgogICAgICAgICAgICAkU2VsZi0+e0dlbmVyYWxDYXRhbG9nT2JqZWN0fQogICAgICAgICAgICApCiAgICAgICAgewogICAgICAgICAgICBteSAkSXRlbUxpc3RSZWYgPSAkU2VsZi0+e0dlbmVyYWxDYXRhbG9nT2JqZWN0fS0+SXRlbUxpc3QoCiAgICAgICAgICAgICAgICBDbGFzcyA9PiAkUHJlZmVyZW5jZXN7JEN1cnJVc2VkS2V5fS0+e0dlbmVyYWxDYXRhbG9nQ2xhc3N9LAogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoICRJdGVtTGlzdFJlZiAmJiByZWYoJEl0ZW1MaXN0UmVmKSBlcSAnSEFTSCcgKSB7CiAgICAgICAgICAgICAgICAlU2VsZWN0aW9uTGlzdCA9ICV7JEl0ZW1MaXN0UmVmfTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBteSAlUmV2ZXJzZVNlbGVjdGlvbkxpc3QgPSByZXZlcnNlKCVTZWxlY3Rpb25MaXN0KTsKICAgICAgICAKICAgICAgICAjIGNvbnNpZGVyICctJyB2YWx1ZXMgYXMgZW1wdHkgIAogICAgICAgICROZXdTZXJ2aWNlRGF0YXskQ3VyclVzZWRLZXl9ID0gJycgaWYgKCROZXdTZXJ2aWNlRGF0YXskQ3VyclVzZWRLZXl9IGVxICctJyk7CiAgICAgICAgJE5ld1NlcnZpY2VEYXRheyROYW1lUGFydH0gPSAnJyBpZiAoJE5ld1NlcnZpY2VEYXRheyROYW1lUGFydH0gZXEgJy0nKTsKCiAgICAgICAgIyBpZiBvbmx5IHh4eElEIGlzIGdpdmVuLCBzZXQgeHh4Li4uCiAgICAgICAgaWYgKAogICAgICAgICAgICAkTmV3U2VydmljZURhdGF7JEN1cnJVc2VkS2V5fQogICAgICAgICAgICAmJiAoICEkTmV3U2VydmljZURhdGF7JE5hbWVQYXJ0fSB8fCAkTmFtZVBhcnQgZXEgJEN1cnJVc2VkS2V5ICkKICAgICAgICAgICAgKQogICAgICAgIHsKICAgICAgICAgICAgJE5ld1NlcnZpY2VEYXRheyROYW1lUGFydH0gPSAkU2VsZWN0aW9uTGlzdHsgJE5ld1NlcnZpY2VEYXRheyRDdXJyVXNlZEtleX0gfTsKICAgICAgICB9CgogICAgICAgICMgaWYgeHh4SUQgQU5EIHh4eCBhcmUgZ2l2ZW4gcmVxdWlyZSB1bmlxZW5lc3MuLi4KICAgICAgICBlbHNpZiAoICROZXdTZXJ2aWNlRGF0YXskQ3VyclVzZWRLZXl9ICYmICROZXdTZXJ2aWNlRGF0YXskTmFtZVBhcnR9ICkgewogICAgICAgICAgICBteSAkQ29tcGFyZVZhbHVlID0gJFNlbGVjdGlvbkxpc3R7ICROZXdTZXJ2aWNlRGF0YXskQ3VyclVzZWRLZXl9IH07CiAgICAgICAgICAgIGlmICggJENvbXBhcmVWYWx1ZSBuZSAkTmV3U2VydmljZURhdGF7JE5hbWVQYXJ0fSApIHsKICAgICAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkNhbid0IGltcG9ydCB0aGlzIGVudGl0eS4gIgogICAgICAgICAgICAgICAgICAgICAgICAuICJBbWJpZ291cyBkZWZpbml0aW9uIG9mIGF0dHJpYnV0ZSB2YWx1ZXMgIgogICAgICAgICAgICAgICAgICAgICAgICAuICIgKCROYW1lUGFydCA8JE5ld1NlcnZpY2VEYXRheyROYW1lUGFydH0+IGRvZXMgbm90IgogICAgICAgICAgICAgICAgICAgICAgICAuICJtYXRjaCAkQ3VyclVzZWRLZXkgPCROZXdTZXJ2aWNlRGF0YXskQ3VyclVzZWRLZXl9PikhIiwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICByZXR1cm4gKCB1bmRlZiwgJ0ZhaWxlZCcgKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgIyBpZiBvbmx5IHh4eCBpcyBnaXZlbiBhbmQgSUQgY2FuIGJlIGZvdW5kIC0gZ2V0IHRoZSBJRC4uLgogICAgICAgIGVsc2lmICggISROZXdTZXJ2aWNlRGF0YXskQ3VyclVzZWRLZXl9CiAgICAgICAgICAgICYmICROZXdTZXJ2aWNlRGF0YXskTmFtZVBhcnR9CiAgICAgICAgICAgICYmICRSZXZlcnNlU2VsZWN0aW9uTGlzdHsgJE5ld1NlcnZpY2VEYXRheyROYW1lUGFydH0gfSApCiAgICAgICAgewogICAgICAgICAgICAkTmV3U2VydmljZURhdGF7JEN1cnJVc2VkS2V5fSA9ICRSZXZlcnNlU2VsZWN0aW9uTGlzdHsgJE5ld1NlcnZpY2VEYXRheyROYW1lUGFydH0gfTsKICAgICAgICB9CgogICAgICAgICMgaWYgb25seSB4eHggaXMgZ2l2ZW4gYW5kIG5vIElEIGNhbiBiZSBmb3VuZCAtIHJlamVjdCBpbXBvcnQuLi4KICAgICAgICBlbHNpZiAoICEkTmV3U2VydmljZURhdGF7JEN1cnJVc2VkS2V5fQogICAgICAgICAgICAmJiAkTmV3U2VydmljZURhdGF7JE5hbWVQYXJ0fQogICAgICAgICAgICAmJiAhJFJldmVyc2VTZWxlY3Rpb25MaXN0eyAkTmV3U2VydmljZURhdGF7JE5hbWVQYXJ0fSB9ICkKICAgICAgICB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJDYW4ndCBpbXBvcnQgdGhpcyBlbnRpdHkuICIKICAgICAgICAgICAgICAgICAgICAuICJCYWQgZGVmaW5pdGlvbiBvZiBhdHRyaWJ1dGUgdmFsdWUgIgogICAgICAgICAgICAgICAgICAgIC4gIiAoJE5hbWVQYXJ0IDwkTmV3U2VydmljZURhdGF7JE5hbWVQYXJ0fT4gZG9lcyBub3QiCiAgICAgICAgICAgICAgICAgICAgLiAibWF0Y2ggYW55IGV4aXN0aW5nIHZhbHVlIGluIHNlbGVjdGlvbikhIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuICggdW5kZWYsICdGYWlsZWQnICk7CiAgICAgICAgfQoKICAgIH0KCiAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAjKDEpIHNlYXJjaCBzZXJ2aWNlLi4uCiAgICBteSAlU2VydmljZURhdGEgPSAoKTsKICAgIG15ICROZXdTZXJ2aWNlICA9IDE7CiAgICBteSAkU2VydmljZUlEICAgPSAkTmV3U2VydmljZURhdGF7JFNlcnZpY2VJZGVudGlmaWVyS2V5fSB8fCAwOwogICAgaWYgKAogICAgICAgICEkU2VydmljZUlkZW50aWZpZXJLZXkKICAgICAgICB8fCAkU2VydmljZUlkZW50aWZpZXJLZXkgZXEgJ05hbWUnCiAgICAgICAgfHwgISROZXdTZXJ2aWNlRGF0YXskU2VydmljZUlkZW50aWZpZXJLZXl9CiAgICAgICAgKQogICAgewogICAgICAgIGlmICggJE5ld1NlcnZpY2VEYXRhe0Z1bGxOYW1lfSApIHsKICAgICAgICAgICAgJFNlcnZpY2VJRCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTZXJ2aWNlJyktPlNlcnZpY2VMb29rdXAoCiAgICAgICAgICAgICAgICBOYW1lID0+ICROZXdTZXJ2aWNlRGF0YXtGdWxsTmFtZX0sCiAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgfQogICAgaWYgKCRTZXJ2aWNlSUQpIHsKICAgICAgICAlU2VydmljZURhdGEgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U2VydmljZScpLT5TZXJ2aWNlR2V0KAogICAgICAgICAgICBTZXJ2aWNlSUQgPT4gJFNlcnZpY2VJRCwKICAgICAgICAgICAgVXNlcklEICAgID0+IDEsCiAgICAgICAgKTsKICAgIH0KICAgIGlmICggc2NhbGFyKCBrZXlzKCVTZXJ2aWNlRGF0YSkgKSApIHsKICAgICAgICAkTmV3U2VydmljZSA9IDA7CiAgICB9CiAgICBmb3IgbXkgJEtleSAoIGtleXMoJU5ld1NlcnZpY2VEYXRhKSApIHsKICAgICAgICBuZXh0IGlmICggISROZXdTZXJ2aWNlRGF0YXskS2V5fSApOwogICAgICAgICRTZXJ2aWNlRGF0YXskS2V5fSA9ICROZXdTZXJ2aWNlRGF0YXskS2V5fTsKICAgIH0KCiAgICAjKDIpIGlmIHNlcnZpY2UgRE9FUyBOT1QgZXhpc3QgPT4gY3JlYXRlIG5ldy4uLgogICAgbXkgJFJlc3VsdCA9IDA7CiAgICBteSAkUmV0dXJuQ29kZSA9ICIiOyAgICAjIENyZWF0ZWQgfCBDaGFuZ2VkIHwgRmFpbGVkCiAgICAgICAgCiAgICBpZiAoICROZXdTZXJ2aWNlICYmICRTZXJ2aWNlRGF0YXtOYW1lfSAmJiAkU2VydmljZURhdGF7VmFsaWRJRH0gKSB7CiAgICAgICAgaWYgKCAkU2VydmljZURhdGF7RnVsbE5hbWV9ICkgewogICAgICAgICAgICBteSBATmFtZVBhcnRzQXJyID0gc3BsaXQoICI6OiIsICRTZXJ2aWNlRGF0YXtGdWxsTmFtZX0gKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIHBvcChATmFtZVBhcnRzQXJyKTsKICAgICAgICAgICAgbXkgJFBhcmVudFNlcnZpY2VJRCA9IDA7CiAgICAgICAgICAgIG15ICRTZXJ2aWNlRnVsbG5hbWUgPSAnJzsKICAgICAgICAgICAgZm9yIG15ICRTZXJ2aWNlUGFydE5hbWUgKEBOYW1lUGFydHNBcnIpIHsKICAgICAgICAgICAgICAgICRTZXJ2aWNlRnVsbG5hbWUgLj0gJzo6JyBpZiAoJFNlcnZpY2VGdWxsbmFtZSk7ICAgCiAgICAgICAgICAgICAgICAkU2VydmljZUZ1bGxuYW1lIC49ICRTZXJ2aWNlUGFydE5hbWU7ICAgCgogICAgICAgICAgICAgICAgbXkgJER1bW15U2VydmljZUlEID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlNlcnZpY2UnKS0+U2VydmljZUxvb2t1cCgKICAgICAgICAgICAgICAgICAgICBOYW1lID0+ICRTZXJ2aWNlRnVsbG5hbWUsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgaWYgKCEkRHVtbXlTZXJ2aWNlSUQpIHsKICAgICAgICAgICAgICAgICAgICBteSAlUGFyZW50U2VydmljZURhdGE7CiAgICAgICAgICAgICAgICAgICAgJFBhcmVudFNlcnZpY2VEYXRheydOYW1lJ30gPSAkU2VydmljZVBhcnROYW1lOwogICAgICAgICAgICAgICAgICAgICRQYXJlbnRTZXJ2aWNlRGF0YXsnUGFyZW50SUQnfSA9ICRQYXJlbnRTZXJ2aWNlSUQgaWYgJFBhcmVudFNlcnZpY2VJRDsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBmb3IgbXkgJFNlcnZpY2VLZXkgKHF3KENyaXRpY2FsaXR5IFR5cGVJRCBWYWxpZElEKSkgewogICAgICAgICAgICAgICAgICAgICAgICAkUGFyZW50U2VydmljZURhdGF7JFNlcnZpY2VLZXl9ID0gJFNlcnZpY2VEYXRheyRTZXJ2aWNlS2V5fSBpZiAkU2VydmljZURhdGF7JFNlcnZpY2VLZXl9OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAkRHVtbXlTZXJ2aWNlSUQgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U2VydmljZScpLT5TZXJ2aWNlQWRkKAogICAgICAgICAgICAgICAgICAgICAgICAlUGFyZW50U2VydmljZURhdGEsCiAgICAgICAgICAgICAgICAgICAgICAgIFVzZXJJRCA9PiAkUGFyYW17VXNlcklEfSwKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbXkgJU5ld0R1bW15U2VydmljZURhdGEgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U2VydmljZScpLT5TZXJ2aWNlR2V0KAogICAgICAgICAgICAgICAgICAgIFNlcnZpY2VJRCA9PiAkRHVtbXlTZXJ2aWNlSUQsCiAgICAgICAgICAgICAgICAgICAgVXNlcklEICAgID0+IDEsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgaWYgKCVOZXdEdW1teVNlcnZpY2VEYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCgkTmV3RHVtbXlTZXJ2aWNlRGF0YXtQYXJlbnRJRH0gJiYgJFBhcmVudFNlcnZpY2VJRCAhPSAkTmV3RHVtbXlTZXJ2aWNlRGF0YXtQYXJlbnRJRH0pCiAgICAgICAgICAgICAgICAgICAgICAgIHx8ICghJE5ld0R1bW15U2VydmljZURhdGF7UGFyZW50SUR9ICYmICRQYXJlbnRTZXJ2aWNlSUQpCiAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgJE5ld0R1bW15U2VydmljZURhdGF7UGFyZW50SUR9ID0gJFBhcmVudFNlcnZpY2VJRDsKICAgICAgICAgICAgICAgICAgICAgICAgJFJlc3VsdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTZXJ2aWNlJyktPlNlcnZpY2VVcGRhdGUoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAlTmV3RHVtbXlTZXJ2aWNlRGF0YSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVzZXJJRCA9PiAkUGFyYW17VXNlcklEfSwKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJFBhcmVudFNlcnZpY2VJRCA9ICROZXdEdW1teVNlcnZpY2VEYXRhe1NlcnZpY2VJRH07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJFNlcnZpY2VEYXRhe1BhcmVudElEfSA9ICRQYXJlbnRTZXJ2aWNlSUQ7CiAgICAgICAgfQogICAgICAgICRSZXN1bHQgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U2VydmljZScpLT5TZXJ2aWNlQWRkKAogICAgICAgICAgICAlU2VydmljZURhdGEsCiAgICAgICAgICAgIFVzZXJJRCA9PiAkUGFyYW17VXNlcklEfSwKICAgICAgICApOwogICAgICAgIGlmICggISRSZXN1bHQgKSB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdJbXBvcnREYXRhU2F2ZTogYWRkaW5nIHNlcnZpY2UgPCcKICAgICAgICAgICAgICAgICAgICAuICRTZXJ2aWNlRGF0YXtOYW1lfQogICAgICAgICAgICAgICAgICAgIC4gJz4gZmFpbGVkIChsaW5lICRQYXJhbXtDb3VudGVyfSkuJywKICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRSZXR1cm5Db2RlID0gIkNyZWF0ZWQiOwogICAgICAgICAgICAkU2VydmljZUlEID0gJFJlc3VsdDsKICAgICAgICB9ICAgICAgICAgICAgICAgIAogICAgfQoKICAgICMoMykgaWYgc2VydmljZSBET0VTIGV4aXN0ID0+IHVwZGF0ZS4uLgogICAgaWYgKCAhJE5ld1NlcnZpY2UgJiYgJFNlcnZpY2VEYXRhe05hbWV9ICYmICRTZXJ2aWNlRGF0YXtWYWxpZElEfSApIHsKICAgICAgICAkUmVzdWx0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlNlcnZpY2UnKS0+U2VydmljZVVwZGF0ZSgKICAgICAgICAgICAgJVNlcnZpY2VEYXRhLAogICAgICAgICAgICBVc2VySUQgPT4gJFBhcmFte1VzZXJJRH0sCiAgICAgICAgKTsKICAgICAgICBpZiAoICEkUmVzdWx0ICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnSW1wb3J0RGF0YVNhdmU6IHVwZGF0aW5nIHNlcnZpY2UgPCcKICAgICAgICAgICAgICAgICAgICAuICRTZXJ2aWNlRGF0YXtOYW1lfQogICAgICAgICAgICAgICAgICAgIC4gJz4gKElEICcKICAgICAgICAgICAgICAgICAgICAuICRTZXJ2aWNlRGF0YXtTZXJ2aWNlSUR9CiAgICAgICAgICAgICAgICAgICAgLiAnKSBmYWlsZWQgKGxpbmUgJFBhcmFte0NvdW50ZXJ9KS4nLAogICAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJFJldHVybkNvZGUgPSAiQ2hhbmdlZCI7CiAgICAgICAgfSAgICAgICAgICAgICAgICAKICAgIH0KCiAgICAjKDQpIHNldCBwcmVmZXJlbmNlcy4uLgogICAgaWYgKCRTZXJ2aWNlSUQpIHsKICAgICAgICBmb3IgbXkgJEN1cnJLZXkgKCBrZXlzKCVQcmVmZXJlbmNlcykgKSB7CiAgICAgICAgICAgIG5leHQgaWYgKCAhJE5ld1NlcnZpY2VEYXRheyRDdXJyS2V5fSApOwogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U2VydmljZScpLT5TZXJ2aWNlUHJlZmVyZW5jZXNTZXQoCiAgICAgICAgICAgICAgICBTZXJ2aWNlSUQgPT4gJFNlcnZpY2VJRCwKICAgICAgICAgICAgICAgIEtleSAgICAgICA9PiAkQ3VycktleSwKICAgICAgICAgICAgICAgIFZhbHVlICAgICA9PiAkTmV3U2VydmljZURhdGF7JEN1cnJLZXl9LAogICAgICAgICAgICAgICAgVXNlcklEICAgID0+ICRQYXJhbXtVc2VySUR9LAogICAgICAgICAgICApOwogICAgICAgIH0KICAgIH0KCiAgICAjCiAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIHJldHVybiAoICRSZXN1bHQsICRSZXR1cm5Db2RlICk7Cn0KMTsK</File>
        <File Location="Kernel/System/ImportExport/ObjectBackend/Service2CustomerUser.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbC9TeXN0ZW0vSW1wb3J0RXhwb3J0L09iamVjdEJhY2tlbmQvU2VydmljZTJDdXN0b21lclVzZXIucG0KIyBpbXBvcnQvZXhwb3J0IGJhY2tlbmQgZm9yIFNlcnZpY2UyQ3VzdG9tZXJVc2VyLW1hcHBpbmcKIyBDb3B5cmlnaHQgKEMpIDIwMDYtMjAxNSBjLmEucC5lLiBJVCBHbWJILCBodHRwOi8vd3d3LmNhcGUtaXQuZGUKIwojIHdyaXR0ZW4vZWRpdGVkIGJ5OgojICogQW5uYShkb3QpTGl0dmlub3ZhKGF0KWNhcGUoZGFzaClpdChkb3QpZGUKIyAqIFRob21hcyhkb3QpTGFuZ2UoYXQpY2FwZShkYXNoKWl0KGRvdClkZQojIC0tCiMgJElkOiBTZXJ2aWNlMkN1c3RvbWVyVXNlci5wbSx2IDEuMTkgMjAxNS8xMS8xNyAxMToxMzo0OSB0bGFuZ2UgRXhwICQKIyAtLQojIFRoaXMgc29mdHdhcmUgY29tZXMgd2l0aCBBQlNPTFVURUxZIE5PIFdBUlJBTlRZLiBGb3IgZGV0YWlscywgc2VlCiMgdGhlIGVuY2xvc2VkIGZpbGUgQ09QWUlORyBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbiAoQUdQTCkuIElmIHlvdQojIGRpZCBub3QgcmVjZWl2ZSB0aGlzIGZpbGUsIHNlZSBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvZ3BsLTIuMC50eHQuCiMgLS0KCnBhY2thZ2UgS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydDo6T2JqZWN0QmFja2VuZDo6U2VydmljZTJDdXN0b21lclVzZXI7Cgp1c2Ugc3RyaWN0Owp1c2Ugd2FybmluZ3M7CgpvdXIgQE9iamVjdERlcGVuZGVuY2llcyA9ICgKICAgICdLZXJuZWw6OlN5c3RlbTo6U2VydmljZScsCiAgICAnS2VybmVsOjpTeXN0ZW06OkN1c3RvbWVyVXNlcicsCiAgICAnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcsCiAgICAnS2VybmVsOjpTeXN0ZW06OkxvZycsCik7Cgo9aGVhZDEgTkFNRQoKS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydDo6T2JqZWN0QmFja2VuZDo6Q3VzdG9tZXJVc2VyIC0gaW1wb3J0L2V4cG9ydCBiYWNrZW5kIGZvciBDdXN0b21lclVzZXIKCj1oZWFkMSBTWU5PUFNJUwoKQWxsIGZ1bmN0aW9ucyB0byBpbXBvcnQgYW5kIGV4cG9ydCBDdXN0b21lclVzZXIgZW50cmllcwoKPW92ZXIgNAoKPWN1dAoKPWl0ZW0gbmV3KCkKCmNyZWF0ZSBhbiBvYmplY3QKCiAgICB1c2UgS2VybmVsOjpDb25maWc7CiAgICB1c2UgS2VybmVsOjpTeXN0ZW06OkRCOwogICAgdXNlIEtlcm5lbDo6U3lzdGVtOjpMb2c7CiAgICB1c2UgS2VybmVsOjpTeXN0ZW06Ok1haW47CiAgICB1c2UgS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydDo6T2JqZWN0QmFja2VuZDo6Q3VzdG9tZXJVc2VyOwoKICAgIG15ICRDb25maWdPYmplY3QgPSBLZXJuZWw6OkNvbmZpZy0+bmV3KCk7CiAgICBteSAkTG9nT2JqZWN0ID0gS2VybmVsOjpTeXN0ZW06OkxvZy0+bmV3KAogICAgICAgIENvbmZpZ09iamVjdCA9PiAkQ29uZmlnT2JqZWN0LAogICAgKTsKICAgIG15ICRNYWluT2JqZWN0ID0gS2VybmVsOjpTeXN0ZW06Ok1haW4tPm5ldygKICAgICAgICBDb25maWdPYmplY3QgPT4gJENvbmZpZ09iamVjdCwKICAgICAgICBMb2dPYmplY3QgICAgPT4gJExvZ09iamVjdCwKICAgICk7CiAgICBteSAkREJPYmplY3QgPSBLZXJuZWw6OlN5c3RlbTo6REItPm5ldygKICAgICAgICBDb25maWdPYmplY3QgPT4gJENvbmZpZ09iamVjdCwKICAgICAgICBMb2dPYmplY3QgICAgPT4gJExvZ09iamVjdCwKICAgICAgICBNYWluT2JqZWN0ICAgPT4gJE1haW5PYmplY3QsCiAgICApOwogICAgbXkgJEJhY2tlbmRPYmplY3QgPSBLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0OjpPYmplY3RCYWNrZW5kOjpDdXN0b21lclVzZXItPm5ldygKICAgICAgICBDb25maWdPYmplY3QgICAgICAgPT4gJENvbmZpZ09iamVjdCwKICAgICAgICBMb2dPYmplY3QgICAgICAgICAgPT4gJExvZ09iamVjdCwKICAgICAgICBEQk9iamVjdCAgICAgICAgICAgPT4gJERCT2JqZWN0LAogICAgICAgIE1haW5PYmplY3QgICAgICAgICA9PiAkTWFpbk9iamVjdCwKICAgICAgICBJbXBvcnRFeHBvcnRPYmplY3QgPT4gJEltcG9ydEV4cG9ydE9iamVjdCwKICAgICk7Cgo9Y3V0CgpzdWIgbmV3IHsKICAgIG15ICggJFR5cGUsICVQYXJhbSApID0gQF87CgogICAgIyBhbGxvY2F0ZSBuZXcgaGFzaCBmb3Igb2JqZWN0CiAgICBteSAkU2VsZiA9IHt9OwogICAgYmxlc3MoICRTZWxmLCAkVHlwZSApOwoKICAgIHJldHVybiAkU2VsZjsKfQoKPWl0ZW0gT2JqZWN0QXR0cmlidXRlc0dldCgpCgpnZXQgdGhlIG9iamVjdCBhdHRyaWJ1dGVzIG9mIGFuIG9iamVjdCBhcyBhcnJheS9oYXNoIHJlZmVyZW5jZQoKICAgIG15ICRBdHRyaWJ1dGVzID0gJE9iamVjdEJhY2tlbmQtPk9iamVjdEF0dHJpYnV0ZXNHZXQoCiAgICAgICAgVXNlcklEID0+IDEsCiAgICApOwoKPWN1dAoKc3ViIE9iamVjdEF0dHJpYnV0ZXNHZXQgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICAjIGNoZWNrIG5lZWRlZCBvYmplY3QKICAgIGlmICggISRQYXJhbXtVc2VySUR9ICkgewogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKQogICAgICAgICAgICAtPkxvZyggUHJpb3JpdHkgPT4gJ2Vycm9yJywgTWVzc2FnZSA9PiAnTmVlZCBVc2VySUQhJyApOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICBteSAkQXR0cmlidXRlcyA9IFtdOwoKICAgIHJldHVybiAkQXR0cmlidXRlczsKfQoKPWl0ZW0gTWFwcGluZ09iamVjdEF0dHJpYnV0ZXNHZXQoKQoKZ2V0IHRoZSBtYXBwaW5nIGF0dHJpYnV0ZXMgb2YgYW4gb2JqZWN0IGFzIGFycmF5L2hhc2ggcmVmZXJlbmNlCgogICAgbXkgJEF0dHJpYnV0ZXMgPSAkT2JqZWN0QmFja2VuZC0+TWFwcGluZ09iamVjdEF0dHJpYnV0ZXNHZXQoCiAgICAgICAgVGVtcGxhdGVJRCA9PiAxMjMsCiAgICAgICAgVXNlcklEICAgICA9PiAxLAogICAgKTsKCj1jdXQKCnN1YiBNYXBwaW5nT2JqZWN0QXR0cmlidXRlc0dldCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgY2hlY2sgbmVlZGVkIHN0dWZmCiAgICBmb3IgbXkgJEFyZ3VtZW50IChxdyhUZW1wbGF0ZUlEIFVzZXJJRCkpIHsKICAgICAgICBpZiAoICEkUGFyYW17JEFyZ3VtZW50fSApIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5lZWQgJEFyZ3VtZW50ISIsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CgogICAgIyBnZXQgb2JqZWN0IGRhdGEKICAgIG15ICRPYmplY3REYXRhID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5PYmplY3REYXRhR2V0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gJFBhcmFte1RlbXBsYXRlSUR9LAogICAgICAgIFVzZXJJRCAgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICApOwoKICAgIG15ICRFbGVtZW50TGlzdCA9IFsKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdDdXN0b21lclVzZXJMb2dpbicsCiAgICAgICAgICAgIFZhbHVlID0+ICdDdXN0b21lciBVc2VyIExvZ2luJywKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgS2V5ICAgPT4gJ1NlcnZpY2VOYW1lJywKICAgICAgICAgICAgVmFsdWUgPT4gJ1NlcnZpY2UgTmFtZScsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdTZXJ2aWNlSUQnLAogICAgICAgICAgICBWYWx1ZSA9PiAnU2VydmljZSBJRCcsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdBc3NpZ25tZW50QWN0aXZlJywKICAgICAgICAgICAgVmFsdWUgPT4gJ1ZhbGlkaXR5IG9mIHNlcnZpY2UgYXNzaWdubWVudCBmb3IgQ1UnLAogICAgICAgIH0sCgogICAgXTsKCiAgICBteSAkQXR0cmlidXRlcyA9IFsKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdLZXknLAogICAgICAgICAgICBOYW1lICA9PiAnS2V5JywKICAgICAgICAgICAgSW5wdXQgPT4gewogICAgICAgICAgICAgICAgVHlwZSAgICAgICAgID0+ICdTZWxlY3Rpb24nLAogICAgICAgICAgICAgICAgRGF0YSAgICAgICAgID0+ICRFbGVtZW50TGlzdCwKICAgICAgICAgICAgICAgIFJlcXVpcmVkICAgICA9PiAxLAogICAgICAgICAgICAgICAgVHJhbnNsYXRpb24gID0+IDAsCiAgICAgICAgICAgICAgICBQb3NzaWJsZU5vbmUgPT4gMSwKICAgICAgICAgICAgfSwKICAgICAgICB9LAoKICAgICAgICAjIGN1cnJlbnRseSwgdGhlcmUgYXJlIG5vIGFkZGl0aW9uYWwgYXR0cmlidXRlcwogICAgICAgICMgICAgICAgIHsKICAgICAgICAjICAgICAgICAgICAgS2V5ICAgPT4gJ0lkZW50aWZpZXInLAogICAgICAgICMgICAgICAgICAgICBOYW1lICA9PiAnSWRlbnRpZmllcicsCiAgICAgICAgIyAgICAgICAgICAgIElucHV0ID0+IHsgVHlwZSA9PiAnQ2hlY2tib3gnLCB9LAogICAgICAgICMgICAgICAgIH0sCiAgICBdOwoKICAgIHJldHVybiAkQXR0cmlidXRlczsKfQoKPWl0ZW0gU2VhcmNoQXR0cmlidXRlc0dldCgpCgpnZXQgdGhlIHNlYXJjaCBvYmplY3QgYXR0cmlidXRlcyBvZiBhbiBvYmplY3QgYXMgYXJyYXkvaGFzaCByZWZlcmVuY2UKCiAgICBteSAkQXR0cmlidXRlTGlzdCA9ICRPYmplY3RCYWNrZW5kLT5TZWFyY2hBdHRyaWJ1dGVzR2V0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gMTIzLAogICAgICAgIFVzZXJJRCAgICAgPT4gMSwKICAgICk7Cgo9Y3V0CgpzdWIgU2VhcmNoQXR0cmlidXRlc0dldCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgY2hlY2sgbmVlZGVkIHN0dWZmCiAgICBmb3IgbXkgJEFyZ3VtZW50IChxdyhUZW1wbGF0ZUlEIFVzZXJJRCkpIHsKICAgICAgICBpZiAoICEkUGFyYW17JEFyZ3VtZW50fSApIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5lZWQgJEFyZ3VtZW50ISIsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICB9CgogICAgbXkgJEF0dHJpYnV0ZUxpc3QgPSBbCiAgICAgICAgewogICAgICAgICAgICBLZXkgICA9PiAnQ3VzdG9tZXJVc2VyTG9naW4nLAogICAgICAgICAgICBOYW1lICA9PiAnQ3VzdG9tZXIgVXNlciBMb2dpbicsCiAgICAgICAgICAgIElucHV0ID0+IHsKICAgICAgICAgICAgICAgIFR5cGUgICAgICA9PiAnVGV4dCcsCiAgICAgICAgICAgICAgICBTaXplICAgICAgPT4gODAsCiAgICAgICAgICAgICAgICBNYXhMZW5ndGggPT4gMjU1LAogICAgICAgICAgICB9LAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBLZXkgICA9PiAnU2VydmljZU5hbWUnLAogICAgICAgICAgICBOYW1lICA9PiAnU2VydmljZSBOYW1lJywKICAgICAgICAgICAgSW5wdXQgPT4gewogICAgICAgICAgICAgICAgVHlwZSAgICAgID0+ICdUZXh0JywKICAgICAgICAgICAgICAgIFNpemUgICAgICA9PiA4MCwKICAgICAgICAgICAgICAgIE1heExlbmd0aCA9PiAyNTUsCiAgICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgIF07CgogICAgcmV0dXJuICRBdHRyaWJ1dGVMaXN0Owp9Cgo9aXRlbSBFeHBvcnREYXRhR2V0KCkKCmdldCBleHBvcnQgZGF0YSBhcyAyRC1hcnJheS1oYXNoIHJlZmVyZW5jZQoKICAgIG15ICRFeHBvcnREYXRhID0gJE9iamVjdEJhY2tlbmQtPkV4cG9ydERhdGFHZXQoCiAgICAgICAgVGVtcGxhdGVJRCA9PiAxMjMsCiAgICAgICAgVXNlcklEICAgICA9PiAxLAogICAgKTsKCj1jdXQKCnN1YiBFeHBvcnREYXRhR2V0IHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgIyBjaGVjayBuZWVkZWQgc3R1ZmYKICAgIGZvciBteSAkQXJndW1lbnQgKHF3KFRlbXBsYXRlSUQgVXNlcklEKSkgewogICAgICAgIGlmICggISRQYXJhbXskQXJndW1lbnR9ICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiTmVlZCAkQXJndW1lbnQhIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KCiAgICAjIGdldCBvYmplY3QgZGF0YQogICAgbXkgJE9iamVjdERhdGEgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0JyktPk9iamVjdERhdGFHZXQoCiAgICAgICAgVGVtcGxhdGVJRCA9PiAkUGFyYW17VGVtcGxhdGVJRH0sCiAgICAgICAgVXNlcklEICAgICA9PiAkUGFyYW17VXNlcklEfSwKICAgICk7CgogICAgIyBjaGVjayBvYmplY3QgZGF0YQogICAgaWYgKCAhJE9iamVjdERhdGEgfHwgcmVmICRPYmplY3REYXRhIG5lICdIQVNIJyApIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIG9iamVjdCBkYXRhIGZvdW5kIGZvciB0aGUgdGVtcGxhdGUgaWQgJFBhcmFte1RlbXBsYXRlSUR9IiwKICAgICAgICApOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICAjIGdldCB0aGUgbWFwcGluZyBsaXN0CiAgICBteSAkTWFwcGluZ0xpc3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0JyktPk1hcHBpbmdMaXN0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gJFBhcmFte1RlbXBsYXRlSUR9LAogICAgICAgIFVzZXJJRCAgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICApOwoKICAgICMgY2hlY2sgdGhlIG1hcHBpbmcgbGlzdAogICAgaWYgKCAhJE1hcHBpbmdMaXN0IHx8IHJlZiAkTWFwcGluZ0xpc3QgbmUgJ0FSUkFZJyB8fCAhQHskTWFwcGluZ0xpc3R9ICkgewoKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIHZhbGlkIG1hcHBpbmcgbGlzdCBmb3VuZCBmb3IgdGhlIHRlbXBsYXRlIGlkICRQYXJhbXtUZW1wbGF0ZUlEfSIsCiAgICAgICAgKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgIyBjcmVhdGUgdGhlIG1hcHBpbmcgb2JqZWN0IGxpc3QKICAgIG15IEBNYXBwaW5nT2JqZWN0TGlzdDsKICAgIGZvciBteSAkTWFwcGluZ0lEICggQHskTWFwcGluZ0xpc3R9ICkgewoKICAgICAgICAjIGdldCBtYXBwaW5nIG9iamVjdCBkYXRhCiAgICAgICAgbXkgJE1hcHBpbmdPYmplY3REYXRhID0KICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5NYXBwaW5nT2JqZWN0RGF0YUdldCgKICAgICAgICAgICAgTWFwcGluZ0lEID0+ICRNYXBwaW5nSUQsCiAgICAgICAgICAgIFVzZXJJRCAgICA9PiAkUGFyYW17VXNlcklEfSwKICAgICAgICAgICAgKTsKCiAgICAgICAgIyBjaGVjayBtYXBwaW5nIG9iamVjdCBkYXRhCiAgICAgICAgaWYgKCAhJE1hcHBpbmdPYmplY3REYXRhIHx8IHJlZiAkTWFwcGluZ09iamVjdERhdGEgbmUgJ0hBU0gnICkgewoKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIHZhbGlkIG1hcHBpbmcgbGlzdCBmb3VuZCBmb3IgdGhlIHRlbXBsYXRlIGlkICRQYXJhbXtUZW1wbGF0ZUlEfSIsCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHB1c2goIEBNYXBwaW5nT2JqZWN0TGlzdCwgJE1hcHBpbmdPYmplY3REYXRhICk7CiAgICB9CgogICAgIyBnZXQgc2VhcmNoIGRhdGEKICAgIG15ICRTZWFyY2hEYXRhID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5TZWFyY2hEYXRhR2V0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gJFBhcmFte1RlbXBsYXRlSUR9LAogICAgICAgIFVzZXJJRCAgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICApOwoKICAgIGlmICggJFNlYXJjaERhdGEgJiYgcmVmKCRTZWFyY2hEYXRhKSBuZSAnSEFTSCcgKSB7CiAgICAgICAgJFNlYXJjaERhdGEgPSAwOwogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICBNZXNzYWdlID0+CiAgICAgICAgICAgICAgICAiU2VydmljZTJDdXN0b21lclVzZXI6IHNlYXJjaCBkYXRhIGlzIG5vdCBhIGhhc2ggcmVmIC0gaWdub3Jpbmcgc2VhcmNoIGxpbWl0YXRpb24uIiwKICAgICAgICApOwogICAgfQoKICAgIGlmICggJFNlYXJjaERhdGEgJiYgJFNlYXJjaERhdGEtPntTZXJ2aWNlTmFtZX0gJiYgJFNlYXJjaERhdGEtPntTZXJ2aWNlTmFtZX0gPX4gL1wqLyApIHsKICAgICAgICAkU2VhcmNoRGF0YS0+e1NlcnZpY2VOYW1lfSA9fiBzL1wqLy4qL2c7CiAgICB9CiAgICBpZiAoCiAgICAgICAgJFNlYXJjaERhdGEKICAgICAgICAmJiAkU2VhcmNoRGF0YS0+e0N1c3RvbWVyVXNlckxvZ2lufQogICAgICAgICYmICRTZWFyY2hEYXRhLT57Q3VzdG9tZXJVc2VyTG9naW59ID1+IC9cKi8KICAgICAgICApCiAgICB7CiAgICAgICAgJFNlYXJjaERhdGEtPntDdXN0b21lclVzZXJMb2dpbn0gPX4gcy9cKi8uKi9nOwogICAgfQoKICAgICNzZWFyY2ggYWxsIHNlcnZpY2VzLi4uCiAgICBteSAlU2VydmljZURhdGEgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U2VydmljZScpLT5TZXJ2aWNlTGlzdCgKICAgICAgICBWYWxpZCAgPT4gMCwKICAgICAgICBVc2VySUQgPT4gMSwKICAgICk7CgogICAgIyBleHBvcnQgZGF0YS4uLgogICAgbXkgQEV4cG9ydERhdGE7CgogICAgZm9yIG15ICRTZXJ2aWNlSUQgKCBrZXlzKCVTZXJ2aWNlRGF0YSkgKSB7CgogICAgICAgICNjaGVjayBmb3IgU2VydmljZU5hbWUgZXhwb3J0IGZpbHRlci4uLgogICAgICAgIGlmICggJFNlYXJjaERhdGEgJiYgJFNlYXJjaERhdGEtPntTZXJ2aWNlTmFtZX0gKSB7CiAgICAgICAgICAgIGlmICggJFNlYXJjaERhdGEtPntTZXJ2aWNlTmFtZX0gPX4gL1wqLyApIHsKICAgICAgICAgICAgICAgIG5leHQgaWYgKCAkU2VydmljZURhdGF7JFNlcnZpY2VJRH0gIX4gLyRTZWFyY2hEYXRhLT57U2VydmljZU5hbWV9LyApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgbmV4dCBpZiAoICRTZXJ2aWNlRGF0YXskU2VydmljZUlEfSBuZSAkU2VhcmNoRGF0YS0+e1NlcnZpY2VOYW1lfSApOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjc2VhcmNoIGFsbCBjdXN0b21lcnMgc2V0IGZvciBjdXJyZW50IHNlcnZpY2UuLi4KICAgICAgICBteSAlQ3VzdG9tZXJTZXJ2aWNlSGFzaCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTZXJ2aWNlJyktPkN1c3RvbWVyVXNlclNlcnZpY2VNZW1iZXJMaXN0KAogICAgICAgICAgICBTZXJ2aWNlSUQgICAgICAgPT4gJFNlcnZpY2VJRCwKICAgICAgICAgICAgUmVzdWx0ICAgICAgICAgID0+ICdIQVNIJywKICAgICAgICAgICAgRGVmYXVsdFNlcnZpY2VzID0+IDAsCiAgICAgICAgKTsKCiAgICAgICAgZm9yIG15ICRDdXJyZW50Q1VMICgga2V5cyglQ3VzdG9tZXJTZXJ2aWNlSGFzaCkgKSB7CiAgICAgICAgICAgIG15IEBDdXJyUm93ID0gcXd7fTsKCiAgICAgICAgICAgICNjaGVjayBmb3IgQ3VzdG9tZXJVc2VyTG9naW4gZXhwb3J0IGZpbHRlci4uLgogICAgICAgICAgICBpZiAoICRTZWFyY2hEYXRhICYmICRTZWFyY2hEYXRhLT57Q3VzdG9tZXJVc2VyTG9naW59ICkgewogICAgICAgICAgICAgICAgaWYgKCAkU2VhcmNoRGF0YS0+e0N1c3RvbWVyVXNlckxvZ2lufSA9fiAvXCovICkgewogICAgICAgICAgICAgICAgICAgIG5leHQgaWYgKCAkQ3VycmVudENVTCAhfiAvJFNlYXJjaERhdGEtPntDdXN0b21lclVzZXJMb2dpbn0vICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBuZXh0IGlmICggJEN1cnJlbnRDVUwgbmUgJFNlYXJjaERhdGEtPntTZXJ2aWNlTmFtZX0gKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm9yIG15ICRNYXBwaW5nT2JqZWN0IChATWFwcGluZ09iamVjdExpc3QpIHsKICAgICAgICAgICAgICAgIG15ICRLZXkgPSAkTWFwcGluZ09iamVjdC0+e0tleX07CgogICAgICAgICAgICAgICAgaWYgKCAkTWFwcGluZ09iamVjdC0+e0tleX0gJiYgJE1hcHBpbmdPYmplY3QtPntLZXl9IGVxICdDdXN0b21lclVzZXJMb2dpbicgKSB7CiAgICAgICAgICAgICAgICAgICAgcHVzaCggQEN1cnJSb3csICRDdXJyZW50Q1VMICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNpZiAoICRNYXBwaW5nT2JqZWN0LT57S2V5fSAmJiAkTWFwcGluZ09iamVjdC0+e0tleX0gZXEgJ1NlcnZpY2VOYW1lJyApIHsKICAgICAgICAgICAgICAgICAgICBwdXNoKCBAQ3VyclJvdywgJFNlcnZpY2VEYXRheyRTZXJ2aWNlSUR9IHx8ICcnICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNpZiAoICRNYXBwaW5nT2JqZWN0LT57S2V5fSAmJiAkTWFwcGluZ09iamVjdC0+e0tleX0gZXEgJ1NlcnZpY2VJRCcgKSB7CiAgICAgICAgICAgICAgICAgICAgcHVzaCggQEN1cnJSb3csICRTZXJ2aWNlSUQgfHwgJycgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2lmICggJE1hcHBpbmdPYmplY3QtPntLZXl9ICYmICRNYXBwaW5nT2JqZWN0LT57S2V5fSBlcSAnQXNzaWdubWVudEFjdGl2ZScgKSB7CiAgICAgICAgICAgICAgICAgICAgcHVzaCggQEN1cnJSb3csICd2YWxpZCcgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIHB1c2goIEBDdXJyUm93LCAnLScgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcHVzaCBARXhwb3J0RGF0YSwgXEBDdXJyUm93OwoKICAgICAgICB9CgogICAgfQoKICAgIHJldHVybiBcQEV4cG9ydERhdGE7Cn0KCj1pdGVtIEltcG9ydERhdGFTYXZlKCkKCmltcG9ydCBvbmUgcm93IG9mIHRoZSBpbXBvcnQgZGF0YQoKICAgIG15ICRDb25maWdJdGVtSUQgPSAkT2JqZWN0QmFja2VuZC0+SW1wb3J0RGF0YVNhdmUoCiAgICAgICAgVGVtcGxhdGVJRCAgICA9PiAxMjMsCiAgICAgICAgSW1wb3J0RGF0YVJvdyA9PiAkQXJyYXlSZWYsCiAgICAgICAgVXNlcklEICAgICAgICA9PiAxLAogICAgKTsKCj1jdXQKCnN1YiBJbXBvcnREYXRhU2F2ZSB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgY2hlY2sgbmVlZGVkIHN0dWZmCiAgICBmb3IgbXkgJEFyZ3VtZW50IChxdyhUZW1wbGF0ZUlEIEltcG9ydERhdGFSb3cgVXNlcklEKSkgewogICAgICAgIGlmICggISRQYXJhbXskQXJndW1lbnR9ICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiTmVlZCAkQXJndW1lbnQhIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuICggdW5kZWYsICdGYWlsZWQnICk7CiAgICAgICAgfQogICAgfQoKICAgICMgY2hlY2sgaW1wb3J0IGRhdGEgcm93CiAgICBpZiAoIHJlZiAkUGFyYW17SW1wb3J0RGF0YVJvd30gbmUgJ0FSUkFZJyApIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ0ltcG9ydERhdGFSb3cgbXVzdCBiZSBhbiBhcnJheSByZWZlcmVuY2UnLAogICAgICAgICk7CiAgICAgICAgcmV0dXJuICggdW5kZWYsICdGYWlsZWQnICk7CiAgICB9CgogICAgIyBnZXQgb2JqZWN0IGRhdGEKICAgIG15ICRPYmplY3REYXRhID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5PYmplY3REYXRhR2V0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gJFBhcmFte1RlbXBsYXRlSUR9LAogICAgICAgIFVzZXJJRCAgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICApOwoKICAgICMgY2hlY2sgb2JqZWN0IGRhdGEKICAgIGlmICggISRPYmplY3REYXRhIHx8IHJlZiAkT2JqZWN0RGF0YSBuZSAnSEFTSCcgKSB7CiAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJObyBvYmplY3QgZGF0YSBmb3VuZCBmb3IgdGhlIHRlbXBsYXRlIGlkICRQYXJhbXtUZW1wbGF0ZUlEfSIsCiAgICAgICAgKTsKICAgICAgICByZXR1cm4gKCB1bmRlZiwgJ0ZhaWxlZCcgKTsKICAgIH0KCiAgICAjIGdldCB0aGUgbWFwcGluZyBsaXN0CiAgICBteSAkTWFwcGluZ0xpc3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0JyktPk1hcHBpbmdMaXN0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gJFBhcmFte1RlbXBsYXRlSUR9LAogICAgICAgIFVzZXJJRCAgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICApOwoKICAgICMgY2hlY2sgdGhlIG1hcHBpbmcgbGlzdAogICAgaWYgKCAhJE1hcHBpbmdMaXN0IHx8IHJlZiAkTWFwcGluZ0xpc3QgbmUgJ0FSUkFZJyB8fCAhQHskTWFwcGluZ0xpc3R9ICkgewoKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIHZhbGlkIG1hcHBpbmcgbGlzdCBmb3VuZCBmb3IgdGhlIHRlbXBsYXRlIGlkICRQYXJhbXtUZW1wbGF0ZUlEfSIsCiAgICAgICAgKTsKICAgICAgICByZXR1cm4gKCB1bmRlZiwgJ0ZhaWxlZCcgKTsKICAgIH0KCiAgICAjIGNyZWF0ZSB0aGUgbWFwcGluZyBvYmplY3QgbGlzdAogICAgbXkgQE1hcHBpbmdPYmplY3RMaXN0OwogICAgbXkgJUlkZW50aWZpZXI7CiAgICBteSAkQ291bnRlciAgICAgICAgID0gMDsKICAgIG15ICVJbXBvcnREYXRhICAgICAgPSBxd3t9OwogICAgbXkgJEN1c3RvbWVyVXNlcktleSA9ICIiOwoKICAgICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgI0JVSUxEIE1BUFBJTkcgVEFCTEUuLi4KICAgIGZvciBteSAkTWFwcGluZ0lEICggQHskTWFwcGluZ0xpc3R9ICkgewoKICAgICAgICAjIGdldCBtYXBwaW5nIG9iamVjdCBkYXRhCiAgICAgICAgbXkgJE1hcHBpbmdPYmplY3REYXRhID0KICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5NYXBwaW5nT2JqZWN0RGF0YUdldCgKICAgICAgICAgICAgTWFwcGluZ0lEID0+ICRNYXBwaW5nSUQsCiAgICAgICAgICAgIFVzZXJJRCAgICA9PiAkUGFyYW17VXNlcklEfSwKICAgICAgICAgICAgKTsKCiAgICAgICAgIyBjaGVjayBtYXBwaW5nIG9iamVjdCBkYXRhCiAgICAgICAgaWYgKCAhJE1hcHBpbmdPYmplY3REYXRhIHx8IHJlZiAkTWFwcGluZ09iamVjdERhdGEgbmUgJ0hBU0gnICkgewoKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIHZhbGlkIG1hcHBpbmcgbGlzdCBmb3VuZCBmb3IgdGVtcGxhdGUgaWQgJFBhcmFte1RlbXBsYXRlSUR9IiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuICggdW5kZWYsICdGYWlsZWQnICk7CiAgICAgICAgfQoKICAgICAgICBwdXNoKCBATWFwcGluZ09iamVjdExpc3QsICRNYXBwaW5nT2JqZWN0RGF0YSApOwoKICAgICAgICAkSW1wb3J0RGF0YXsgJE1hcHBpbmdPYmplY3REYXRhLT57S2V5fSB9ID0KICAgICAgICAgICAgJFBhcmFte0ltcG9ydERhdGFSb3d9LT5bJENvdW50ZXJdOwoKICAgICAgICAkQ291bnRlcisrOwoKICAgIH0KCiAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICNETyBUSEUgSU1QT1JULi4uCgogICAgIygxKSBzZWFyY2ggc2VydmljZS4uLgogICAgaWYgKCAkSW1wb3J0RGF0YXtTZXJ2aWNlTmFtZX0gKSB7CiAgICAgICAgbXkgJEN1cnJlbnRTSUQgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U2VydmljZScpLT5TZXJ2aWNlTG9va3VwKAogICAgICAgICAgICBOYW1lID0+ICRJbXBvcnREYXRhe1NlcnZpY2VOYW1lfSwKICAgICAgICApIHx8IDA7CgogICAgICAgIGlmICggISRJbXBvcnREYXRhe1NlcnZpY2VJRH0gKSB7CiAgICAgICAgICAgICRJbXBvcnREYXRhe1NlcnZpY2VJRH0gPSAkQ3VycmVudFNJRDsKICAgICAgICB9CiAgICAgICAgaWYgKCAhJEN1cnJlbnRTSUQgfHwgJEltcG9ydERhdGF7U2VydmljZUlEfSAhPSAkQ3VycmVudFNJRCApIHsKCiAgICAgICAgICAgICNzZXJ2aWNlIG5hbWUgZG9lcyBub3QgZXhpc3Qgb3IgZG9lcyBub3QgZml0IHRvIFNlcnZpY2VJRCAtIGRyb3AgbGluZS4uLgogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiU2VydmljZTJDdXN0b21lclVzZXI6IHNlcnZpY2UgPCIKICAgICAgICAgICAgICAgICAgICAuICRJbXBvcnREYXRhe1NlcnZpY2VOYW1lfQogICAgICAgICAgICAgICAgICAgIC4gIj4gZG9lcyBub3QgZXhpc3Qgb3IgZG9lcyBub3QgbWF0Y2ggZ2l2ZW4gU2VydmljZUlEIDwiCiAgICAgICAgICAgICAgICAgICAgLiAoICRJbXBvcnREYXRhe1NlcnZpY2VJRH0gfHwgJycgKQogICAgICAgICAgICAgICAgICAgIC4gIj4uIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuICgwLCAnRmFpbGVkJyk7ICAgIyBpZiBnb3Qgbm8gU2VydmljZUlELCB0aGVuIGV4aXQKICAgICAgICB9CiAgICB9CgogICAgIygyKSBzZWFyY2ggY3VzdG9tZXIgdXNlci4uLgogICAgbXkgJUN1c3RvbWVyVXNlckRhdGE7CiAgICBpZiAoICRJbXBvcnREYXRhe0N1c3RvbWVyVXNlckxvZ2lufSAmJiAkSW1wb3J0RGF0YXtDdXN0b21lclVzZXJMb2dpbn0gIX4gL0RFRkFVTFQvICkgewogICAgICAgICVDdXN0b21lclVzZXJEYXRhID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkN1c3RvbWVyVXNlcicpLT5DdXN0b21lclVzZXJEYXRhR2V0KAogICAgICAgICAgICBVc2VyID0+ICRJbXBvcnREYXRhe0N1c3RvbWVyVXNlckxvZ2lufQogICAgICAgICk7CiAgICAgICAgaWYgKCAhJUN1c3RvbWVyVXNlckRhdGEgKSB7CgogICAgICAgICAgICAjY3VzdG9tZXIgdXNlciBsb2dpbiBkb2VzIG5vdCBleGlzdCAtIGRyb3AgbGluZS4uLgogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiU2VydmljZTJDdXN0b21lclVzZXI6IGN1c3RvbWVyIGxvZ2luIDwiCiAgICAgICAgICAgICAgICAgICAgLiAiJEltcG9ydERhdGF7Q3VzdG9tZXJVc2VyTG9naW59PiBkb2VzIG5vdCBleGlzdC4iLAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm4gKDAsICdGYWlsZWQnKTsgICAjIGlmIGdvdCBubyBDdXN0b21lclVzZXJMb2dpbiwgdGhlbiBleGl0CiAgICAgICAgfQogICAgfQoKICAgICMoMykgbm9ybWFsaXplIEFzc2lnbm1lbnRBY3RpdmUgdmFsdWUuLi4KICAgIGlmICggJEltcG9ydERhdGF7QXNzaWdubWVudEFjdGl2ZX0gJiYgJEltcG9ydERhdGF7QXNzaWdubWVudEFjdGl2ZX0gPX4gL2ludmFsaWQvICkgewogICAgICAgICRJbXBvcnREYXRhe0Fzc2lnbm1lbnRBY3RpdmV9ID0gMDsKICAgIH0KICAgIGVsc2UgewogICAgICAgICRJbXBvcnREYXRhe0Fzc2lnbm1lbnRBY3RpdmV9ID0gMTsKICAgIH0KCiAgICAjKDQpIGRpcy9lbmFibGUgY3VzdG9tZXIgdXNlciAtIHNlcnZpY2UgbWFwcGluZy4uLgogICAgbXkgJFJlc3VsdCAgICAgPSAwOwogICAgbXkgJFJldHVybkNvZGUgPSAiIjsgICAgIyBDcmVhdGVkIHwgQ2hhbmdlZCB8IEZhaWxlZAoKICAgIGlmICggJEltcG9ydERhdGF7Q3VzdG9tZXJVc2VyTG9naW59ICF+IC9ERUZBVUxULyApIHsKICAgICAgICBpZiAoJUN1c3RvbWVyVXNlckRhdGEpIHsKICAgICAgICAgICAgJFJlc3VsdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTZXJ2aWNlJyktPkN1c3RvbWVyVXNlclNlcnZpY2VNZW1iZXJBZGQoCiAgICAgICAgICAgICAgICBDdXN0b21lclVzZXJMb2dpbiA9PiAkSW1wb3J0RGF0YXtDdXN0b21lclVzZXJMb2dpbn0sCiAgICAgICAgICAgICAgICBTZXJ2aWNlSUQgICAgICAgICA9PiAkSW1wb3J0RGF0YXtTZXJ2aWNlSUR9LAogICAgICAgICAgICAgICAgQWN0aXZlICAgICAgICAgICAgPT4gJEltcG9ydERhdGF7QXNzaWdubWVudEFjdGl2ZX0gfHwgMCwKICAgICAgICAgICAgICAgIFVzZXJJRCAgICAgICAgICAgID0+ICRQYXJhbXtVc2VySUR9LAogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAoICEkUmVzdWx0ICYmICRJbXBvcnREYXRhe0Fzc2lnbm1lbnRBY3RpdmV9KSB7CiAgICAgICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdJbXBvcnREYXRhU2F2ZTogYWRkaW5nIFNlcnZpY2UyQ3VzdG9tZXJVc2VyIDwnCiAgICAgICAgICAgICAgICAgICAgICAgIC4gJEltcG9ydERhdGF7Q3VzdG9tZXJVc2VyTG9naW59CiAgICAgICAgICAgICAgICAgICAgICAgIC4gIj4gZmFpbGVkIChsaW5lICRQYXJhbXtDb3VudGVyfSkuIiwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkUmV0dXJuQ29kZSA9ICJDcmVhdGVkIjsKICAgICAgICAgICAgICAgICRSZXN1bHQgPSAxOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgZWxzZSB7CiAgICAgICAgJFJlc3VsdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTZXJ2aWNlJyktPkN1c3RvbWVyVXNlclNlcnZpY2VNZW1iZXJBZGQoCiAgICAgICAgICAgIEN1c3RvbWVyVXNlckxvZ2luID0+ICc8REVGQVVMVD4nLAogICAgICAgICAgICBTZXJ2aWNlSUQgICAgICAgICA9PiAkSW1wb3J0RGF0YXtTZXJ2aWNlSUR9LAogICAgICAgICAgICBBY3RpdmUgICAgICAgICAgICA9PiAkSW1wb3J0RGF0YXtBc3NpZ25tZW50QWN0aXZlfSB8fCAwLAogICAgICAgICAgICBVc2VySUQgICAgICAgICAgICA9PiAkUGFyYW17VXNlcklEfSwKICAgICAgICApOwogICAgICAgIGlmICggISRSZXN1bHQgJiYgJEltcG9ydERhdGF7QXNzaWdubWVudEFjdGl2ZX0gKSB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdJbXBvcnREYXRhU2F2ZTogYWRkaW5nIDxERUZBVUxUPiBTZXJ2aWNlMkN1c3RvbWVyVXNlciA8JwogICAgICAgICAgICAgICAgICAgIC4gIj4gZmFpbGVkIChsaW5lICRQYXJhbXtDb3VudGVyfSkuIiwKICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRSZXR1cm5Db2RlID0gIkNyZWF0ZWQiOwogICAgICAgICAgICAkUmVzdWx0ID0gMTsKICAgICAgICB9CiAgICB9CgogICAgIwogICAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgcmV0dXJuICggJFJlc3VsdCwgJFJldHVybkNvZGUgKTsKfQoKMTs=</File>
        <File Location="Kernel/System/ImportExport/ObjectBackend/SLA.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbC9TeXN0ZW0vSW1wb3J0RXhwb3J0L09iamVjdEJhY2tlbmQvU0xBLnBtIAojIC0gaW1wb3J0L2V4cG9ydCBiYWNrZW5kIGZvciBTTEEgZGVmaW5pdGlvbnMKIyBDb3B5cmlnaHQgKEMpIDIwMDYtMjAxNSBjLmEucC5lLiBJVCBHbWJILCBodHRwOi8vd3d3LmNhcGUtaXQuZGUKIwojIHdyaXR0ZW4vZWRpdGVkIGJ5OgojICogQW5uYShkb3QpTGl0dmlub3ZhKGF0KWNhcGUoZGFzaClpdChkb3QpZGUKIyAqIFRob21hcyhkb3QpTGFuZ2UoYXQpY2FwZShkYXNoKWl0KGRvdClkZQojIC0tCiMgJElkOiBTTEEucG0sdiAxLjE2IDIwMTUvMTEvMTcgMDU6NDQ6MTggdGxhbmdlIEV4cCAkCiMgLS0KIyBUaGlzIHNvZnR3YXJlIGNvbWVzIHdpdGggQUJTT0xVVEVMWSBOTyBXQVJSQU5UWS4gRm9yIGRldGFpbHMsIHNlZSAKIyB0aGUgZW5jbG9zZWQgZmlsZSBDT1BZSU5HIGZvciBsaWNlbnNlIGluZm9ybWF0aW9uIChBR1BMKS4gSWYgeW91IAojIGRpZCBub3QgcmVjZWl2ZSB0aGlzIGZpbGUsIHNlZSBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvYWdwbC50eHQuIAojIC0tCgpwYWNrYWdlIEtlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQ6Ok9iamVjdEJhY2tlbmQ6OlNMQTsKCnVzZSBzdHJpY3Q7CnVzZSB3YXJuaW5nczsKCm91ciBAT2JqZWN0RGVwZW5kZW5jaWVzID0gKAogICAgJ0tlcm5lbDo6U3lzdGVtOjpTZXJ2aWNlJywKICAgICdLZXJuZWw6OlN5c3RlbTo6U0xBJywKICAgICdLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0JywKICAgICdLZXJuZWw6OlN5c3RlbTo6VmFsaWQnLAogICAgJ0tlcm5lbDo6U3lzdGVtOjpRdWV1ZScsCiAgICAnS2VybmVsOjpTeXN0ZW06OlR5cGUnLAogICAgJ0tlcm5lbDo6U3lzdGVtOjpNYWluJywKICAgICdLZXJuZWw6OlN5c3RlbTo6TG9nJywgIAogICAgJ0tlcm5lbDo6Q29uZmlnJywgICAgICAgIAopOwoKPWhlYWQxIE5BTUUKCktlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQ6Ok9iamVjdEJhY2tlbmQ6OkN1c3RvbWVyVXNlciAtIGltcG9ydC9leHBvcnQgYmFja2VuZCBmb3IgQ3VzdG9tZXJVc2VyCgo9aGVhZDEgU1lOT1BTSVMKCkFsbCBmdW5jdGlvbnMgdG8gaW1wb3J0IGFuZCBleHBvcnQgQ3VzdG9tZXJVc2VyIGVudHJpZXMKCj1vdmVyIDQKCj1jdXQKCj1pdGVtIG5ldygpCgpjcmVhdGUgYW4gb2JqZWN0CgogICAgdXNlIEtlcm5lbDo6Q29uZmlnOwogICAgdXNlIEtlcm5lbDo6U3lzdGVtOjpEQjsKICAgIHVzZSBLZXJuZWw6OlN5c3RlbTo6TG9nOwogICAgdXNlIEtlcm5lbDo6U3lzdGVtOjpNYWluOwogICAgdXNlIEtlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQ6Ok9iamVjdEJhY2tlbmQ6OkN1c3RvbWVyVXNlcjsKCiAgICBteSAkQ29uZmlnT2JqZWN0ID0gS2VybmVsOjpDb25maWctPm5ldygpOwogICAgbXkgJExvZ09iamVjdCA9IEtlcm5lbDo6U3lzdGVtOjpMb2ctPm5ldygKICAgICAgICBDb25maWdPYmplY3QgPT4gJENvbmZpZ09iamVjdCwKICAgICk7CiAgICBteSAkTWFpbk9iamVjdCA9IEtlcm5lbDo6U3lzdGVtOjpNYWluLT5uZXcoCiAgICAgICAgQ29uZmlnT2JqZWN0ID0+ICRDb25maWdPYmplY3QsCiAgICAgICAgTG9nT2JqZWN0ICAgID0+ICRMb2dPYmplY3QsCiAgICApOwogICAgbXkgJERCT2JqZWN0ID0gS2VybmVsOjpTeXN0ZW06OkRCLT5uZXcoCiAgICAgICAgQ29uZmlnT2JqZWN0ID0+ICRDb25maWdPYmplY3QsCiAgICAgICAgTG9nT2JqZWN0ICAgID0+ICRMb2dPYmplY3QsCiAgICAgICAgTWFpbk9iamVjdCAgID0+ICRNYWluT2JqZWN0LAogICAgKTsKICAgIG15ICRCYWNrZW5kT2JqZWN0ID0gS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydDo6T2JqZWN0QmFja2VuZDo6Q3VzdG9tZXJVc2VyLT5uZXcoCiAgICAgICAgQ29uZmlnT2JqZWN0ICAgICAgID0+ICRDb25maWdPYmplY3QsCiAgICAgICAgTG9nT2JqZWN0ICAgICAgICAgID0+ICRMb2dPYmplY3QsCiAgICAgICAgREJPYmplY3QgICAgICAgICAgID0+ICREQk9iamVjdCwKICAgICAgICBNYWluT2JqZWN0ICAgICAgICAgPT4gJE1haW5PYmplY3QsCiAgICAgICAgSW1wb3J0RXhwb3J0T2JqZWN0ID0+ICRJbXBvcnRFeHBvcnRPYmplY3QsCiAgICApOwoKPWN1dAoKc3ViIG5ldyB7CiAgICBteSAoICRUeXBlLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgYWxsb2NhdGUgbmV3IGhhc2ggZm9yIG9iamVjdAogICAgbXkgJFNlbGYgPSB7fTsKICAgIGJsZXNzKCAkU2VsZiwgJFR5cGUgKTsKCiAgICBteSAkQ2FsZW5kYXJJbmRleCAgICA9IDE7CiAgICBteSAlQ2FsZW5kYXJOYW1lTGlzdCA9IHF3e307CiAgICB3aGlsZSAoICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyktPkdldCggIlRpbWVab25lOjpDYWxlbmRhciIgLiAkQ2FsZW5kYXJJbmRleCAuICJOYW1lIiApICkgewogICAgICAgICRDYWxlbmRhck5hbWVMaXN0eyRDYWxlbmRhckluZGV4fSA9CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyktPkdldCggIlRpbWVab25lOjpDYWxlbmRhciIgLiAkQ2FsZW5kYXJJbmRleCAuICJOYW1lIiApOwogICAgICAgICRDYWxlbmRhckluZGV4Kys7CiAgICB9CiAgICBteSAlVG1wSGFzaCA9IHJldmVyc2UoJUNhbGVuZGFyTmFtZUxpc3QpOwogICAgJFNlbGYtPntDYWxlbmRhck5hbWVMaXN0fSAgICAgICAgPSBcJUNhbGVuZGFyTmFtZUxpc3Q7CiAgICAkU2VsZi0+e1JldmVyc2VDYWxlbmRhck5hbWVMaXN0fSA9IFwlVG1wSGFzaDsKCiAgICBpZiAoICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpNYWluJyktPlJlcXVpcmUoJ0tlcm5lbDo6U3lzdGVtOjpHZW5lcmFsQ2F0YWxvZycpICkgewogICAgICAgICRTZWxmLT57R2VuZXJhbENhdGFsb2dPYmplY3R9ID0gS2VybmVsOjpTeXN0ZW06OkdlbmVyYWxDYXRhbG9nLT5uZXcoICV7JFNlbGZ9ICk7CiAgICAgICAgaWYgKCAkU2VsZi0+e0dlbmVyYWxDYXRhbG9nT2JqZWN0fSApIHsKCiAgICAgICAgICAgICMgZ2V0IFNMQSB0eXBlIGxpc3QKICAgICAgICAgICAgJFNlbGYtPntTTEFUeXBlTGlzdH0gPSAkU2VsZi0+e0dlbmVyYWxDYXRhbG9nT2JqZWN0fS0+SXRlbUxpc3QoCiAgICAgICAgICAgICAgICBDbGFzcyA9PiAnSVRTTTo6U0xBOjpUeXBlJywKICAgICAgICAgICAgKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmICggJFNlbGYtPntTTEFUeXBlTGlzdH0gJiYgKCByZWYoICRTZWxmLT57U0xBVHlwZUxpc3R9ICkgZXEgJ0hBU0gnICkgKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBteSAlVG1wSGFzaCA9IHJldmVyc2UoICV7ICRTZWxmLT57U0xBVHlwZUxpc3R9IH0gKTsKICAgICAgICAgICAgICAgICRTZWxmLT57UmV2ZXJzZVNMQVR5cGVMaXN0fSA9IFwlVG1wSGFzaDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gJFNlbGY7Cn0KCj1pdGVtIE9iamVjdEF0dHJpYnV0ZXNHZXQoKQoKZ2V0IHRoZSBvYmplY3QgYXR0cmlidXRlcyBvZiBhbiBvYmplY3QgYXMgYXJyYXkvaGFzaCByZWZlcmVuY2UKCiAgICBteSAkQXR0cmlidXRlcyA9ICRPYmplY3RCYWNrZW5kLT5PYmplY3RBdHRyaWJ1dGVzR2V0KAogICAgICAgIFVzZXJJRCA9PiAxLAogICAgKTsKCj1jdXQKCnN1YiBPYmplY3RBdHRyaWJ1dGVzR2V0IHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgIyBjaGVjayBuZWVkZWQgb2JqZWN0CiAgICBpZiAoICEkUGFyYW17VXNlcklEfSApIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJykKICAgICAgICAgICAgLT5Mb2coIFByaW9yaXR5ID0+ICdlcnJvcicsIE1lc3NhZ2UgPT4gJ05lZWQgVXNlcklEIScgKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBteSAlVmFsaWRsaXN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlZhbGlkJyktPlZhbGlkTGlzdCgpOwoKICAgIG15ICRBdHRyaWJ1dGVzID0gWwogICAgICAgIHsKICAgICAgICAgICAgS2V5ICAgPT4gJ0RlZmF1bHRWYWxpZCcsCiAgICAgICAgICAgIE5hbWUgID0+ICdEZWZhdWx0IFZhbGlkaXR5JywKICAgICAgICAgICAgSW5wdXQgPT4gewogICAgICAgICAgICAgICAgVHlwZSAgICAgICAgID0+ICdTZWxlY3Rpb24nLAogICAgICAgICAgICAgICAgRGF0YSAgICAgICAgID0+IFwlVmFsaWRsaXN0LAogICAgICAgICAgICAgICAgUmVxdWlyZWQgICAgID0+IDEsCiAgICAgICAgICAgICAgICBUcmFuc2xhdGlvbiAgPT4gMSwKICAgICAgICAgICAgICAgIFBvc3NpYmxlTm9uZSA9PiAwLAogICAgICAgICAgICAgICAgVmFsdWVEZWZhdWx0ID0+IDEsCiAgICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdOdW1iZXJPZkFzc2lnbmFibGVTZXJ2aWNlcycsCiAgICAgICAgICAgIE5hbWUgID0+ICdNYXguIG51bWJlciBvZiBhc3NpZ25lZCBzZXJ2aWNlcyBjb2x1bW5zJywKICAgICAgICAgICAgSW5wdXQgPT4gewogICAgICAgICAgICAgICAgVHlwZSAgICAgICAgID0+ICdUZXh0JywKICAgICAgICAgICAgICAgIFJlcXVpcmVkICAgICA9PiAxLAogICAgICAgICAgICAgICAgU2l6ZSAgICAgICAgID0+IDMsCiAgICAgICAgICAgICAgICBNYXhMZW5ndGggICAgPT4gMywKICAgICAgICAgICAgICAgIFZhbHVlRGVmYXVsdCA9PiAnNTAnLAogICAgICAgICAgICB9LAogICAgICAgIH0sCgogICAgXTsKCiAgICAjdXNlIHRoZSBhdmFpbGFiaWxpdHkgb2YgU0xBVHlwZUxpc3QgdG8gZGlzcGxheSBJVFNNLXJlbGV2YW50IGNvbmZpZy4uLgogICAgaWYgKCAkU2VsZi0+e1NMQVR5cGVMaXN0fSApIHsKICAgICAgICBteSAkU0xBVHlwZURlZmF1bHQgPSB7CiAgICAgICAgICAgIEtleSAgID0+ICdEZWZhdWx0U0xBVHlwZUlEJywKICAgICAgICAgICAgTmFtZSAgPT4gJ0RlZmF1bHQgU0xBIFR5cGUnLAogICAgICAgICAgICBJbnB1dCA9PiB7CiAgICAgICAgICAgICAgICBUeXBlICAgICAgICAgPT4gJ1NlbGVjdGlvbicsCiAgICAgICAgICAgICAgICBEYXRhICAgICAgICAgPT4gJFNlbGYtPntTTEFUeXBlTGlzdH0sCiAgICAgICAgICAgICAgICBSZXF1aXJlZCAgICAgPT4gMSwKICAgICAgICAgICAgICAgIFRyYW5zbGF0aW9uICA9PiAxLAogICAgICAgICAgICAgICAgUG9zc2libGVOb25lID0+IDAsCiAgICAgICAgICAgIH0sCiAgICAgICAgfTsKICAgICAgICBwdXNoKCBAeyRBdHRyaWJ1dGVzfSwgJFNMQVR5cGVEZWZhdWx0ICk7CgogICAgICAgIG15ICRNaW5UaW1lQmV0d2VlbkluY2lkZW50c0RlZmF1bHQgPSB7CiAgICAgICAgICAgIEtleSAgID0+ICdEZWZhdWx0TWluVGltZUJldHdlZW5JbmNpZGVudHMnLAogICAgICAgICAgICBOYW1lICA9PiAnRGVmYXVsdCBNaW5pbXVtIFRpbWUgQmV0d2VlbiBJbmNpZGVudHMnLAogICAgICAgICAgICBJbnB1dCA9PiB7CiAgICAgICAgICAgICAgICBUeXBlICAgICAgPT4gJ1RleHQnLAogICAgICAgICAgICAgICAgUmVxdWlyZWQgID0+IDAsCiAgICAgICAgICAgICAgICBTaXplICAgICAgPT4gMTAsCiAgICAgICAgICAgICAgICBNYXhMZW5ndGggPT4gMTAsCiAgICAgICAgICAgIH0sCiAgICAgICAgfTsKICAgICAgICBwdXNoKCBAeyRBdHRyaWJ1dGVzfSwgJE1pblRpbWVCZXR3ZWVuSW5jaWRlbnRzRGVmYXVsdCApOwoKICAgIH0KCiAgICByZXR1cm4gJEF0dHJpYnV0ZXM7Cn0KCj1pdGVtIE1hcHBpbmdPYmplY3RBdHRyaWJ1dGVzR2V0KCkKCmdldCB0aGUgbWFwcGluZyBhdHRyaWJ1dGVzIG9mIGFuIG9iamVjdCBhcyBhcnJheS9oYXNoIHJlZmVyZW5jZQoKICAgIG15ICRBdHRyaWJ1dGVzID0gJE9iamVjdEJhY2tlbmQtPk1hcHBpbmdPYmplY3RBdHRyaWJ1dGVzR2V0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gMTIzLAogICAgICAgIFVzZXJJRCAgICAgPT4gMSwKICAgICk7Cgo9Y3V0CgpzdWIgTWFwcGluZ09iamVjdEF0dHJpYnV0ZXNHZXQgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICAjIGNoZWNrIG5lZWRlZCBzdHVmZgogICAgZm9yIG15ICRBcmd1bWVudCAocXcoVGVtcGxhdGVJRCBVc2VySUQpKSB7CiAgICAgICAgaWYgKCAhJFBhcmFteyRBcmd1bWVudH0gKSB7CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJOZWVkICRBcmd1bWVudCEiLAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgfQoKICAgICMgZ2V0IG9iamVjdCBkYXRhCiAgICBteSAkT2JqZWN0RGF0YSA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQnKS0+T2JqZWN0RGF0YUdldCgKICAgICAgICBUZW1wbGF0ZUlEID0+ICRQYXJhbXtUZW1wbGF0ZUlEfSwKICAgICAgICBVc2VySUQgICAgID0+ICRQYXJhbXtVc2VySUR9LAogICAgKTsKCiAgICBteSAkRWxlbWVudExpc3QgPSBbCiAgICAgICAgewogICAgICAgICAgICBLZXkgICA9PiAnU0xBSUQnLAogICAgICAgICAgICBWYWx1ZSA9PiAnU0xBIElEJywKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgS2V5ICAgPT4gJ05hbWUnLAogICAgICAgICAgICBWYWx1ZSA9PiAnU0xBIE5hbWUnLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBLZXkgICA9PiAnQ2FsZW5kYXInLAogICAgICAgICAgICBWYWx1ZSA9PiAnQ2FsZW5kYXIgTmFtZScsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdWYWxpZCcsCiAgICAgICAgICAgIFZhbHVlID0+ICdWYWxpZGl0eScsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdDb21tZW50JywKICAgICAgICAgICAgVmFsdWUgPT4gJ0NvbW1lbnQnLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBLZXkgICA9PiAnRmlyc3RSZXNwb25zZVRpbWUnLAogICAgICAgICAgICBWYWx1ZSA9PiAnRmlyc3RSZXNwb25zZVRpbWUgKGJ1c2luZXNzIG1pbnV0ZXMpJywKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgS2V5ICAgPT4gJ0ZpcnN0UmVzcG9uc2VOb3RpZnknLAogICAgICAgICAgICBWYWx1ZSA9PiAnRmlyc3RSZXNwb25zZU5vdGlmeSAocGVyY2VudCknLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBLZXkgICA9PiAnVXBkYXRlVGltZScsCiAgICAgICAgICAgIFZhbHVlID0+ICdVcGRhdGVUaW1lIChidXNpbmVzcyBtaW51dGVzKScsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdVcGRhdGVOb3RpZnknLAogICAgICAgICAgICBWYWx1ZSA9PiAnVXBkYXRlTm90aWZ5IChwZXJjZW50KScsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdTb2x1dGlvblRpbWUnLAogICAgICAgICAgICBWYWx1ZSA9PiAnU29sdXRpb25UaW1lIChidXNpbmVzcyBtaW51dGVzKScsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdTb2x1dGlvbk5vdGlmeScsCiAgICAgICAgICAgIFZhbHVlID0+ICdTb2x1dGlvbk5vdGlmeSAocGVyY2VudCknLAogICAgICAgIH0KICAgIF07CgogICAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgIyBnZXQgcHJlZmVyZW5jZXMuLi4KICAgIG15ICVQcmVmZXJlbmNlcyA9ICgpOwogICAgaWYgKCAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpLT5HZXQoJ1NMQVByZWZlcmVuY2VzJykgKSB7CiAgICAgICAgJVByZWZlcmVuY2VzID0gJXsgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpDb25maWcnKS0+R2V0KCdTTEFQcmVmZXJlbmNlcycpIH07CiAgICB9CiAgICBmb3IgbXkgJEl0ZW0gKCBzb3J0IGtleXMgJVByZWZlcmVuY2VzICkgewogICAgICAgIGlmICgKICAgICAgICAgICAgJFByZWZlcmVuY2VzeyRJdGVtfS0+e1NlbGVjdGlvblNvdXJjZX0KICAgICAgICAgICAgJiYgJFByZWZlcmVuY2VzeyRJdGVtfS0+e1ByZWZLZXl9ID1+IC9eKC4rKUlEJC8KICAgICAgICAgICAgKQogICAgICAgIHsKICAgICAgICAgICAgbXkgJE5hbWVQYXJ0ID0gJDE7CiAgICAgICAgICAgIHB1c2goCiAgICAgICAgICAgICAgICBAeyRFbGVtZW50TGlzdH0sCiAgICAgICAgICAgICAgICB7IEtleSA9PiAkTmFtZVBhcnQsIFZhbHVlID0+ICRQcmVmZXJlbmNlc3skSXRlbX0tPntMYWJlbH0gfQogICAgICAgICAgICApOwogICAgICAgIH0KCiAgICAgICAgaWYgKCAkUHJlZmVyZW5jZXN7JEl0ZW19LT57UHJlZktleX0gPX4gL14oLispSUQkLyApIHsKICAgICAgICAgICAgbXkgJE5hbWVQYXJ0ID0gJDE7CiAgICAgICAgICAgIHB1c2goCiAgICAgICAgICAgICAgICBAeyRFbGVtZW50TGlzdH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgS2V5ICAgPT4gJFByZWZlcmVuY2VzeyRJdGVtfS0+e1ByZWZLZXl9LAogICAgICAgICAgICAgICAgICAgIFZhbHVlID0+ICRQcmVmZXJlbmNlc3skSXRlbX0tPntMYWJlbH0gLiAiIChJRCkiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBwdXNoKAogICAgICAgICAgICAgICAgQHskRWxlbWVudExpc3R9LAogICAgICAgICAgICAgICAgeyBLZXkgPT4gJFByZWZlcmVuY2VzeyRJdGVtfS0+e1ByZWZLZXl9LCBWYWx1ZSA9PiAkUHJlZmVyZW5jZXN7JEl0ZW19LT57TGFiZWx9IH0KICAgICAgICAgICAgKTsKICAgICAgICB9CgogICAgfQoKICAgICMgdXNpbmcgU0xBVHlwZUxpc3QgYXMgaW5kaWNhdG9yIGZvciBJVFNNLWluc3RhbGxhdGlvbi4uLgogICAgaWYgKCAkU2VsZi0+e1NMQVR5cGVMaXN0fSApIHsKICAgICAgICBteSAkRWxlbWVudExpc3RJVFNNID0gWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBLZXkgICA9PiAnVHlwZScsCiAgICAgICAgICAgICAgICBWYWx1ZSA9PiAnU0xBIFR5cGUgKElUU00gb25seSknLAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBLZXkgICA9PiAnTWluVGltZUJldHdlZW5JbmNpZGVudHMnLAogICAgICAgICAgICAgICAgVmFsdWUgPT4gJ01pbi4gVGltZSBCZXR3ZWVuIEluY2lkZW50cyAoSVRTTSBvbmx5KScsCiAgICAgICAgICAgIH0sCiAgICAgICAgXTsKICAgICAgICBteSBAVG1wQXJyYXkgPSAoIEB7JEVsZW1lbnRMaXN0fSwgQHskRWxlbWVudExpc3RJVFNNfSApOwogICAgICAgICRFbGVtZW50TGlzdCA9IFxAVG1wQXJyYXk7CiAgICB9CgogICAgIyBjb2x1bW5zIGZvciBhc3NpZ25lZCBzZXJ2aWNlcy4uLgogICAgbXkgJE51bWJlck9mQXNzaWduYWJsZVNlcnZpY2VzID0gJE9iamVjdERhdGEtPntOdW1iZXJPZkFzc2lnbmFibGVTZXJ2aWNlc30gfHwgMDsKICAgIG15ICRDdXJySW5kZXggPSAwOwogICAgd2hpbGUgKCAkQ3VyckluZGV4IDwgJE51bWJlck9mQXNzaWduYWJsZVNlcnZpY2VzICkgewoKICAgICAgICBwdXNoKAogICAgICAgICAgICBAeyRFbGVtZW50TGlzdH0sCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIEtleSAgID0+ICdBc3NpZ25lZFNlcnZpY2UnIC4gc3ByaW50ZiggIiUwM2QiLCAkQ3VyckluZGV4ICksCiAgICAgICAgICAgICAgICBWYWx1ZSA9PiAnQXNzaWduZWRTZXJ2aWNlJyAuIHNwcmludGYoICIlMDNkIiwgJEN1cnJJbmRleCApLAogICAgICAgICAgICB9CiAgICAgICAgKTsKCiAgICAgICAgJEN1cnJJbmRleCsrOwogICAgfQoKICAgIG15ICRBdHRyaWJ1dGVzID0gWwogICAgICAgIHsKICAgICAgICAgICAgS2V5ICAgPT4gJ0tleScsCiAgICAgICAgICAgIE5hbWUgID0+ICdLZXknLAogICAgICAgICAgICBJbnB1dCA9PiB7CiAgICAgICAgICAgICAgICBUeXBlICAgICAgICAgPT4gJ1NlbGVjdGlvbicsCiAgICAgICAgICAgICAgICBEYXRhICAgICAgICAgPT4gJEVsZW1lbnRMaXN0LAogICAgICAgICAgICAgICAgUmVxdWlyZWQgICAgID0+IDEsCiAgICAgICAgICAgICAgICBUcmFuc2xhdGlvbiAgPT4gMSwKICAgICAgICAgICAgICAgIFBvc3NpYmxlTm9uZSA9PiAxLAogICAgICAgICAgICB9LAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBLZXkgICA9PiAnSWRlbnRpZmllcicsCiAgICAgICAgICAgIE5hbWUgID0+ICdJZGVudGlmaWVyJywKICAgICAgICAgICAgSW5wdXQgPT4geyBUeXBlID0+ICdDaGVja2JveCcsIH0sCiAgICAgICAgfSwKICAgIF07CgogICAgcmV0dXJuICRBdHRyaWJ1dGVzOwp9Cgo9aXRlbSBTZWFyY2hBdHRyaWJ1dGVzR2V0KCkKCmdldCB0aGUgc2VhcmNoIG9iamVjdCBhdHRyaWJ1dGVzIG9mIGFuIG9iamVjdCBhcyBhcnJheS9oYXNoIHJlZmVyZW5jZQoKICAgIG15ICRBdHRyaWJ1dGVMaXN0ID0gJE9iamVjdEJhY2tlbmQtPlNlYXJjaEF0dHJpYnV0ZXNHZXQoCiAgICAgICAgVGVtcGxhdGVJRCA9PiAxMjMsCiAgICAgICAgVXNlcklEICAgICA9PiAxLAogICAgKTsKCj1jdXQKCnN1YiBTZWFyY2hBdHRyaWJ1dGVzR2V0IHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgIyBjaGVjayBuZWVkZWQgc3R1ZmYKICAgIGZvciBteSAkQXJndW1lbnQgKHF3KFRlbXBsYXRlSUQgVXNlcklEKSkgewogICAgICAgIGlmICggISRQYXJhbXskQXJndW1lbnR9ICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiTmVlZCAkQXJndW1lbnQhIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KCiAgICBteSAkQXR0cmlidXRlTGlzdCA9IFsKICAgICAgICB7CiAgICAgICAgICAgIEtleSAgID0+ICdOYW1lJywKICAgICAgICAgICAgTmFtZSAgPT4gJ1NMQSBOYW1lJywKICAgICAgICAgICAgSW5wdXQgPT4gewogICAgICAgICAgICAgICAgVHlwZSAgICAgID0+ICdUZXh0JywKICAgICAgICAgICAgICAgIFNpemUgICAgICA9PiA4MCwKICAgICAgICAgICAgICAgIE1heExlbmd0aCA9PiAyNTUsCiAgICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgIF07CgogICAgcmV0dXJuICRBdHRyaWJ1dGVMaXN0Owp9Cgo9aXRlbSBFeHBvcnREYXRhR2V0KCkKCmdldCBleHBvcnQgZGF0YSBhcyAyRC1hcnJheS1oYXNoIHJlZmVyZW5jZQoKICAgIG15ICRFeHBvcnREYXRhID0gJE9iamVjdEJhY2tlbmQtPkV4cG9ydERhdGFHZXQoCiAgICAgICAgVGVtcGxhdGVJRCA9PiAxMjMsCiAgICAgICAgVXNlcklEICAgICA9PiAxLAogICAgKTsKCj1jdXQKCnN1YiBFeHBvcnREYXRhR2V0IHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgIyBjaGVjayBuZWVkZWQgc3R1ZmYKICAgIGZvciBteSAkQXJndW1lbnQgKHF3KFRlbXBsYXRlSUQgVXNlcklEKSkgewogICAgICAgIGlmICggISRQYXJhbXskQXJndW1lbnR9ICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiTmVlZCAkQXJndW1lbnQhIiwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KCiAgICAjIGdldCBvYmplY3QgZGF0YQogICAgbXkgJE9iamVjdERhdGEgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0JyktPk9iamVjdERhdGFHZXQoCiAgICAgICAgVGVtcGxhdGVJRCA9PiAkUGFyYW17VGVtcGxhdGVJRH0sCiAgICAgICAgVXNlcklEICAgICA9PiAkUGFyYW17VXNlcklEfSwKICAgICk7CgogICAgIyBjaGVjayBvYmplY3QgZGF0YQogICAgaWYgKCAhJE9iamVjdERhdGEgfHwgcmVmICRPYmplY3REYXRhIG5lICdIQVNIJyApIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIG9iamVjdCBkYXRhIGZvdW5kIGZvciB0aGUgdGVtcGxhdGUgaWQgJFBhcmFte1RlbXBsYXRlSUR9IiwKICAgICAgICApOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICAjIGdldCB0aGUgbWFwcGluZyBsaXN0CiAgICBteSAkTWFwcGluZ0xpc3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0JyktPk1hcHBpbmdMaXN0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gJFBhcmFte1RlbXBsYXRlSUR9LAogICAgICAgIFVzZXJJRCAgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICApOwoKICAgICMgY2hlY2sgdGhlIG1hcHBpbmcgbGlzdAogICAgaWYgKCAhJE1hcHBpbmdMaXN0IHx8IHJlZiAkTWFwcGluZ0xpc3QgbmUgJ0FSUkFZJyB8fCAhQHskTWFwcGluZ0xpc3R9ICkgewoKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIHZhbGlkIG1hcHBpbmcgbGlzdCBmb3VuZCBmb3IgdGhlIHRlbXBsYXRlIGlkICRQYXJhbXtUZW1wbGF0ZUlEfSIsCiAgICAgICAgKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgIyBnZXQgc2VhcmNoIGRhdGEKICAgIG15ICRTZWFyY2hEYXRhID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5TZWFyY2hEYXRhR2V0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gJFBhcmFte1RlbXBsYXRlSUR9LAogICAgICAgIFVzZXJJRCAgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICApOwoKICAgIGlmICggJFNlYXJjaERhdGEgJiYgcmVmKCRTZWFyY2hEYXRhKSBuZSAnSEFTSCcgKSB7CiAgICAgICAgJFNlYXJjaERhdGEgPSAwOwogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICBNZXNzYWdlID0+CiAgICAgICAgICAgICAgICAiU0xBOiBzZWFyY2ggZGF0YSBpcyBub3QgYSBoYXNoIHJlZiAtIGlnbm9yaW5nIHNlYXJjaCBsaW1pdGF0aW9uLiIsCiAgICAgICAgKTsKICAgIH0KCiAgICBpZiAoICRTZWFyY2hEYXRhICYmICRTZWFyY2hEYXRhLT57TmFtZX0gJiYgJFNlYXJjaERhdGEtPntOYW1lfSA9fiAvXCovICkgewogICAgICAgICRTZWFyY2hEYXRhLT57TmFtZX0gPX4gcy9cKi8uKi9nOwogICAgfQoKICAgICMgY3JlYXRlIHRoZSBtYXBwaW5nIG9iamVjdCBsaXN0CiAgICBteSBATWFwcGluZ09iamVjdExpc3Q7CiAgICBmb3IgbXkgJE1hcHBpbmdJRCAoIEB7JE1hcHBpbmdMaXN0fSApIHsKCiAgICAgICAgIyBnZXQgbWFwcGluZyBvYmplY3QgZGF0YQogICAgICAgIG15ICRNYXBwaW5nT2JqZWN0RGF0YSA9CiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQnKS0+TWFwcGluZ09iamVjdERhdGFHZXQoCiAgICAgICAgICAgIE1hcHBpbmdJRCA9PiAkTWFwcGluZ0lELAogICAgICAgICAgICBVc2VySUQgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICAgICAgICAgICk7CgogICAgICAgICMgY2hlY2sgbWFwcGluZyBvYmplY3QgZGF0YQogICAgICAgIGlmICggISRNYXBwaW5nT2JqZWN0RGF0YSB8fCByZWYgJE1hcHBpbmdPYmplY3REYXRhIG5lICdIQVNIJyApIHsKCiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJObyB2YWxpZCBtYXBwaW5nIGxpc3QgZm91bmQgZm9yIHRoZSB0ZW1wbGF0ZSBpZCAkUGFyYW17VGVtcGxhdGVJRH0iLAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBwdXNoKCBATWFwcGluZ09iamVjdExpc3QsICRNYXBwaW5nT2JqZWN0RGF0YSApOwogICAgfQoKICAgICMgZXhwb3J0IGRhdGEuLi4KICAgIG15IEBFeHBvcnREYXRhOwoKICAgICMgZ2V0IHByZWZlcmVuY2VzIGNvbmZpZ3VyYXRpb24uLi4KICAgIG15ICVQcmVmZXJlbmNlcyA9ICgpOwogICAgaWYgKCAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpLT5HZXQoJ1NMQVByZWZlcmVuY2VzJykgKSB7CiAgICAgICAgbXkgJVByZWZDb25maWcgPSAleyAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpLT5HZXQoJ1NMQVByZWZlcmVuY2VzJykgfTsKICAgICAgICBmb3IgbXkgJEN1cnJLZXkgKCBrZXlzKCVQcmVmQ29uZmlnKSApIHsKICAgICAgICAgICAgbXkgJUN1cnJQcmVmcyA9ICgpOwogICAgICAgICAgICAkQ3VyclByZWZze0xhYmVsfSAgICAgICAgICAgICAgID0gJFByZWZDb25maWd7JEN1cnJLZXl9LT57TGFiZWx9OwogICAgICAgICAgICAkQ3VyclByZWZze1NlbGVjdGlvblNvdXJjZX0gICAgID0gJFByZWZDb25maWd7JEN1cnJLZXl9LT57U2VsZWN0aW9uU291cmNlfTsKICAgICAgICAgICAgJEN1cnJQcmVmc3tHZW5lcmFsQ2F0YWxvZ0NsYXNzfSA9ICRQcmVmQ29uZmlneyRDdXJyS2V5fS0+e0dlbmVyYWxDYXRhbG9nQ2xhc3N9OwogICAgICAgICAgICAkUHJlZmVyZW5jZXN7ICRQcmVmQ29uZmlneyRDdXJyS2V5fS0+e1ByZWZLZXl9IH0gPSBcJUN1cnJQcmVmczsKICAgICAgICB9CiAgICB9CgogICAgIyBzZWFyY2ggdGhlIFNMQXMuLi4KICAgIG15ICVTTEFMaXN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlNMQScpLT5TTEFMaXN0KAogICAgICAgIFZhbGlkICA9PiAwLAogICAgICAgIFVzZXJJRCA9PiAxLAogICAgKTsKCiAgICBmb3IgbXkgJEN1cnJTTEFJRCAoIGtleXMoJVNMQUxpc3QpICkgewoKICAgICAgICAjY2hlY2sgZm9yIG5hbWUgKFNMQSkgZXhwb3J0IGZpbHRlci4uLgogICAgICAgIGlmICggJFNlYXJjaERhdGEgJiYgJFNlYXJjaERhdGEtPntOYW1lfSApIHsKICAgICAgICAgICAgaWYgKCAkU2VhcmNoRGF0YS0+e05hbWV9ID1+IC9cKi8gKSB7CiAgICAgICAgICAgICAgICBuZXh0IGlmICggJFNMQUxpc3R7JEN1cnJTTEFJRH0gIX4gLyRTZWFyY2hEYXRhLT57TmFtZX0vICk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBuZXh0IGlmICggJFNMQUxpc3R7JEN1cnJTTEFJRH0gbmUgJFNlYXJjaERhdGEtPntOYW1lfSApOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBteSAlU0xBRGF0YSA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTTEEnKS0+U0xBR2V0KAogICAgICAgICAgICBTTEFJRCAgPT4gJEN1cnJTTEFJRCwKICAgICAgICAgICAgVXNlcklEID0+IDEsICAgICAgICAgICAgIyBubyBwZXJtaXNzaW9uIHJlc3RyaWN0aW9uIGZvciB0aGlzIGV4cG9ydAogICAgICAgICk7CgogICAgICAgICNleHBvcnQgdmFsaWQgc3RyaW5nIGluc3RlYWQgb2YgSUQuLi4KICAgICAgICAkU0xBRGF0YXtWYWxpZH0gPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6VmFsaWQnKS0+VmFsaWRMb29rdXAoCiAgICAgICAgICAgIFZhbGlkSUQgPT4gJFNMQURhdGF7VmFsaWRJRH0sCiAgICAgICAgKTsKCiAgICAgICAgUFJFRkVSRU5DRUNIRUNLOgogICAgICAgIGZvciBteSAkQ3VycktleSAoIGtleXMoJVNMQURhdGEpICkgewoKICAgICAgICAgICAgIyBjaGVjayBpZiB0aGlzIGlzIGEgcHJlZmVyZW5jZS4uLgogICAgICAgICAgICBuZXh0IFBSRUZFUkVOQ0VDSEVDSyBpZiAoICEkUHJlZmVyZW5jZXN7JEN1cnJLZXl9ICk7CgogICAgICAgICAgICAjIGNoZWNrIGlmIHRoaXMgaXMgYW4gSUQtYXR0cmlidXRlLi4uCiAgICAgICAgICAgIG5leHQgUFJFRkVSRU5DRUNIRUNLIGlmICggJEN1cnJLZXkgIX4gL14oLispSUQkLyApOwogICAgICAgICAgICBteSAkTmFtZVBhcnQgPSAkMTsKCiAgICAgICAgICAgICMgc2tpcCBpZiBhbiBhdHRyaWJ1dGUgd2l0aCBhIHNpbWlsYXIgbmFtZSBidXQgbm8gIklEIiBzdWZmaXggZXhpc3RzLi4uCiAgICAgICAgICAgIG5leHQgUFJFRkVSRU5DRUNIRUNLIGlmICggJFNMQURhdGF7JE5hbWVQYXJ0fSApOwoKICAgICAgICAgICAgIyBjaGVjayBmb3Igc291cmNlIG9mIHByZWZlcmVuY2UuLi4KICAgICAgICAgICAgbXkgJVNlbGVjdGlvbkxpc3QgPSAoKTsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgJFByZWZlcmVuY2VzeyRDdXJyS2V5fS0+e1NlbGVjdGlvblNvdXJjZX0KICAgICAgICAgICAgICAgICYmICRQcmVmZXJlbmNlc3skQ3VycktleX0tPntTZWxlY3Rpb25Tb3VyY2V9IGVxICdRdWV1ZUxpc3QnCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICVTZWxlY3Rpb25MaXN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlF1ZXVlJyktPlF1ZXVlTGlzdCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2lmICgKICAgICAgICAgICAgICAgICRQcmVmZXJlbmNlc3skQ3VycktleX0tPntTZWxlY3Rpb25Tb3VyY2V9CiAgICAgICAgICAgICAgICAmJiAkUHJlZmVyZW5jZXN7JEN1cnJLZXl9LT57U2VsZWN0aW9uU291cmNlfSBlcSAnVHlwZUxpc3QnCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICVTZWxlY3Rpb25MaXN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlR5cGUnKS0+VHlwZUxpc3QoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNpZiAoCiAgICAgICAgICAgICAgICAoICRQcmVmZXJlbmNlc3skQ3VycktleX0tPntTZWxlY3Rpb25Tb3VyY2V9ICkKICAgICAgICAgICAgICAgICYmCiAgICAgICAgICAgICAgICAoICRQcmVmZXJlbmNlc3skQ3VycktleX0tPntTZWxlY3Rpb25Tb3VyY2V9IGVxICdHZW5lcmFsQ2F0YWxvZycgKQogICAgICAgICAgICAgICAgJiYKICAgICAgICAgICAgICAgICggJFByZWZlcmVuY2VzeyRDdXJyS2V5fS0+e0dlbmVyYWxDYXRhbG9nQ2xhc3N9ICkgJiYKICAgICAgICAgICAgICAgICRTZWxmLT57R2VuZXJhbENhdGFsb2dPYmplY3R9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG15ICRJdGVtTGlzdFJlZiA9ICRTZWxmLT57R2VuZXJhbENhdGFsb2dPYmplY3R9LT5JdGVtTGlzdCgKICAgICAgICAgICAgICAgICAgICBDbGFzcyA9PiAkUHJlZmVyZW5jZXN7JEN1cnJLZXl9LT57R2VuZXJhbENhdGFsb2dDbGFzc30sCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgaWYgKCAkSXRlbUxpc3RSZWYgJiYgcmVmKCRJdGVtTGlzdFJlZikgZXEgJ0hBU0gnICkgewogICAgICAgICAgICAgICAgICAgICVTZWxlY3Rpb25MaXN0ID0gJXskSXRlbUxpc3RSZWZ9OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIGNyZWF0ZSBub24tSUQgdmFsdWUgZm9yIGV4cG9ydC4uLgogICAgICAgICAgICAkU0xBRGF0YXskTmFtZVBhcnR9ID0gJFNlbGVjdGlvbkxpc3R7ICRTTEFEYXRheyRDdXJyS2V5fSB9CiAgICAgICAgICAgICAgICB8fCAkU0xBRGF0YXskQ3VycktleX07CgogICAgICAgIH0KCiAgICAgICAgIyBwcmVwYXJlZCBBc3NpZ25lZFNlcnZpY2VzLi4uCiAgICAgICAgaWYgKCAkU0xBRGF0YXtTZXJ2aWNlSURzfSAmJiByZWYoICRTTEFEYXRhe1NlcnZpY2VJRHN9ICkgZXEgJ0FSUkFZJyApIHsKICAgICAgICAgICAgbXkgQFNlcnZpY2VJRExpc3QgPSBzb3J0IEB7ICRTTEFEYXRhe1NlcnZpY2VJRHN9IH07CiAgICAgICAgICAgIG15ICRDdXJySW5kZXggICAgID0gMDsKICAgICAgICAgICAgZm9yIG15ICRDdXJyU2VydmljZUlEIChAU2VydmljZUlETGlzdCkgewogICAgICAgICAgICAgICAgbXkgJEN1cnJLZXlOYW1lID0gJ0Fzc2lnbmVkU2VydmljZScgLiBzcHJpbnRmKCAiJTAzZCIsICRDdXJySW5kZXggKTsKICAgICAgICAgICAgICAgIG15ICRDdXJyU2VydmljZSA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpTZXJ2aWNlJyktPlNlcnZpY2VMb29rdXAoCiAgICAgICAgICAgICAgICAgICAgU2VydmljZUlEID0+ICRDdXJyU2VydmljZUlELAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICRTTEFEYXRheyRDdXJyS2V5TmFtZX0gPSAkQ3VyclNlcnZpY2U7CiAgICAgICAgICAgICAgICAkQ3VyckluZGV4Kys7CiAgICAgICAgICAgIH0KCiAgICAgICAgfQoKICAgICAgICAjIHByZXBhcmUgY2FsZW5kYXIgbmFtZQogICAgICAgIGlmICggJFNMQURhdGF7Q2FsZW5kYXJ9ICYmICRTZWxmLT57Q2FsZW5kYXJOYW1lTGlzdH0tPnsgJFNMQURhdGF7Q2FsZW5kYXJ9IH0gKSB7CiAgICAgICAgICAgICRTTEFEYXRhe0NhbGVuZGFyfSA9ICRTZWxmLT57Q2FsZW5kYXJOYW1lTGlzdH0tPnsgJFNMQURhdGF7Q2FsZW5kYXJ9IH07CiAgICAgICAgfQoKICAgICAgICAjIGNyZWF0ZSBleHBvcnQgcm93Li4uCiAgICAgICAgbXkgQEN1cnJSb3cgPSBxd3t9OwogICAgICAgIGZvciBteSAkTWFwcGluZ09iamVjdCAoQE1hcHBpbmdPYmplY3RMaXN0KSB7CiAgICAgICAgICAgIGlmICggJE1hcHBpbmdPYmplY3QtPntLZXl9ICYmICRTTEFEYXRheyAkTWFwcGluZ09iamVjdC0+e0tleX0gfSApIHsKICAgICAgICAgICAgICAgIHB1c2goIEBDdXJyUm93LCAkU0xBRGF0YXsgJE1hcHBpbmdPYmplY3QtPntLZXl9IH0gKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHB1c2goIEBDdXJyUm93LCAnLScgKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBwdXNoIEBFeHBvcnREYXRhLCBcQEN1cnJSb3c7CgogICAgfQoKICAgIHJldHVybiBcQEV4cG9ydERhdGE7Cn0KCj1pdGVtIEltcG9ydERhdGFTYXZlKCkKCmltcG9ydCBvbmUgcm93IG9mIHRoZSBpbXBvcnQgZGF0YQoKICAgIG15ICRDb25maWdJdGVtSUQgPSAkT2JqZWN0QmFja2VuZC0+SW1wb3J0RGF0YVNhdmUoCiAgICAgICAgVGVtcGxhdGVJRCAgICA9PiAxMjMsCiAgICAgICAgSW1wb3J0RGF0YVJvdyA9PiAkQXJyYXlSZWYsCiAgICAgICAgVXNlcklEICAgICAgICA9PiAxLAogICAgKTsKCj1jdXQKCnN1YiBJbXBvcnREYXRhU2F2ZSB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgICMgY2hlY2sgbmVlZGVkIHN0dWZmCiAgICBmb3IgbXkgJEFyZ3VtZW50IChxdyhUZW1wbGF0ZUlEIEltcG9ydERhdGFSb3cgVXNlcklEKSkgewogICAgICAgIGlmICggISRQYXJhbXskQXJndW1lbnR9ICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiTmVlZCAkQXJndW1lbnQhIiwKICAgICAgICAgICAgKTsKCQkJcmV0dXJuICggdW5kZWYsICdGYWlsZWQnICk7CiAgICAgICAgfQogICAgfQoKICAgICMgY2hlY2sgaW1wb3J0IGRhdGEgcm93CiAgICBpZiAoIHJlZiAkUGFyYW17SW1wb3J0RGF0YVJvd30gbmUgJ0FSUkFZJyApIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gJ0ltcG9ydERhdGFSb3cgbXVzdCBiZSBhbiBhcnJheSByZWZlcmVuY2UnLAogICAgICAgICk7CgkJcmV0dXJuICggdW5kZWYsICdGYWlsZWQnICk7CiAgICB9CgogICAgIyBnZXQgb2JqZWN0IGRhdGEKICAgIG15ICRPYmplY3REYXRhID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5PYmplY3REYXRhR2V0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gJFBhcmFte1RlbXBsYXRlSUR9LAogICAgICAgIFVzZXJJRCAgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICApOwoKICAgICMgY2hlY2sgb2JqZWN0IGRhdGEKICAgIGlmICggISRPYmplY3REYXRhIHx8IHJlZiAkT2JqZWN0RGF0YSBuZSAnSEFTSCcgKSB7CiAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICJObyBvYmplY3QgZGF0YSBmb3VuZCBmb3IgdGhlIHRlbXBsYXRlIGlkICRQYXJhbXtUZW1wbGF0ZUlEfSIsCiAgICAgICAgKTsKCQlyZXR1cm4gKCB1bmRlZiwgJ0ZhaWxlZCcgKTsKICAgIH0KCiAgICAjIGdldCB0aGUgbWFwcGluZyBsaXN0CiAgICBteSAkTWFwcGluZ0xpc3QgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0JyktPk1hcHBpbmdMaXN0KAogICAgICAgIFRlbXBsYXRlSUQgPT4gJFBhcmFte1RlbXBsYXRlSUR9LAogICAgICAgIFVzZXJJRCAgICAgPT4gJFBhcmFte1VzZXJJRH0sCiAgICApOwoKICAgICMgY2hlY2sgdGhlIG1hcHBpbmcgbGlzdAogICAgaWYgKCAhJE1hcHBpbmdMaXN0IHx8IHJlZiAkTWFwcGluZ0xpc3QgbmUgJ0FSUkFZJyB8fCAhQHskTWFwcGluZ0xpc3R9ICkgewoKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ2Vycm9yJywKICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIHZhbGlkIG1hcHBpbmcgbGlzdCBmb3VuZCBmb3IgdGhlIHRlbXBsYXRlIGlkICRQYXJhbXtUZW1wbGF0ZUlEfSIsCiAgICAgICAgKTsKCQlyZXR1cm4gKCB1bmRlZiwgJ0ZhaWxlZCcgKTsKICAgIH0KCiAgICAjIGNyZWF0ZSB0aGUgbWFwcGluZyBvYmplY3QgbGlzdAogICAgbXkgQE1hcHBpbmdPYmplY3RMaXN0OwogICAgbXkgJUlkZW50aWZpZXI7CiAgICBteSAkQ291bnRlciAgICAgICAgICA9IDA7CiAgICBteSAlTmV3U0xBRGF0YSAgICAgICA9IHF3e307CiAgICBteSAkU0xBSWRlbnRpZmllcktleSA9ICIiOwoKICAgICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgI0JVSUxEIE1BUFBJTkcgVEFCTEUuLi4KICAgIGZvciBteSAkTWFwcGluZ0lEICggQHskTWFwcGluZ0xpc3R9ICkgewoKICAgICAgICAjIGdldCBtYXBwaW5nIG9iamVjdCBkYXRhCiAgICAgICAgbXkgJE1hcHBpbmdPYmplY3REYXRhID0KICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5NYXBwaW5nT2JqZWN0RGF0YUdldCgKICAgICAgICAgICAgTWFwcGluZ0lEID0+ICRNYXBwaW5nSUQsCiAgICAgICAgICAgIFVzZXJJRCAgICA9PiAkUGFyYW17VXNlcklEfSwKICAgICAgICAgICAgKTsKCiAgICAgICAgIyBjaGVjayBtYXBwaW5nIG9iamVjdCBkYXRhCiAgICAgICAgaWYgKCAhJE1hcHBpbmdPYmplY3REYXRhIHx8IHJlZiAkTWFwcGluZ09iamVjdERhdGEgbmUgJ0hBU0gnICkgewoKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIk5vIHZhbGlkIG1hcHBpbmcgbGlzdCBmb3VuZCBmb3IgdGVtcGxhdGUgaWQgJFBhcmFte1RlbXBsYXRlSUR9IiwKICAgICAgICAgICAgKTsKCQkJcmV0dXJuICggdW5kZWYsICdGYWlsZWQnICk7CiAgICAgICAgfQoKICAgICAgICBwdXNoKCBATWFwcGluZ09iamVjdExpc3QsICRNYXBwaW5nT2JqZWN0RGF0YSApOwoKICAgICAgICBpZiAoCiAgICAgICAgICAgICRNYXBwaW5nT2JqZWN0RGF0YS0+e0lkZW50aWZpZXJ9CiAgICAgICAgICAgICYmICRJZGVudGlmaWVyeyAkTWFwcGluZ09iamVjdERhdGEtPntLZXl9IH0KICAgICAgICAgICAgKQogICAgICAgIHsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkxvZycpLT5Mb2coCiAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnZXJyb3InLAogICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkNhbid0IGltcG9ydCB0aGlzIGVudGl0eS4gIgogICAgICAgICAgICAgICAgICAgIC4gIickTWFwcGluZ09iamVjdERhdGEtPntLZXl9JyBoYXMgYmVlbiB1c2VkIG11bHRpcGxlICIKICAgICAgICAgICAgICAgICAgICAuICJ0aW1lcyBhcyBpZGVudGlmaWVyLiEiLAogICAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBlbHNpZiAoICRNYXBwaW5nT2JqZWN0RGF0YS0+e0lkZW50aWZpZXJ9ICkgewogICAgICAgICAgICAkSWRlbnRpZmllcnsgJE1hcHBpbmdPYmplY3REYXRhLT57S2V5fSB9ID0KICAgICAgICAgICAgICAgICRQYXJhbXtJbXBvcnREYXRhUm93fS0+WyRDb3VudGVyXTsKICAgICAgICAgICAgJFNMQUlkZW50aWZpZXJLZXkgPSAkTWFwcGluZ09iamVjdERhdGEtPntLZXl9OwogICAgICAgIH0KCiAgICAgICAgJE5ld1NMQURhdGF7ICRNYXBwaW5nT2JqZWN0RGF0YS0+e0tleX0gfSA9CiAgICAgICAgICAgICRQYXJhbXtJbXBvcnREYXRhUm93fS0+WyRDb3VudGVyXTsKCiAgICAgICAgJENvdW50ZXIrKzsKICAgIH0KCiAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICNETyBUSEUgSU1QT1JULi4uCiAgICAjKDApIFByZXByb2Nlc3MgZGF0YS4uLgoKICAgICMgcHJlcGFyZSBjYWxlbmRhciBuYW1lLi4uCiAgICBpZiAoICROZXdTTEFEYXRhe0NhbGVuZGFyfSAmJiAkU2VsZi0+e1JldmVyc2VDYWxlbmRhck5hbWVMaXN0fS0+eyAkTmV3U0xBRGF0YXtDYWxlbmRhcn0gfSApIHsKICAgICAgICAkTmV3U0xBRGF0YXtDYWxlbmRhcn0gPSAkU2VsZi0+e1JldmVyc2VDYWxlbmRhck5hbWVMaXN0fS0+eyAkTmV3U0xBRGF0YXtDYWxlbmRhcn0gfTsKICAgIH0KCiAgICAjIGxvb2t1cCBWYWxpZC1JRC4uLgogICAgaWYgKCAhJE5ld1NMQURhdGF7VmFsaWRJRH0gJiYgJE5ld1NMQURhdGF7VmFsaWR9ICkgewogICAgICAgICROZXdTTEFEYXRhe1ZhbGlkSUR9ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlZhbGlkJyktPlZhbGlkTG9va3VwKAogICAgICAgICAgICBWYWxpZCA9PiAkTmV3U0xBRGF0YXtWYWxpZH0KICAgICAgICApOwogICAgfQogICAgaWYgKCAhJE5ld1NMQURhdGF7VmFsaWRJRH0gKSB7CiAgICAgICAgJE5ld1NMQURhdGF7VmFsaWRJRH0gPSAkT2JqZWN0RGF0YS0+e0RlZmF1bHRWYWxpZH0gfHwgMTsKICAgIH0KCiAgICAjIGxvb2t1cCB0eXBlLUlELi4uCiAgICBpZiAoCiAgICAgICAgJFNlbGYtPntSZXZlcnNlU0xBVHlwZUxpc3R9CiAgICAgICAgJiYgJE5ld1NMQURhdGF7VHlwZX0KICAgICAgICAmJiAkU2VsZi0+e1JldmVyc2VTTEFUeXBlTGlzdH0tPnsgJE5ld1NMQURhdGF7VHlwZX0gfQogICAgICAgICkKICAgIHsKICAgICAgICAkTmV3U0xBRGF0YXtUeXBlSUR9ID0gJFNlbGYtPntSZXZlcnNlU0xBVHlwZUxpc3R9LT57ICROZXdTTEFEYXRhe1R5cGV9IH07CiAgICB9CiAgICBpZiAoICEkTmV3U0xBRGF0YXtUeXBlSUR9ICkgewogICAgICAgICROZXdTTEFEYXRhe1R5cGVJRH0gPSAkT2JqZWN0RGF0YS0+e0RlZmF1bHRTTEFUeXBlSUR9OwogICAgfQoKICAgICMgbG9va3VwIGFzc2lnbmVkIFNlcnZpY2VJRHMKICAgIG15ICROdW1iZXJPZkFzc2lnbmFibGVTZXJ2aWNlcyA9ICRPYmplY3REYXRhLT57TnVtYmVyT2ZBc3NpZ25hYmxlU2VydmljZXN9IHx8IDA7CiAgICBteSAkQ3VyckluZGV4ICAgICAgICAgICAgICAgICAgPSAwOwogICAgbXkgQE5ld1NlcnZpY2VJRHMgICAgICAgICAgICAgID0gcXd7fTsKICAgIHdoaWxlICggJEN1cnJJbmRleCA8ICROdW1iZXJPZkFzc2lnbmFibGVTZXJ2aWNlcyApIHsKICAgICAgICBteSAkQ3VycktleU5hbWUgPSAnQXNzaWduZWRTZXJ2aWNlJyAuIHNwcmludGYoICIlMDNkIiwgJEN1cnJJbmRleCApOwoKICAgICAgICBpZiAoICROZXdTTEFEYXRheyRDdXJyS2V5TmFtZX0gJiYgJE5ld1NMQURhdGF7JEN1cnJLZXlOYW1lfSBuZSAnLScgKSB7CiAgICAgICAgICAgIG15ICRDdXJyU2VydmljZUlEID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlNlcnZpY2UnKS0+U2VydmljZUxvb2t1cCgKICAgICAgICAgICAgICAgIE5hbWUgPT4gJE5ld1NMQURhdGF7JEN1cnJLZXlOYW1lfSwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKCRDdXJyU2VydmljZUlEKSB7CiAgICAgICAgICAgICAgICBwdXNoKCBATmV3U2VydmljZUlEcywgJEN1cnJTZXJ2aWNlSUQgKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgJEN1cnJJbmRleCsrOwogICAgfQoKICAgICMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICMgcHJlcGFyZSBwcmVmZXJlbmNlcy4uLgoKICAgICMgZ2V0IHByZWZlcmVuY2VzIGNvbmZpZ3VyYXRpb24uLi4KICAgIG15ICVQcmVmZXJlbmNlcyA9ICgpOwogICAgaWYgKCAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpLT5HZXQoJ1NMQVByZWZlcmVuY2VzJykgKSB7CiAgICAgICAgbXkgJVByZWZDb25maWcgPSAleyAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpLT5HZXQoJ1NMQVByZWZlcmVuY2VzJykgfTsKICAgICAgICBmb3IgbXkgJEN1cnJLZXkgKCBrZXlzKCVQcmVmQ29uZmlnKSApIHsKICAgICAgICAgICAgbXkgJUN1cnJQcmVmcyA9ICgpOwogICAgICAgICAgICAkQ3VyclByZWZze0xhYmVsfSAgICAgICAgICAgICAgID0gJFByZWZDb25maWd7JEN1cnJLZXl9LT57TGFiZWx9OwogICAgICAgICAgICAkQ3VyclByZWZze1NlbGVjdGlvblNvdXJjZX0gICAgID0gJFByZWZDb25maWd7JEN1cnJLZXl9LT57U2VsZWN0aW9uU291cmNlfTsKICAgICAgICAgICAgJEN1cnJQcmVmc3tHZW5lcmFsQ2F0YWxvZ0NsYXNzfSA9ICRQcmVmQ29uZmlneyRDdXJyS2V5fS0+e0dlbmVyYWxDYXRhbG9nQ2xhc3N9OwogICAgICAgICAgICAkUHJlZmVyZW5jZXN7ICRQcmVmQ29uZmlneyRDdXJyS2V5fS0+e1ByZWZLZXl9IH0gPSBcJUN1cnJQcmVmczsKICAgICAgICB9CiAgICB9CgogICAgUFJFRkVSRU5DRUNIRUNLOgogICAgZm9yIG15ICRDdXJyS2V5ICgga2V5cyglTmV3U0xBRGF0YSkgKSB7CiAgICAgICAgbXkgJEN1cnJVc2VkS2V5ID0gIiI7CiAgICAgICAgbXkgJE5hbWVQYXJ0ICAgID0gJEN1cnJLZXk7CiAgICAgICAgaWYgKCAkQ3VycktleSA9fiAvXiguKylJRCQvICkgewogICAgICAgICAgICAkTmFtZVBhcnQgICAgPSAkMTsKICAgICAgICAgICAgJEN1cnJVc2VkS2V5ID0gJEN1cnJLZXk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkQ3VyclVzZWRLZXkgPSAkQ3VycktleSAuICJJRCI7CiAgICAgICAgfQoKICAgICAgICAjIHNraXAgaWYgbm8gcHJlZmVyZW5jZSB3aXRoIHNhbWUgbmFtZSBidXQgc3VmZml4ICJJRCIgZXhpc3RzLi4uCiAgICAgICAgbmV4dCBQUkVGRVJFTkNFQ0hFQ0sgaWYgKCAhJFByZWZlcmVuY2VzeyRDdXJyVXNlZEtleX0gKTsKCiAgICAgICAgIyBza2lwIGlmIG5vIFNlbGVjdGlvblNvdXJjZSBzcGVjaWZpZWQuLgogICAgICAgIG5leHQgUFJFRkVSRU5DRUNIRUNLIGlmICggISRQcmVmZXJlbmNlc3skQ3VyclVzZWRLZXl9LT57U2VsZWN0aW9uU291cmNlfSApOwoKICAgICAgICAjIGNoZWNrIGZvciBzb3VyY2Ugb2YgcHJlZmVyZW5jZS4uLgogICAgICAgIG15ICVTZWxlY3Rpb25MaXN0ID0gKCk7CiAgICAgICAgaWYgKCAkUHJlZmVyZW5jZXN7JEN1cnJVc2VkS2V5fS0+e1NlbGVjdGlvblNvdXJjZX0gZXEgJ1F1ZXVlTGlzdCcgKSB7CiAgICAgICAgICAgICVTZWxlY3Rpb25MaXN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlF1ZXVlJyktPlF1ZXVlTGlzdCgpOwogICAgICAgIH0KICAgICAgICBlbHNpZiAoICRQcmVmZXJlbmNlc3skQ3VyclVzZWRLZXl9LT57U2VsZWN0aW9uU291cmNlfSBlcSAnVHlwZUxpc3QnICkgewogICAgICAgICAgICAlU2VsZWN0aW9uTGlzdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpUeXBlJyktPlR5cGVMaXN0KCk7CiAgICAgICAgfQogICAgICAgIGVsc2lmICgKICAgICAgICAgICAgKCAkUHJlZmVyZW5jZXN7JEN1cnJVc2VkS2V5fS0+e1NlbGVjdGlvblNvdXJjZX0gZXEgJ0dlbmVyYWxDYXRhbG9nJyApCiAgICAgICAgICAgICYmCiAgICAgICAgICAgICggJFByZWZlcmVuY2VzeyRDdXJyVXNlZEtleX0tPntHZW5lcmFsQ2F0YWxvZ0NsYXNzfSApICYmCiAgICAgICAgICAgICRTZWxmLT57R2VuZXJhbENhdGFsb2dPYmplY3R9CiAgICAgICAgICAgICkKICAgICAgICB7CiAgICAgICAgICAgIG15ICRJdGVtTGlzdFJlZiA9ICRTZWxmLT57R2VuZXJhbENhdGFsb2dPYmplY3R9LT5JdGVtTGlzdCgKICAgICAgICAgICAgICAgIENsYXNzID0+ICRQcmVmZXJlbmNlc3skQ3VyclVzZWRLZXl9LT57R2VuZXJhbENhdGFsb2dDbGFzc30sCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGlmICggJEl0ZW1MaXN0UmVmICYmIHJlZigkSXRlbUxpc3RSZWYpIGVxICdIQVNIJyApIHsKICAgICAgICAgICAgICAgICVTZWxlY3Rpb25MaXN0ID0gJXskSXRlbUxpc3RSZWZ9OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIG15ICVSZXZlcnNlU2VsZWN0aW9uTGlzdCA9IHJldmVyc2UoJVNlbGVjdGlvbkxpc3QpOwoKICAgICAgICAjIGlmIG9ubHkgeHh4SUQgaXMgZ2l2ZW4sIHNldCB4eHguLi4KICAgICAgICBpZiAoCiAgICAgICAgICAgICROZXdTTEFEYXRheyRDdXJyVXNlZEtleX0KICAgICAgICAgICAgJiYgKCAhJE5ld1NMQURhdGF7JE5hbWVQYXJ0fSB8fCAkTmFtZVBhcnQgZXEgJEN1cnJVc2VkS2V5ICkKICAgICAgICAgICAgKQogICAgICAgIHsKICAgICAgICAgICAgJE5ld1NMQURhdGF7JE5hbWVQYXJ0fSA9ICRTZWxlY3Rpb25MaXN0eyAkTmV3U0xBRGF0YXskQ3VyclVzZWRLZXl9IH07CiAgICAgICAgfQoKICAgICAgICAjIGlmIHh4eElEIEFORCB4eHggYXJlIGdpdmVuIHJlcXVpcmUgdW5pcWVuZXNzLi4uCiAgICAgICAgZWxzaWYgKCAkTmV3U0xBRGF0YXskQ3VyclVzZWRLZXl9ICYmICROZXdTTEFEYXRheyROYW1lUGFydH0gKSB7CiAgICAgICAgICAgIG15ICRDb21wYXJlVmFsdWUgPSAkU2VsZWN0aW9uTGlzdHsgJE5ld1NMQURhdGF7JEN1cnJVc2VkS2V5fSB9OwogICAgICAgICAgICBpZiAoICRDb21wYXJlVmFsdWUgbmUgJE5ld1NMQURhdGF7JE5hbWVQYXJ0fSApIHsKICAgICAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkNhbid0IGltcG9ydCB0aGlzIGVudGl0eS4gIgogICAgICAgICAgICAgICAgICAgICAgICAuICJBbWJpZ291cyBkZWZpbml0aW9uIG9mIGF0dHJpYnV0ZSB2YWx1ZXMgIgogICAgICAgICAgICAgICAgICAgICAgICAuICIgKCROYW1lUGFydCA8JE5ld1NMQURhdGF7JE5hbWVQYXJ0fT4gZG9lcyBub3QiCiAgICAgICAgICAgICAgICAgICAgICAgIC4gIm1hdGNoICRDdXJyVXNlZEtleSA8JE5ld1NMQURhdGF7JEN1cnJVc2VkS2V5fT4pISIsCiAgICAgICAgICAgICAgICApOwoJCQlyZXR1cm4gKCB1bmRlZiwgJ0ZhaWxlZCcgKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgIyBpZiBvbmx5IHh4eCBpcyBnaXZlbiBhbmQgSUQgY2FuIGJlIGZvdW5kIC0gZ2V0IHRoZSBJRC4uLgogICAgICAgIGVsc2lmICgKICAgICAgICAgICAgISROZXdTTEFEYXRheyRDdXJyVXNlZEtleX0KICAgICAgICAgICAgJiYgJE5ld1NMQURhdGF7JE5hbWVQYXJ0fQogICAgICAgICAgICAmJiAkUmV2ZXJzZVNlbGVjdGlvbkxpc3R7ICROZXdTTEFEYXRheyROYW1lUGFydH0gfQogICAgICAgICAgICApCiAgICAgICAgewogICAgICAgICAgICAkTmV3U0xBRGF0YXskQ3VyclVzZWRLZXl9ID0gJFJldmVyc2VTZWxlY3Rpb25MaXN0eyAkTmV3U0xBRGF0YXskTmFtZVBhcnR9IH07CiAgICAgICAgfQoKICAgICAgICAjIGlmIG9ubHkgeHh4IGlzIGdpdmVuIGFuZCBubyBJRCBjYW4gYmUgZm91bmQgLSByZWplY3QgaW1wb3J0Li4uCiAgICAgICAgZWxzaWYgKAogICAgICAgICAgICAhJE5ld1NMQURhdGF7JEN1cnJVc2VkS2V5fQogICAgICAgICAgICAmJiAkTmV3U0xBRGF0YXskTmFtZVBhcnR9CiAgICAgICAgICAgICYmICEkUmV2ZXJzZVNlbGVjdGlvbkxpc3R7ICROZXdTTEFEYXRheyROYW1lUGFydH0gfQogICAgICAgICAgICApCiAgICAgICAgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiQ2FuJ3QgaW1wb3J0IHRoaXMgZW50aXR5LiAiCiAgICAgICAgICAgICAgICAgICAgLiAiQmFkIGRlZmluaXRpb24gb2YgYXR0cmlidXRlIHZhbHVlICIKICAgICAgICAgICAgICAgICAgICAuICIgKCROYW1lUGFydCA8JE5ld1NMQURhdGF7JE5hbWVQYXJ0fT4gZG9lcyBub3QiCiAgICAgICAgICAgICAgICAgICAgLiAibWF0Y2ggYW55IGV4aXN0aW5nIHZhbHVlIGluIHNlbGVjdGlvbikhIiwKICAgICAgICAgICAgKTsKCQkJcmV0dXJuICggdW5kZWYsICdGYWlsZWQnICk7CiAgICAgICAgfQoKICAgIH0KCiAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAjKDEpIHNlYXJjaCBTTEEuLi4KICAgIG15ICVTTEFEYXRhID0gKCk7CiAgICBteSAkTmV3U0xBICA9IDE7CiAgICBteSAkU0xBSUQgICA9ICROZXdTTEFEYXRheyRTTEFJZGVudGlmaWVyS2V5fSB8fCAwOwoKICAgIGlmICgKICAgICAgICAoICEkU0xBSWRlbnRpZmllcktleSB8fCAkU0xBSWRlbnRpZmllcktleSBlcSAnTmFtZScgfHwgISROZXdTTEFEYXRheyRTTEFJZGVudGlmaWVyS2V5fSApCiAgICAgICAgJiYgJE5ld1NMQURhdGF7TmFtZX0KICAgICAgICApCiAgICB7CiAgICAgICAgJFNMQUlEID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlNMQScpLT5TTEFMb29rdXAoCiAgICAgICAgICAgIE5hbWUgPT4gJE5ld1NMQURhdGF7TmFtZX0sCiAgICAgICAgKTsKICAgIH0KCiAgICBpZiAoICRTTEFJRCAmJiAkU0xBSUQgPX4gL1xkKy8gKSB7CiAgICAgICAgJVNMQURhdGEgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U0xBJyktPlNMQUdldCgKICAgICAgICAgICAgU0xBSUQgID0+ICRTTEFJRCwKICAgICAgICAgICAgVXNlcklEID0+IDEsCiAgICAgICAgKTsKICAgIH0KICAgIGVsc2lmICgkU0xBSUQpIHsKICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgUHJpb3JpdHkgPT4gJ25vdGljZScsCiAgICAgICAgICAgIE1lc3NhZ2UgID0+ICdJbXBvcnREYXRhU2F2ZTogU0xBSUQgPCcgLiAkU0xBSUQgLiAnPiBpcyBub3QgYSBudW1iZXIgJwogICAgICAgICAgICAgICAgLiAnKG1heWJlIGxhYmVsIG9yIGhlYWRsaW5lKS4nLAogICAgICAgICk7CgkJcmV0dXJuICggdW5kZWYsICdGYWlsZWQnICk7CiAgICB9CgogICAgaWYgKCBzY2FsYXIoIGtleXMoJVNMQURhdGEpICkgKSB7CiAgICAgICAgJE5ld1NMQSA9IDA7CiAgICB9CgogICAgZm9yIG15ICRLZXkgKCBrZXlzKCVOZXdTTEFEYXRhKSApIHsKICAgICAgICBuZXh0IGlmICggISROZXdTTEFEYXRheyRLZXl9ICk7CiAgICAgICAgJFNMQURhdGF7JEtleX0gPSAkTmV3U0xBRGF0YXskS2V5fTsKICAgIH0KCiAgICBmb3IgbXkgJEN1cnJLZXkgKAogICAgICAgIHF3KCBGaXJzdFJlc3BvbnNlVGltZSBGaXJzdFJlc3BvbnNlTm90aWZ5IFVwZGF0ZVRpbWUKICAgICAgICBVcGRhdGVOb3RpZnkgU29sdXRpb25UaW1lIFNvbHV0aW9uTm90aWZ5IE1pblRpbWVCZXR3ZWVuSW5jaWRlbnRzKQogICAgICAgICkKICAgIHsKICAgICAgICBpZiAoICRTTEFEYXRheyRDdXJyS2V5fSAmJiAkU0xBRGF0YXskQ3VycktleX0gZXEgJy0nICkgewogICAgICAgICAgICBkZWxldGUoICRTTEFEYXRheyRDdXJyS2V5fSApOwogICAgICAgIH0KICAgIH0KCiAgICAkU0xBRGF0YXtTZXJ2aWNlSURzfSA9IFxATmV3U2VydmljZUlEczsKCiAgICAjKDIpIGlmIFNMQSBET0VTIE5PVCBleGlzdHMgPT4gY3JlYXRlIG5ldy4uLgogICAgbXkgJFJlc3VsdCA9IDA7CiAgICBteSAkUmV0dXJuQ29kZSA9ICIiOyAgICAjIENyZWF0ZWQgfCBDaGFuZ2VkIHwgRmFpbGVkCiAgICAgICAgCiAgICBpZiAoJE5ld1NMQSkgewogICAgICAgICRSZXN1bHQgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U0xBJyktPlNMQUFkZCgKICAgICAgICAgICAgJVNMQURhdGEsCiAgICAgICAgICAgIFVzZXJJRCA9PiAkUGFyYW17VXNlcklEfSwKICAgICAgICApOwoKICAgICAgICBpZiAoICEkUmVzdWx0ICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnSW1wb3J0RGF0YVNhdmU6IGFkZGluZyBTTEEgPCcKICAgICAgICAgICAgICAgICAgICAuICRTTEFEYXRhe05hbWV9CiAgICAgICAgICAgICAgICAgICAgLiAnPiBmYWlsZWQuJywKICAgICAgICAgICAgKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRSZXR1cm5Db2RlID0gIkNyZWF0ZWQiOwogICAgICAgIH0gICAgCiAgICB9CgogICAgIygzKSBpZiBTTEEgRE9FUyBleGlzdHMgPT4gdXBkYXRlLi4uCiAgICBpZiAoICEkTmV3U0xBICkgewogICAgICAgICRSZXN1bHQgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6U0xBJyktPlNMQVVwZGF0ZSgKICAgICAgICAgICAgJVNMQURhdGEsCiAgICAgICAgICAgIFVzZXJJRCA9PiAkUGFyYW17VXNlcklEfSwKICAgICAgICApOwoKICAgICAgICBpZiAoICEkUmVzdWx0ICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAnSW1wb3J0RGF0YVNhdmU6IHVwZGF0aW5nIFNMQSA8JwogICAgICAgICAgICAgICAgICAgIC4gJFNMQURhdGF7TmFtZX0KICAgICAgICAgICAgICAgICAgICAuICc+IChJRCAnCiAgICAgICAgICAgICAgICAgICAgLiAkU0xBRGF0YXtTTEFJRH0KICAgICAgICAgICAgICAgICAgICAuICcpIGZhaWxlZC4nLAogICAgICAgICAgICApOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJFJldHVybkNvZGUgPSAiQ2hhbmdlZCI7CiAgICAgICAgfSAgICAKICAgIH0KCiAgICAjKDQpIHNldCBwcmVmZXJlbmNlcy4uLgogICAgaWYgKCRTTEFJRCkgewogICAgICAgIGZvciBteSAkQ3VycktleSAoIGtleXMoJVByZWZlcmVuY2VzKSApIHsKICAgICAgICAgICAgbmV4dCBpZiAoICEkTmV3U0xBRGF0YXskQ3VycktleX0gKTsKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OlNMQScpLT5TTEFQcmVmZXJlbmNlc1NldCgKICAgICAgICAgICAgICAgIFNMQUlEICA9PiAkU0xBSUQsCiAgICAgICAgICAgICAgICBLZXkgICAgPT4gJEN1cnJLZXksCiAgICAgICAgICAgICAgICBWYWx1ZSAgPT4gJE5ld1NMQURhdGF7JEN1cnJLZXl9LAogICAgICAgICAgICAgICAgVXNlcklEID0+ICRQYXJhbXtVc2VySUR9LAogICAgICAgICAgICApOwogICAgICAgIH0KICAgIH0KICAgIHJldHVybiAoICRSZXN1bHQsICRSZXR1cm5Db2RlICk7Cn0KCjE7Cg==</File>
        <File Location="Kernel/Language/de_ServiceImportExport.pm" Permission="644" Encode="Base64">IyAtLQojIEtlcm5lbC9MYW5ndWFnZS9kZV9TZXJ2aWNlSW1wb3J0RXhwb3J0IC0gcHJvdmlkZXMgZ2VybWFuIGxhbmd1YWdlCiMgdHJhbnNsYXRpb24gZm9yIFNlcnZpY2VJbXBvcnRFeHBvcnQgbW9kdWxlCiMgQ29weXJpZ2h0IChDKSAyMDA2LTIwMTUgYy5hLnAuZS4gSVQgR21iSCwgaHR0cDovL3d3dy5jYXBlLWl0LmRlCiMgCiMgd3JpdHRlbi9lZGl0ZWQgYnk6CiMgKiBBbm5hKGRvdClMaXR2aW5vdmEoYXQpY2FwZShkYXNoKWl0KGRvdClkZQojICogVGhvbWFzKGRvdClMYW5nZShhdCljYXBlKGRhc2gpaXQoZG90KWRlCiMgLS0KIyAkSWQ6IGRlX1NlcnZpY2VJbXBvcnRFeHBvcnQucG0sdiAxLjggMjAxNS8xMS8xNyAwOTo0NTo1MSB0bGFuZ2UgRXhwICQKIyAtLQojIFRoaXMgc29mdHdhcmUgY29tZXMgd2l0aCBBQlNPTFVURUxZIE5PIFdBUlJBTlRZLiBGb3IgZGV0YWlscywgc2VlCiMgdGhlIGVuY2xvc2VkIGZpbGUgQ09QWUlORyBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbiAoQUdQTCkuIElmIHlvdQojIGRpZCBub3QgcmVjZWl2ZSB0aGlzIGZpbGUsIHNlZSBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvYWdwbC50eHQuCiMgLS0KcGFja2FnZSBLZXJuZWw6Okxhbmd1YWdlOjpkZV9TZXJ2aWNlSW1wb3J0RXhwb3J0OwoKdXNlIHN0cmljdDsKdXNlIHdhcm5pbmdzOwp1c2UgdXRmODsKCnN1YiBEYXRhIHsKICAgIG15ICRTZWxmID0gc2hpZnQ7CgogICAgbXkgJExhbmcgPSAkU2VsZi0+e1RyYW5zbGF0aW9ufTsKCiAgICByZXR1cm4gaWYgcmVmICRMYW5nIG5lICdIQVNIJzsKCiAgICAjIHBvc3NpYmxlIGNoYXJzZXRzCiAgICAkU2VsZi0+e0NoYXJzZXR9ID0gWyd1dGYtOCcsIF07CiAgICAKICAgICMgJCRTVEFSVCQkCgogICAgIyB0cmFuc2xhdGlvbnMgbWlzc2luZyBpbiBJbXBvcnRFeHBvcnQuLi4KICAgICRMYW5nLT57J0NvbHVtbiBTZXBlcmF0b3InfSAgICAgICAgICAgPSAnU3BhbHRlbnRyZW5uZXInOwogICAgJExhbmctPnsnQ2hhcnNldCd9ICAgICAgICAgICAgICAgICAgICA9ICdaZWljaGVuc2F0eic7CiAgICAkTGFuZy0+eydSZXN0cmljdCBleHBvcnQgcGVyIHNlYXJjaCd9ID0gJ0V4cG9ydCBtaXR0ZWxzIFN1Y2hlIGVpbnNjaHLDpG5rZW4nOwoKICAgICMgc2VydmljZTJjdXN0b21lcnVzZXIgZXgtL2ltcG9ydC4uLgogICAgJExhbmctPnsnU2VydmljZSBhdmFpbGFibGUgZm9yIENVJ30gPSAnU2VydmljZSBmw7xyIEt1bmRlbm51dHplciB2ZXJmw7xnYmFyJzsKICAgICRMYW5nLT57J0N1c3RvbWVyIFVzZXIgTG9naW4nfSAgICAgID0gJ0t1bmRlbm51dHplcmxvZ2luJzsKICAgICRMYW5nLT57J1ZhbGlkaXR5IG9mIHNlcnZpY2UgYXNzaWdubWVudCBmb3IgQ1UnfSA9CiAgICAgICAgJ0fDvGx0aWdrZWl0IGRlciBTZXJ2aWNlenVvcmRudW5nIHp1IEt1bmRlbm51dHplcic7CgogICAgIyBzZXJ2aWNlIGV4LS9pbXBvcnQuLi4KICAgICRMYW5nLT57J0Z1bGwgU2VydmljZSBOYW1lJ30gICAgICAgICAgICAgICAgICA9ICdWb2xsc3TDvG5kaWdlciBTZXJ2aWNlbmFtZSc7CiAgICAkTGFuZy0+eydTaG9ydCBTZXJ2aWNlIE5hbWUnfSAgICAgICAgICAgICAgICAgPSAnS3VyenNlcnZpY2VuYW1lJzsKICAgICRMYW5nLT57J1NlcnZpY2UgVHlwZSAoSVRTTSBvbmx5KSd9ICAgICAgICAgICA9ICdTZXJ2aWNldHlwIChudXIgSVRTTSknOwogICAgJExhbmctPnsnQ3JpdGljYWxpdHkgKElUU00gb25seSknfSAgICAgICAgICAgID0gJ0tyaXRpa2FsaXTDpHQgKG51ciBJVFNNKSc7CiAgICAkTGFuZy0+eydDdXJyZW50IEluY2lkZW50IFN0YXRlIChJVFNNIG9ubHkpJ30gPSAnQWt0LiBTdMO2cnVuZ3NzdGF0dXMgKG51ciBJVFNNKSc7CiAgICAkTGFuZy0+eydDdXJyZW50IEluY2lkZW50IFN0YXRlIFR5cGUgKElUU00gb25seSknfQogICAgICAgID0gJ0FrdC4gU3TDtnJ1bmdzc3RhdHVzdHlwIChudXIgSVRTTSknOwogICAgJExhbmctPnsnRGVmYXVsdCBTZXJ2aWNlIFR5cGUnfSA9ICdTdGFuZGFyZC1TZXJ2aWNldHlwJzsKICAgICRMYW5nLT57J1ZhbGlkaXR5J30gICAgICAgICAgICAgPSAnR8O8bHRpZ2tlaXQnOwogICAgJExhbmctPnsnRGVmYXVsdCBWYWxpZGl0eSd9ICAgICA9ICdTdGFuZGFyZC1Hw7xsdGlna2VpdCc7CiAgICAkTGFuZy0+eydEZWZhdWx0IENyaXRpY2FsaXR5J30gID0gJ1N0YW5kYXJkLUtyaXRpa2FsaXTDpHQnOwoKICAgICMgU0xBIGV4LS9pbXBvcnQuLi4KICAgICRMYW5nLT57J0RlZmF1bHQgU0xBIFR5cGUnfSAgICAgICAgICAgICAgICAgICAgICAgPSAnU3RhbmRhcmQtU0xBLVR5cCc7CiAgICAkTGFuZy0+eydEZWZhdWx0IE1pbmltdW0gVGltZSBCZXR3ZWVuIEluY2lkZW50cyd9ID0gJ1N0YW5kYXJkIE1pbmltdW16ZWl0IHp3aXNjaGVuIFN0w7ZydW5nZW4nOwogICAgJExhbmctPnsnTWF4LiBudW1iZXIgb2YgY29sdW1ucyB3aGljaCBtYXkgY29udGFpbiBhc3NpZ25lZCBzZXJ2aWNlcyd9CiAgICAgICAgPSAnTWF4LiBBbnphaGwgdm9uIFNwYWx0ZW4gZGllIHp1Z2V3aWVzZW5lIFNlcnZpY2VzIGVudGhhbHRlbiBrw7ZubmVuJzsKICAgICRMYW5nLT57J01heC4gbnVtYmVyIG9mIGFzc2lnbmVkIHNlcnZpY2VzIGNvbHVtbnMnfSA9ICdNYXguIFNwYWx0ZW5hbnphaGwgenVnZXcuIFNlcnZpY2VzJzsKCiAgICAkTGFuZy0+eydTTEEgVHlwZSAoSVRTTSBvbmx5KSd9ID0gJ1NMQSBUeXAgKG51ciBJVFNNKSc7CiAgICAkTGFuZy0+eydNaW4uIFRpbWUgQmV0d2VlbiBJbmNpZGVudHMgKElUU00gb25seSknfQogICAgICAgID0gJ1N0YW5kYXJkIE1pbmltdW16ZWl0IHp3aXNjaGVuIFN0w7ZydW5nZW4gKG51ciBJVFNNKSc7CiAgICAkTGFuZy0+eydTb2x1dGlvbk5vdGlmeSAocGVyY2VudCknfSAgICAgICAgPSAnU29sdXRpb25Ob3RpZnkgKFByb3plbnQpJzsKICAgICRMYW5nLT57J1NvbHV0aW9uVGltZSAoYnVzaW5lc3MgbWludXRlcyknfSA9ICdTb2x1dGlvblRpbWUgKEdlc2Now6RmdHNtaW51dGVuKSc7CiAgICAkTGFuZy0+eydVcGRhdGVOb3RpZnkgKHBlcmNlbnQpJ30gICAgICAgICAgPSAnVXBkYXRlTm90aWZ5IChQcm96ZW50KSc7CiAgICAkTGFuZy0+eydVcGRhdGVUaW1lIChidXNpbmVzcyBtaW51dGVzKSd9ICAgPSAnVXBkYXRlVGltZSAoR2VzY2jDpGZ0c21pbnV0ZW4pJzsKICAgICRMYW5nLT57J0ZpcnN0UmVzcG9uc2VOb3RpZnkgKHBlcmNlbnQpJ30gICA9ICdGaXJzdFJlc3BvbnNlTm90aWZ5IChQcm96ZW50KSc7CiAgICAkTGFuZy0+eydGaXJzdFJlc3BvbnNlVGltZSAoYnVzaW5lc3MgbWludXRlcyknfQogICAgICAgID0gJ0ZpcnN0UmVzcG9uc2VUaW1lIChHZXNjaMOkZnRzbWludXRlbiknOwogICAgJExhbmctPnsnQ2FsZW5kYXIgTmFtZSd9ID0gJ0thbGVuZGVybmFtZSc7CgogICAgJExhbmctPnsnRXhwb3J0IHdpdGggbGFiZWxzJ30gPSAnTWl0IEJlc2NocmlmdHVuZyBleHBvcnRpZXJlbic7CgogICAgIyBTeXNDb25maWcgZGVzY3JpcHRpb25zCiAgICAkTGFuZy0+eydPYmplY3QgYmFja2VuZCBtb2R1bGUgcmVnaXN0cmF0aW9uIGZvciB0aGUgaW1wb3J0L2V4cG9ydCBtb2R1bHMuJ30gPQogICAgICAgICdPYmpla3QtQmFja2VuZCBNb2R1bCBSZWdpc3RyYXRpb24gZGVzIEltcG9ydC9FeHBvcnQgTW9kdWxzLic7CgogICAgIyAgICRMYW5nLT57Jyd9ID0gJyc7CgogICAgcmV0dXJuIDA7CgogICAgIyAkJFNUT1AkJAp9CgoxOw==</File>
        <File Location="var/packagesetup/ServiceImportExport.pm" Permission="644" Encode="Base64">IyAtLQojIFNlcnZpY2VJbXBvcnRFeHBvcnQucG0gLSBjb2RlIHJ1biBkdXJpbmcgcGFja2FnZSBkZS0vaW5zdGFsbGF0aW9uCiMgQ29weXJpZ2h0IChDKSAyMDA2LTIwMTUgYy5hLnAuZS4gSVQgR21iSCwgaHR0cDovL3d3dy5jYXBlLWl0LmRlCiMKIyB3cml0dGVuL2VkaXRlZCBieToKIyAqIFRvcnN0ZW4oZG90KVRoYXUoYXQpY2FwZS1pdC5kZQojICogTWFydGluKGRvdClCYWx6YXJlayhhdCljYXBlLWl0LmRlCiMgKiBBbm5hKGRvdClMaXR2aW5vdmEoYXQpY2FwZShkYXNoKWl0KGRvdClkZQojICogVGhvbWFzKGRvdClMYW5nZShhdCljYXBlKGRhc2gpaXQoZG90KWRlCiMKIyAtLQojICRJZDogU2VydmljZUltcG9ydEV4cG9ydC5wbSx2IDEuMjAgMjAxNS8xMS8xNyAwNTo0NDoxOSB0bGFuZ2UgRXhwICQKIyAtLQojIFRoaXMgc29mdHdhcmUgY29tZXMgd2l0aCBBQlNPTFVURUxZIE5PIFdBUlJBTlRZLiBGb3IgZGV0YWlscywgc2VlCiMgdGhlIGVuY2xvc2VkIGZpbGUgQ09QWUlORyBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbiAoR1BMKS4gSWYgeW91CiMgZGlkIG5vdCByZWNlaXZlIHRoaXMgZmlsZSwgc2VlIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9ncGwtMi4wLnR4dC4KIyAtLQoKcGFja2FnZSB2YXI6OnBhY2thZ2VzZXR1cDo6U2VydmljZUltcG9ydEV4cG9ydDsKCnVzZSBzdHJpY3Q7CnVzZSB3YXJuaW5nczsKCm91ciBAT2JqZWN0RGVwZW5kZW5jaWVzID0gKAogICAgJ0tlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQnLAogICAgJ0tlcm5lbDo6U3lzdGVtOjpEeW5hbWljRmllbGQnLAogICAgJ0tlcm5lbDo6U3lzdGVtOjpTZXJ2aWNlJywKICAgICdLZXJuZWw6OlN5c3RlbTo6U0xBJywKICAgICdLZXJuZWw6OlN5c3RlbTo6TG9nJywKICAgICdLZXJuZWw6OlN5c3RlbTo6TWFpbicsCiAgICAnS2VybmVsOjpDb25maWcnCik7Cgo9aGVhZDEgTkFNRQoKU2VydmljZUltcG9ydEV4cG9ydC5wbSAtIGNvZGUgdG8gZXhjZWN1dGUgZHVyaW5nIHBhY2thZ2UgaW5zdGFsbGF0aW9uCgo9aGVhZDEgU1lOT1BTSVMKCkFsbCBmdW5jdGlvbnMKCj1oZWFkMSBQVUJMSUMgSU5URVJGQUNFCgo9b3ZlciA0Cgo9Y3V0Cgo9aXRlbSBuZXcoKQoKY3JlYXRlIGFuIG9iamVjdAoKICAgIHVzZSBLZXJuZWw6OkNvbmZpZzsKICAgIHVzZSBLZXJuZWw6OlN5c3RlbTo6TG9nOwogICAgdXNlIEtlcm5lbDo6U3lzdGVtOjpNYWluOwogICAgdXNlIEtlcm5lbDo6U3lzdGVtOjpUaW1lOwogICAgdXNlIEtlcm5lbDo6U3lzdGVtOjpEQjsKICAgIHVzZSBLZXJuZWw6OlN5c3RlbTo6WE1MOwoKICAgIG15ICRDb25maWdPYmplY3QgPSBLZXJuZWw6OkNvbmZpZy0+bmV3KCk7CiAgICBteSAkTG9nT2JqZWN0ICAgID0gS2VybmVsOjpTeXN0ZW06OkxvZy0+bmV3KAogICAgICAgIENvbmZpZ09iamVjdCA9PiAkQ29uZmlnT2JqZWN0LAogICAgKTsKICAgIG15ICRNYWluT2JqZWN0ID0gS2VybmVsOjpTeXN0ZW06Ok1haW4tPm5ldygKICAgICAgICBDb25maWdPYmplY3QgPT4gJENvbmZpZ09iamVjdCwKICAgICAgICBMb2dPYmplY3QgICAgPT4gJExvZ09iamVjdCwKICAgICk7CiAgICBteSAkVGltZU9iamVjdCA9IEtlcm5lbDo6U3lzdGVtOjpUaW1lLT5uZXcoCiAgICAgICAgQ29uZmlnT2JqZWN0ID0+ICRDb25maWdPYmplY3QsCiAgICAgICAgTG9nT2JqZWN0ICAgID0+ICRMb2dPYmplY3QsCiAgICApOwogICAgbXkgJERCT2JqZWN0ID0gS2VybmVsOjpTeXN0ZW06OkRCLT5uZXcoCiAgICAgICAgQ29uZmlnT2JqZWN0ID0+ICRDb25maWdPYmplY3QsCiAgICAgICAgTG9nT2JqZWN0ICAgID0+ICRMb2dPYmplY3QsCiAgICAgICAgTWFpbk9iamVjdCAgID0+ICRNYWluT2JqZWN0LAogICAgKTsKICAgIG15ICRYTUxPYmplY3QgPSBLZXJuZWw6OlN5c3RlbTo6WE1MLT5uZXcoCiAgICAgICAgQ29uZmlnT2JqZWN0ID0+ICRDb25maWdPYmplY3QsCiAgICAgICAgTG9nT2JqZWN0ICAgID0+ICRMb2dPYmplY3QsCiAgICAgICAgREJPYmplY3QgICAgID0+ICREQk9iamVjdCwKICAgICAgICBNYWluT2JqZWN0ICAgPT4gJE1haW5PYmplY3QsCiAgICApOwogICAgbXkgJENvZGVPYmplY3QgPSB2YXI6OnBhY2thZ2VzZXR1cDo6U2VydmljZUltcG9ydEV4cG9ydC5wbS0+bmV3KAogICAgICAgIENvbmZpZ09iamVjdCA9PiAkQ29uZmlnT2JqZWN0LAogICAgICAgIExvZ09iamVjdCAgICA9PiAkTG9nT2JqZWN0LAogICAgICAgIE1haW5PYmplY3QgICA9PiAkTWFpbk9iamVjdCwKICAgICAgICBUaW1lT2JqZWN0ICAgPT4gJFRpbWVPYmplY3QsCiAgICAgICAgREJPYmplY3QgICAgID0+ICREQk9iamVjdCwKICAgICAgICBYTUxPYmplY3QgICAgPT4gJFhNTE9iamVjdCwKICAgICk7Cgo9Y3V0CgpzdWIgbmV3IHsKICAgIG15ICggJFR5cGUsICVQYXJhbSApID0gQF87CgogICAgbXkgJFNlbGYgPSB7fTsKICAgIGJsZXNzKCAkU2VsZiwgJFR5cGUgKTsKCiAgICByZXR1cm4gJFNlbGY7Cn0KCj1pdGVtIENvZGVJbnN0YWxsKCkKCnJ1biB0aGUgY29kZSBpbnN0YWxsIHBhcnQKCiAgICBteSAkUmVzdWx0ID0gJENvZGVPYmplY3QtPkNvZGVJbnN0YWxsKCk7Cgo9Y3V0CgpzdWIgQ29kZUluc3RhbGwgewogICAgbXkgKCAkU2VsZiwgJVBhcmFtICkgPSBAXzsKCiAgICAkU2VsZi0+X0NyZWF0ZU1hcHBpbmdzKCk7CgogICAgcmV0dXJuIDE7Cn0KCj1pdGVtIENvZGVSZWluc3RhbGwoKQoKcnVuIHRoZSBjb2RlIHJlaW5zdGFsbCBwYXJ0CgogICAgbXkgJFJlc3VsdCA9ICRDb2RlT2JqZWN0LT5Db2RlUmVpbnN0YWxsKCk7Cgo9Y3V0CgpzdWIgQ29kZVJlaW5zdGFsbCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgICRTZWxmLT5fQ3JlYXRlTWFwcGluZ3MoKTsKCiAgICByZXR1cm4gMTsKfQoKPWl0ZW0gQ29kZVVwZ3JhZGUoKQoKcnVuIHRoZSBjb2RlIHVwZ3JhZGUgcGFydAoKICAgIG15ICRSZXN1bHQgPSAkQ29kZU9iamVjdC0+Q29kZVVwZ3JhZGUoKTsKCj1jdXQKCnN1YiBDb2RlVXBncmFkZSB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgICRTZWxmLT5fQ3JlYXRlTWFwcGluZ3MoKTsKICAgIAogICAgcmV0dXJuIDE7Cn0KCj1pdGVtIENvZGVVbmluc3RhbGwoKQoKcnVuIHRoZSBjb2RlIHVuaW5zdGFsbCBwYXJ0CgogICAgbXkgJFJlc3VsdCA9ICRDb2RlT2JqZWN0LT5Db2RlVW5pbnN0YWxsKCk7Cgo9Y3V0CgpzdWIgQ29kZVVuaW5zdGFsbCB7CiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgICRTZWxmLT5fUmVtb3ZlUmVsYXRlZE1hcHBpbmdzKCk7CgogICAgcmV0dXJuIDE7Cn0KCnN1YiBfUmVtb3ZlUmVsYXRlZE1hcHBpbmdzICgpIHsKCiAgICBteSAoICRTZWxmLCAlUGFyYW0gKSA9IEBfOwoKICAgIG15ICRUZW1wbGF0ZUxpc3Q7CiAgICBteSBAVGVtcGxhdGVPYmplY3RzID0gKCAnU2VydmljZScsICdTTEEnLCAnU2VydmljZTJDdXN0b21lclVzZXInICk7CiAgICBteSBAVGVtcGxhdGVPYmplY3RzU3VtOwogICAgZm9yZWFjaCBteSAkVGVtcGxhdGVPYmplY3QgKEBUZW1wbGF0ZU9iamVjdHMpIHsKICAgICAgICAkVGVtcGxhdGVMaXN0ID0gJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5UZW1wbGF0ZUxpc3QoCiAgICAgICAgICAgIE9iamVjdCA9PiAkVGVtcGxhdGVPYmplY3QsCiAgICAgICAgICAgIEZvcm1hdCA9PiAnQ1NWJywKICAgICAgICAgICAgVXNlcklEID0+IDEsCiAgICAgICAgKTsKICAgICAgICBAVGVtcGxhdGVPYmplY3RzU3VtID0gKCBAVGVtcGxhdGVPYmplY3RzU3VtLCBAeyRUZW1wbGF0ZUxpc3R9ICk7CiAgICB9CgogICAgIyBkZWxldGUgdGhlIHRlbXBsYXRlcwogICAgaWYgKCByZWYoJFRlbXBsYXRlTGlzdCkgZXEgJ0FSUkFZJyAmJiBAeyRUZW1wbGF0ZUxpc3R9ICkgewogICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQnKS0+VGVtcGxhdGVEZWxldGUoCiAgICAgICAgICAgIFRlbXBsYXRlSUQgPT4gXEBUZW1wbGF0ZU9iamVjdHNTdW0sCiAgICAgICAgICAgIFVzZXJJRCAgICAgPT4gMSwKICAgICAgICApOwogICAgfQoKICAgIHJldHVybiAxOwp9CgpzdWIgX0NyZWF0ZU1hcHBpbmdzICgpIHsKICAgIG15ICggJFNlbGYsICVQYXJhbSApID0gQF87CgogICAgbXkgJEltcG9ydEV4cG9ydE1hcHBpbmdIYXNoID0gdW5kZWY7CgogICAgIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgIyBTTEEgLi4uCiAgICBteSAlU0xBUHJlZmVyZW5jZXMgICAgID0gKCk7CiAgICBteSAlU0xBTWFwcGluZ1ByZWZzICAgID0gKCk7CiAgICBteSBAU0xBUHJlZmVyZW5jZXNLZXlzID0gcXd7fTsKICAgIG15IEBNYXBwaW5nS2V5c1NMQSAgICAgPSAoCiAgICAgICAgJ05hbWUnLCAgICAgICAgICAgICAgJ0NhbGVuZGFyJywKICAgICAgICAnVmFsaWQnLCAgICAgICAgICAgICAnQ29tbWVudCcsCiAgICAgICAgJ0ZpcnN0UmVzcG9uc2VUaW1lJywgJ0ZpcnN0UmVzcG9uc2VOb3RpZnknLAogICAgICAgICdVcGRhdGVUaW1lJywgICAgICAgICdVcGRhdGVOb3RpZnknLAogICAgICAgICdTb2x1dGlvblRpbWUnLCAgICAgICdTb2x1dGlvbk5vdGlmeScsCiAgICAgICAgJ1R5cGUnLCAgICAgICAgICAgICAgJ01pblRpbWVCZXR3ZWVuSW5jaWRlbnRzJwogICAgKTsKCiAgICBpZiAoICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyktPkdldCgnU0xBUHJlZmVyZW5jZXMnKSApIHsKICAgICAgICAlU0xBUHJlZmVyZW5jZXMgPSAleyAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpLT5HZXQoJ1NMQVByZWZlcmVuY2VzJykgfTsKICAgIH0KICAgIGZvciBteSAkSXRlbSAoIHNvcnQga2V5cyAlU0xBUHJlZmVyZW5jZXMgKSB7CiAgICAgICAgaWYgKAogICAgICAgICAgICAkU0xBUHJlZmVyZW5jZXN7JEl0ZW19LT57U2VsZWN0aW9uU291cmNlfQogICAgICAgICAgICAmJiAkU0xBUHJlZmVyZW5jZXN7JEl0ZW19LT57UHJlZktleX0gPX4gL14oLispSUQkLwogICAgICAgICAgICApCiAgICAgICAgewogICAgICAgICAgICBteSAkTmFtZVBhcnQgPSAkMTsKICAgICAgICAgICAgJFNMQU1hcHBpbmdQcmVmc3skTmFtZVBhcnR9ID0gMTsKICAgICAgICB9CiAgICAgICAgJFNMQU1hcHBpbmdQcmVmc3sgJFNMQVByZWZlcmVuY2VzeyRJdGVtfS0+e1ByZWZLZXl9IH0gPSAxOwogICAgfQoKICAgIGlmICgga2V5cyglU0xBTWFwcGluZ1ByZWZzKSApIHsKICAgICAgICBATWFwcGluZ0tleXNTTEEgPSAoIEBNYXBwaW5nS2V5c1NMQSwga2V5cyglU0xBTWFwcGluZ1ByZWZzKSApOwogICAgfQoKICAgIHB1c2goIEBNYXBwaW5nS2V5c1NMQSwgJ0Fzc2lnbmVkU2VydmljZScgKTsKCiAgICAkSW1wb3J0RXhwb3J0TWFwcGluZ0hhc2gtPntTTEF9ID0gXEBNYXBwaW5nS2V5c1NMQTsKCiAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAjIFNlcnZpY2UgLi4uCiAgICBteSAlU2VydmljZVByZWZlcmVuY2VzICAgICA9ICgpOwogICAgbXkgJVNlcnZpY2VNYXBwaW5nUHJlZnMgICAgPSAoKTsKICAgIG15IEBTZXJ2aWNlUHJlZmVyZW5jZXNLZXlzID0gcXd7fTsKICAgIG15IEBNYXBwaW5nS2V5c1NlcnZpY2UgICAgID0gKAogICAgICAgICdTZXJ2aWNlSUQnLCAnTmFtZScsICdOYW1lU2hvcnQnLCAgICdWYWxpZCcsCiAgICAgICAgJ0NvbW1lbnQnLCAgICdUeXBlJywgJ0NyaXRpY2FsaXR5JywgJ0N1ckluY2lTdGF0ZScKICAgICk7CgogICAgaWYgKCAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpLT5HZXQoJ1NlcnZpY2VQcmVmZXJlbmNlcycpICkgewogICAgICAgICVTZXJ2aWNlUHJlZmVyZW5jZXMgPSAleyAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OkNvbmZpZycpLT5HZXQoJ1NlcnZpY2VQcmVmZXJlbmNlcycpIH07CiAgICB9CiAgICBmb3IgbXkgJEl0ZW0gKCBzb3J0IGtleXMgJVNlcnZpY2VQcmVmZXJlbmNlcyApIHsKICAgICAgICBpZiAoCiAgICAgICAgICAgICRTZXJ2aWNlUHJlZmVyZW5jZXN7JEl0ZW19LT57U2VsZWN0aW9uU291cmNlfQogICAgICAgICAgICAmJiAkU2VydmljZVByZWZlcmVuY2VzeyRJdGVtfS0+e1ByZWZLZXl9ID1+IC9eKC4rKUlEJC8KICAgICAgICAgICAgKQogICAgICAgIHsKICAgICAgICAgICAgbXkgJE5hbWVQYXJ0ID0gJDE7CiAgICAgICAgICAgICRTZXJ2aWNlTWFwcGluZ1ByZWZzeyROYW1lUGFydH0gPSAxOwogICAgICAgIH0KICAgICAgICAkU2VydmljZU1hcHBpbmdQcmVmc3sgJFNlcnZpY2VQcmVmZXJlbmNlc3skSXRlbX0tPntQcmVmS2V5fSB9ID0gMTsKICAgIH0KCiAgICBpZiAoIGtleXMoJVNlcnZpY2VNYXBwaW5nUHJlZnMpICkgewogICAgICAgIEBNYXBwaW5nS2V5c1NlcnZpY2UgPSAoIEBNYXBwaW5nS2V5c1NlcnZpY2UsIGtleXMoJVNlcnZpY2VNYXBwaW5nUHJlZnMpICk7CiAgICB9CgogICAgJEltcG9ydEV4cG9ydE1hcHBpbmdIYXNoLT57U2VydmljZX0gPSBcQE1hcHBpbmdLZXlzU2VydmljZTsKCiAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAjIFNlcnZpY2UyQ3VzdG9tZXJVc2VyIC4uLgogICAgJEltcG9ydEV4cG9ydE1hcHBpbmdIYXNoLT57U2VydmljZTJDdXN0b21lclVzZXJ9ID0KICAgICAgICBbICdDdXN0b21lclVzZXJMb2dpbicsICdTZXJ2aWNlTmFtZScsICdTZXJ2aWNlSUQnLCAnQXNzaWdubWVudEFjdGl2ZScgXTsKCiAgICAjLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAjIGNyZWF0ZSBtYXBwaW5ncy4uLgogICAgZm9yIG15ICRPYmplY3RNYXBwaW5nS2V5ICgga2V5cyAleyRJbXBvcnRFeHBvcnRNYXBwaW5nSGFzaH0gKSB7CgogICAgICAgIG15ICRUZW1wbGF0ZU5hbWUgPSAkT2JqZWN0TWFwcGluZ0tleSAuICIgKGF1dG8tY3JlYXRlZCBtYXApIjsKICAgICAgICBteSAlVGVtcGxhdGVMaXN0ID0gKCk7CgogICAgICAgICMgZ2V0IGNvbmZpZyBvcHRpb24KICAgICAgICBteSAkRm9yY2VDU1ZNYXBwaW5nQ29uZmlndXJhdGlvbiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6Q29uZmlnJyktPkdldCgKICAgICAgICAgICAgJ0ltcG9ydEV4cG9ydDo6U2VydmljZUltcG9ydEV4cG9ydDo6Rm9yY2VDU1ZNYXBwaW5nUmVjcmVhdGlvbicKICAgICAgICApIHx8ICcwJzsKCiAgICAgICAgIyBnZXQgbGlzdCBvZiBhbGwgdGVtcGxhdGVzCiAgICAgICAgbXkgJFRlbXBsYXRlTGlzdFJlZiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQnKS0+VGVtcGxhdGVMaXN0KAogICAgICAgICAgICBPYmplY3QgPT4gJE9iamVjdE1hcHBpbmdLZXksCiAgICAgICAgICAgIEZvcm1hdCA9PiAnQ1NWJywKICAgICAgICAgICAgVXNlcklEID0+IDEsCiAgICAgICAgKTsKCiAgICAgICAgIyBnZXQgZGF0YSBmb3IgZWFjaCB0ZW1wbGF0ZSBhbmQgYnVpbGQgaGFzaCB3aXRoIGtleSA9IHRlbXBsYXRlIG5hbWU7IHZhbHVlID0gdGVtcGxhdGUgSUQKICAgICAgICBpZiAoICRUZW1wbGF0ZUxpc3RSZWYgJiYgcmVmKCRUZW1wbGF0ZUxpc3RSZWYpIGVxICdBUlJBWScgKSB7CiAgICAgICAgICAgIGZvciBteSAkQ3VyclRlbXBsYXRlSUQgKCBAeyRUZW1wbGF0ZUxpc3RSZWZ9ICkgewogICAgICAgICAgICAgICAgbXkgJFRlbXBsYXRlRGF0YVJlZiA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQnKS0+VGVtcGxhdGVHZXQoCiAgICAgICAgICAgICAgICAgICAgVGVtcGxhdGVJRCA9PiAkQ3VyclRlbXBsYXRlSUQsCiAgICAgICAgICAgICAgICAgICAgVXNlcklEICAgICA9PiAxLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAkVGVtcGxhdGVEYXRhUmVmCiAgICAgICAgICAgICAgICAgICAgJiYgcmVmKCRUZW1wbGF0ZURhdGFSZWYpIGVxICdIQVNIJwogICAgICAgICAgICAgICAgICAgICYmICRUZW1wbGF0ZURhdGFSZWYtPntPYmplY3R9CiAgICAgICAgICAgICAgICAgICAgJiYgJFRlbXBsYXRlRGF0YVJlZi0+e05hbWV9CiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICRUZW1wbGF0ZUxpc3R7ICRUZW1wbGF0ZURhdGFSZWYtPntPYmplY3R9IC4gJzo6JyAuICRUZW1wbGF0ZURhdGFSZWYtPntOYW1lfSB9CiAgICAgICAgICAgICAgICAgICAgICAgID0gJEN1cnJUZW1wbGF0ZUlEOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIGFkZCBhIHRlbXBsYXRlCiAgICAgICAgbXkgJFRlbXBsYXRlSUQ7CgogICAgICAgICMgY2hlY2sgaWYgdGVtcGxhdGUgYWxyZWFkeSBleGlzdHMuLi4KICAgICAgICBpZiAoICRUZW1wbGF0ZUxpc3R7ICRPYmplY3RNYXBwaW5nS2V5IC4gJzo6JyAuICRUZW1wbGF0ZU5hbWUgfSApIHsKICAgICAgICAgICAgaWYgKCRGb3JjZUNTVk1hcHBpbmdDb25maWd1cmF0aW9uKSB7CgogICAgICAgICAgICAgICAgIyBkZWxldGUgb2xkIHRlbXBsYXRlCiAgICAgICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0JyktPlRlbXBsYXRlRGVsZXRlKAogICAgICAgICAgICAgICAgICAgIFRlbXBsYXRlSUQgPT4gJFRlbXBsYXRlTGlzdHsgJE9iamVjdE1hcHBpbmdLZXkgLiAnOjonIC4gJFRlbXBsYXRlTmFtZSB9LAogICAgICAgICAgICAgICAgICAgIFVzZXJJRCAgICAgPT4gMSwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgICAgICBQcmlvcml0eSA9PiAnbm90aWNlJywKICAgICAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiQ1NWIG1hcHBpbmcgZGVsZXRlZCBmb3IgcmUtY3JlYXRpb24gPCIKICAgICAgICAgICAgICAgICAgICAgICAgLiAkVGVtcGxhdGVOYW1lCiAgICAgICAgICAgICAgICAgICAgICAgIC4gIj4uIiwKICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgIyBjcmVhdGUgbmV3IHRlbXBsYXRlCiAgICAgICAgICAgICAgICAkVGVtcGxhdGVJRCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQnKS0+VGVtcGxhdGVBZGQoCiAgICAgICAgICAgICAgICAgICAgT2JqZWN0ICA9PiAkT2JqZWN0TWFwcGluZ0tleSwKICAgICAgICAgICAgICAgICAgICBGb3JtYXQgID0+ICdDU1YnLAogICAgICAgICAgICAgICAgICAgIE5hbWUgICAgPT4gJFRlbXBsYXRlTmFtZSwKICAgICAgICAgICAgICAgICAgICBDb21tZW50ID0+ICJBdXRvbWF0aWNhbGx5IGNyZWF0ZWQgZHVyaW5nIFNlcnZpY2VJbXBvcnRFeHBvcnQgaW5zdGFsbGF0aW9uIiwKICAgICAgICAgICAgICAgICAgICBWYWxpZElEID0+IDEsCiAgICAgICAgICAgICAgICAgICAgVXNlcklEICA9PiAxLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpMb2cnKS0+TG9nKAogICAgICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgTWVzc2FnZSAgPT4gIkNTViBtYXBwaW5nIGFscmVhZHkgZXhpc3RzIGFuZCBub3QgcmUtY3JlYXRlZCA8IgogICAgICAgICAgICAgICAgICAgICAgICAuICRUZW1wbGF0ZU5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgLiAiPi4iLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIG5leHQ7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CgogICAgICAgICAgICAjIGNyZWF0ZSBuZXcgdGVtcGxhdGUKICAgICAgICAgICAgJFRlbXBsYXRlSUQgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0JyktPlRlbXBsYXRlQWRkKAogICAgICAgICAgICAgICAgT2JqZWN0ICA9PiAkT2JqZWN0TWFwcGluZ0tleSwKICAgICAgICAgICAgICAgIEZvcm1hdCAgPT4gJ0NTVicsCiAgICAgICAgICAgICAgICBOYW1lICAgID0+ICRUZW1wbGF0ZU5hbWUsCiAgICAgICAgICAgICAgICBDb21tZW50ID0+ICJBdXRvbWF0aWNhbGx5IGNyZWF0ZWQgZHVyaW5nIFNlcnZpY2VJbXBvcnRFeHBvcnQgaW5zdGFsbGF0aW9uIiwKICAgICAgICAgICAgICAgIFZhbGlkSUQgPT4gMSwKICAgICAgICAgICAgICAgIFVzZXJJRCAgPT4gMSwKICAgICAgICAgICAgKTsKICAgICAgICB9CgogICAgICAgIGlmICggISRUZW1wbGF0ZUlEICkgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlICA9PiAiQ291bGQgbm90IGFkZCBtYXBwaW5nIGZvciBvYmplY3QgJE9iamVjdE1hcHBpbmdLZXkiLAogICAgICAgICAgICApOwogICAgICAgICAgICBuZXh0OwogICAgICAgIH0KCiAgICAgICAgbXkgJFNlcnZpY2VNYXBwaW5nRGF0YSA9IHsKICAgICAgICAgICAgU291cmNlU2VydmljZURhdGEgPT4gewogICAgICAgICAgICAgICAgRm9ybWF0RGF0YSA9PiB7CiAgICAgICAgICAgICAgICAgICAgQ29sdW1uU2VwYXJhdG9yID0+ICdTZW1pY29sb24nLAogICAgICAgICAgICAgICAgICAgIENoYXJzZXQgICAgICAgICA9PiAnVVRGLTgnLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIFNlcnZpY2VEYXRhR2V0ID0+IHsKICAgICAgICAgICAgICAgICAgICBUZW1wbGF0ZUlEID0+ICRUZW1wbGF0ZUlELAogICAgICAgICAgICAgICAgICAgIFVzZXJJRCAgICAgPT4gMSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAgICAgICAgfTsKCiAgICAgICAgIyBnZXQgb2JqZWN0IGF0dHJpYnV0ZXMKICAgICAgICBteSAkT2JqZWN0QXR0cmlidXRlTGlzdCA9ICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQnKS0+T2JqZWN0QXR0cmlidXRlc0dldCgKICAgICAgICAgICAgVGVtcGxhdGVJRCA9PiAkU2VydmljZU1hcHBpbmdEYXRhLT57U291cmNlU2VydmljZURhdGF9LT57U2VydmljZURhdGFHZXR9CiAgICAgICAgICAgICAgICAtPntUZW1wbGF0ZUlEfSwKICAgICAgICAgICAgVXNlcklEID0+IDEsCiAgICAgICAgKTsKCiAgICAgICAgbXkgJEF0dHJpYnV0ZVZhbHVlczsKCiAgICAgICAgZm9yIG15ICREZWZhdWx0ICggQHskT2JqZWN0QXR0cmlidXRlTGlzdH0gKSB7CgogICAgICAgICAgICAjIHNldCBzbGEgdHlwZXMKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgJE9iamVjdE1hcHBpbmdLZXkgIGVxICdTTEEnCiAgICAgICAgICAgICAgICAmJiAkRGVmYXVsdC0+e0tleX0gZXEgJ0RlZmF1bHRTTEFUeXBlSUQnCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGlmICggJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06Ok1haW4nKS0+UmVxdWlyZSgnS2VybmVsOjpTeXN0ZW06OkdlbmVyYWxDYXRhbG9nJykgKSB7CiAgICAgICAgICAgICAgICAgICAgJFNlbGYtPntHZW5lcmFsQ2F0YWxvZ09iamVjdH0gPSBLZXJuZWw6OlN5c3RlbTo6R2VuZXJhbENhdGFsb2ctPm5ldyggJXskU2VsZn0gKTsKCiAgICAgICAgICAgICAgICAgICAgaWYgKCAkU2VsZi0+e0dlbmVyYWxDYXRhbG9nT2JqZWN0fSApIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICMgZ2V0IFNMQSB0eXBlIGxpc3QKICAgICAgICAgICAgICAgICAgICAgICAgJFNlbGYtPntTTEFUeXBlTGlzdH0gPSAkU2VsZi0+e0dlbmVyYWxDYXRhbG9nT2JqZWN0fS0+SXRlbUxpc3QoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDbGFzcyA9PiAnSVRTTTo6U0xBOjpUeXBlJywKICAgICAgICAgICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggJFNlbGYtPntTTEFUeXBlTGlzdH0gJiYgcmVmKCAkU2VsZi0+e1NMQVR5cGVMaXN0fSApIGVxICdIQVNIJyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG15ICVUbXBIYXNoID0gcmV2ZXJzZSggJXsgJFNlbGYtPntTTEFUeXBlTGlzdH0gfSApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJFNlbGYtPntSZXZlcnNlU0xBVHlwZUxpc3R9ID0gXCVUbXBIYXNoOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbXkgJFNMQVR5cGVJRDsKICAgICAgICAgICAgICAgIGZvciBteSAkSUQgKCBrZXlzICV7ICRTZWxmLT57U0xBVHlwZUxpc3R9IH0gKSB7CiAgICAgICAgICAgICAgICAgICAgJFNMQVR5cGVJRCA9ICRTZWxmLT57U0xBVHlwZUxpc3R9LT57JElEfTsKICAgICAgICAgICAgICAgICAgICBpZiAoICRTZWxmLT57U0xBVHlwZUxpc3R9LT57JElEfSBlcSAnT3RoZXInICkgewogICAgICAgICAgICAgICAgICAgICAgICAkU0xBVHlwZUlEID0gJElEOwogICAgICAgICAgICAgICAgICAgICAgICBsYXN0OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkQXR0cmlidXRlVmFsdWVzLT57ICREZWZhdWx0LT57S2V5fSB9ID0gJFNMQVR5cGVJRDsKICAgICAgICAgICAgICAgIG5leHQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICMgc2V0IHNlcnZpY2UgdHlwZXMKICAgICAgICAgICAgaWYgKCAkT2JqZWN0TWFwcGluZ0tleSBlcSAnU2VydmljZScgKSB7CiAgICAgICAgICAgICAgICBteSAkQ3JpdGljYWxpdHlJRDsKICAgICAgICAgICAgICAgIG15ICRTZXJ2aWNlVHlwZUlEOwogICAgICAgICAgICAgICAgaWYgKCAkU2VsZi0+e0dlbmVyYWxDYXRhbG9nT2JqZWN0fSApIHsKCiAgICAgICAgICAgICAgICAgICAgIyBnZXQgc2VydmljZSB0eXBlIGxpc3QKICAgICAgICAgICAgICAgICAgICAkU2VsZi0+e1NlcnZpY2VUeXBlTGlzdH0gPSAkU2VsZi0+e0dlbmVyYWxDYXRhbG9nT2JqZWN0fS0+SXRlbUxpc3QoCiAgICAgICAgICAgICAgICAgICAgICAgIENsYXNzID0+ICdJVFNNOjpTZXJ2aWNlOjpUeXBlJywKICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICAgICBpZiAoICRTZWxmLT57U2VydmljZVR5cGVMaXN0fSAmJiAoIHJlZiggJFNlbGYtPntTZXJ2aWNlVHlwZUxpc3R9ICkgZXEgJ0hBU0gnICkgKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgbXkgJVRtcEhhc2ggPSByZXZlcnNlKCAleyAkU2VsZi0+e1NlcnZpY2VUeXBlTGlzdH0gfSApOwogICAgICAgICAgICAgICAgICAgICAgICAkU2VsZi0+e1JldmVyc2VTZXJ2aWNlVHlwZUxpc3R9ID0gXCVUbXBIYXNoOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgIyBnZXQgY3JpdGljYWxpdHkgbGlzdAogICAgICAgICAgICAgICAgICAgIG15ICRJVFNNQ3JpdGljYWxpdHkgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6RHluYW1pY0ZpZWxkJyktPkR5bmFtaWNGaWVsZEdldCgKICAgICAgICAgICAgICAgICAgICAgICAgTmFtZSA9PiAnSVRTTUNyaXRpY2FsaXR5JywKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgIGlmICggJElUU01Dcml0aWNhbGl0eSAmJiAkSVRTTUNyaXRpY2FsaXR5LT57J0ZpZWxkVHlwZSd9IGVxICdEcm9wZG93bicgJiYgJElUU01Dcml0aWNhbGl0eS0+eydPYmplY3RUeXBlJ30gZXEgJ1RpY2tldCcgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRTZWxmLT57Q3JpdGljYWxpdHlMaXN0fSA9ICRJVFNNQ3JpdGljYWxpdHktPnsnQ29uZmlnJ30tPnsnUG9zc2libGVWYWx1ZXMnfTsKICAgICAgICAgICAgICAgICAgICAgICAgbXkgJVRtcEhhc2gyID0gcmV2ZXJzZSggJXsgJFNlbGYtPntDcml0aWNhbGl0eUxpc3R9IH0gKTsKICAgICAgICAgICAgICAgICAgICAgICAgJFNlbGYtPntSZXZlcnNlQ3JpdGljYWxpdHlMaXN0fSA9IFwlVG1wSGFzaDI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICggJERlZmF1bHQtPntLZXl9IGVxICdEZWZhdWx0Q3JpdGljYWxpdHlJRCcgKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIG15ICRJRCAoIGtleXMgJXsgJFNlbGYtPntDcml0aWNhbGl0eUxpc3R9IH0gKSB7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoICRTZWxmLT57Q3JpdGljYWxpdHlMaXN0fS0+eyRJRH0gPX4gL25vcm1hbC8gKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkQ3JpdGljYWxpdHlJRCA9ICRJRDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3Q7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRBdHRyaWJ1dGVWYWx1ZXMtPnsgJERlZmF1bHQtPntLZXl9IH0gPSAkQ3JpdGljYWxpdHlJRDsKICAgICAgICAgICAgICAgICAgICBuZXh0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKCAkRGVmYXVsdC0+e0tleX0gZXEgJ0RlZmF1bHRTZXJ2aWNlVHlwZUlEJyApIHsKICAgICAgICAgICAgICAgICAgICBmb3IgbXkgJElEICgga2V5cyAleyAkU2VsZi0+e1NlcnZpY2VUeXBlTGlzdH0gfSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJFNlcnZpY2VUeXBlSUQgPSAkU2VsZi0+e1NlcnZpY2VUeXBlTGlzdH0tPnskSUR9OwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoICRTZWxmLT57U2VydmljZVR5cGVMaXN0fS0+eyRJRH0gZXEgJ090aGVyJyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRTZXJ2aWNlVHlwZUlEID0gJElEOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgJEF0dHJpYnV0ZVZhbHVlcy0+eyAkRGVmYXVsdC0+e0tleX0gfSA9ICRTZXJ2aWNlVHlwZUlEOwogICAgICAgICAgICAgICAgICAgIG5leHQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJEF0dHJpYnV0ZVZhbHVlcy0+eyAkRGVmYXVsdC0+e0tleX0gfSA9ICREZWZhdWx0LT57SW5wdXR9LT57VmFsdWVEZWZhdWx0fTsKICAgICAgICB9CgogICAgICAgICRTZXJ2aWNlTWFwcGluZ0RhdGEtPntTb3VyY2VTZXJ2aWNlRGF0YX0tPntPYmplY3REYXRhfSA9ICRBdHRyaWJ1dGVWYWx1ZXM7CgogICAgICAgIG15ICREZWZhdWx0TnVtYmVyT2ZBc3NpZ25hYmxlU2VydmljZXMgPQogICAgICAgICAgICAkU2VydmljZU1hcHBpbmdEYXRhLT57U291cmNlU2VydmljZURhdGF9LT57T2JqZWN0RGF0YX0KICAgICAgICAgICAgLT57TnVtYmVyT2ZBc3NpZ25hYmxlU2VydmljZXN9OwoKICAgICAgICBteSAkaSA9IDA7CiAgICAgICAgbXkgQE1hcHBpbmdPYmpEYXRhOwogICAgICAgIGZvciBteSAkS2V5ICggQHsgJEltcG9ydEV4cG9ydE1hcHBpbmdIYXNoLT57JE9iamVjdE1hcHBpbmdLZXl9IH0gKSB7CgogICAgICAgICAgICBteSAlTWFwcGluZ09iamVjdERhdGFIYXNoOwogICAgICAgICAgICAkTWFwcGluZ09iamVjdERhdGFIYXNoe0tleX0gPQogICAgICAgICAgICAgICAgJEltcG9ydEV4cG9ydE1hcHBpbmdIYXNoLT57JE9iamVjdE1hcHBpbmdLZXl9LT5bJGldOwogICAgICAgICAgICBpZiAoICRpID09IDAgKSB7CiAgICAgICAgICAgICAgICAkTWFwcGluZ09iamVjdERhdGFIYXNoe0lkZW50aWZpZXJ9ID0gMTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoICRLZXkgZXEgJ1ZhbGlkJyAmJiAhJEF0dHJpYnV0ZVZhbHVlcy0+e0RlZmF1bHRWYWxpZH0gKSB7CiAgICAgICAgICAgICAgICBuZXh0OwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoICRLZXkgZXEgJ0Fzc2lnbmVkU2VydmljZScgKSB7CiAgICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgICAgIG15ICRDb3VudCA9IDA7CiAgICAgICAgICAgICAgICAgICAgJENvdW50IDwgJERlZmF1bHROdW1iZXJPZkFzc2lnbmFibGVTZXJ2aWNlczsKICAgICAgICAgICAgICAgICAgICAkQ291bnQrKwogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBteSAlTWFwcGluZ09iamVjdERhdGFIYXNoTG9jYWwgPSAoKTsKICAgICAgICAgICAgICAgICAgICAkTWFwcGluZ09iamVjdERhdGFIYXNoTG9jYWx7S2V5fSA9CiAgICAgICAgICAgICAgICAgICAgICAgICdBc3NpZ25lZFNlcnZpY2UnIC4gc3ByaW50ZiggJyUwM3MnLCAkQ291bnQgKTsKICAgICAgICAgICAgICAgICAgICBwdXNoKCBATWFwcGluZ09iakRhdGEsIFwlTWFwcGluZ09iamVjdERhdGFIYXNoTG9jYWwgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHB1c2goIEBNYXBwaW5nT2JqRGF0YSwgXCVNYXBwaW5nT2JqZWN0RGF0YUhhc2ggKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJGkrKzsKICAgICAgICB9CgogICAgICAgICRTZXJ2aWNlTWFwcGluZ0RhdGEtPntTb3VyY2VTZXJ2aWNlRGF0YX0tPntNYXBwaW5nT2JqZWN0RGF0YX0gPQogICAgICAgICAgICBcQE1hcHBpbmdPYmpEYXRhOwoKICAgICAgICBpZiAoCiAgICAgICAgICAgICEkU2VydmljZU1hcHBpbmdEYXRhCiAgICAgICAgICAgIHx8IHJlZiAkU2VydmljZU1hcHBpbmdEYXRhIG5lICdIQVNIJwogICAgICAgICAgICApCiAgICAgICAgewogICAgICAgICAgICAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6TG9nJyktPkxvZygKICAgICAgICAgICAgICAgIFByaW9yaXR5ID0+ICdlcnJvcicsCiAgICAgICAgICAgICAgICBNZXNzYWdlID0+CiAgICAgICAgICAgICAgICAgICAgIk5vIHZhbGlkIG1hcHBpbmcgbGlzdCBmb3VuZCBmb3IgdGVtcGxhdGUgaWQgJFRlbXBsYXRlSUQiLAogICAgICAgICAgICApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAjIHNldCB0aGUgb2JqZWN0IGRhdGEKICAgICAgICBpZiAoCiAgICAgICAgICAgICRTZXJ2aWNlTWFwcGluZ0RhdGEtPntTb3VyY2VTZXJ2aWNlRGF0YX0tPntPYmplY3REYXRhfQogICAgICAgICAgICAmJiByZWYgJFNlcnZpY2VNYXBwaW5nRGF0YS0+e1NvdXJjZVNlcnZpY2VEYXRhfS0+e09iamVjdERhdGF9IGVxICdIQVNIJwogICAgICAgICAgICAmJiAkU2VydmljZU1hcHBpbmdEYXRhLT57U291cmNlU2VydmljZURhdGF9LT57U2VydmljZURhdGFHZXR9CiAgICAgICAgICAgIC0+e1RlbXBsYXRlSUR9CiAgICAgICAgICAgICkKICAgICAgICB7CgogICAgICAgICAgICAjIHNhdmUgb2JqZWN0IGRhdGEKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5PYmplY3REYXRhU2F2ZSgKICAgICAgICAgICAgICAgIFRlbXBsYXRlSUQgPT4KICAgICAgICAgICAgICAgICAgICAkU2VydmljZU1hcHBpbmdEYXRhLT57U291cmNlU2VydmljZURhdGF9LT57U2VydmljZURhdGFHZXR9CiAgICAgICAgICAgICAgICAgICAgLT57VGVtcGxhdGVJRH0sCiAgICAgICAgICAgICAgICBPYmplY3REYXRhID0+CiAgICAgICAgICAgICAgICAgICAgJFNlcnZpY2VNYXBwaW5nRGF0YS0+e1NvdXJjZVNlcnZpY2VEYXRhfS0+e09iamVjdERhdGF9LAogICAgICAgICAgICAgICAgVXNlcklEID0+IDEsCiAgICAgICAgICAgICk7CiAgICAgICAgfQoKICAgICAgICAjIHNldCB0aGUgZm9ybWF0IGRhdGEKICAgICAgICBpZiAoCiAgICAgICAgICAgICRTZXJ2aWNlTWFwcGluZ0RhdGEtPntTb3VyY2VTZXJ2aWNlRGF0YX0tPntGb3JtYXREYXRhfQogICAgICAgICAgICAmJiByZWYgJFNlcnZpY2VNYXBwaW5nRGF0YS0+e1NvdXJjZVNlcnZpY2VEYXRhfS0+e0Zvcm1hdERhdGF9IGVxICdIQVNIJwogICAgICAgICAgICAmJiAkU2VydmljZU1hcHBpbmdEYXRhLT57U291cmNlU2VydmljZURhdGF9LT57U2VydmljZURhdGFHZXR9CiAgICAgICAgICAgIC0+e1RlbXBsYXRlSUR9CiAgICAgICAgICAgICkKICAgICAgICB7CgogICAgICAgICAgICAjIHNhdmUgZm9ybWF0IGRhdGEKICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5Gb3JtYXREYXRhU2F2ZSgKICAgICAgICAgICAgICAgIFRlbXBsYXRlSUQgPT4KICAgICAgICAgICAgICAgICAgICAkU2VydmljZU1hcHBpbmdEYXRhLT57U291cmNlU2VydmljZURhdGF9LT57U2VydmljZURhdGFHZXR9CiAgICAgICAgICAgICAgICAgICAgLT57VGVtcGxhdGVJRH0sCiAgICAgICAgICAgICAgICBGb3JtYXREYXRhID0+CiAgICAgICAgICAgICAgICAgICAgJFNlcnZpY2VNYXBwaW5nRGF0YS0+e1NvdXJjZVNlcnZpY2VEYXRhfS0+e0Zvcm1hdERhdGF9LAogICAgICAgICAgICAgICAgVXNlcklEID0+IDEsCiAgICAgICAgICAgICk7CiAgICAgICAgfQoKICAgICAgICAjIHNldCB0aGUgbWFwcGluZyBvYmplY3QgZGF0YQogICAgICAgIGlmICgKICAgICAgICAgICAgJFNlcnZpY2VNYXBwaW5nRGF0YS0+e1NvdXJjZVNlcnZpY2VEYXRhfS0+e09iamVjdERhdGF9CgogICAgICAgICAgICAjJiYgcmVmICRTZXJ2aWNlTWFwcGluZ0RhdGEtPntNYXBwaW5nT2JqZWN0RGF0YX0gZXEgJ0FSUkFZJwogICAgICAgICAgICAmJiAkU2VydmljZU1hcHBpbmdEYXRhLT57U291cmNlU2VydmljZURhdGF9LT57U2VydmljZURhdGFHZXR9CiAgICAgICAgICAgIC0+e1RlbXBsYXRlSUR9CiAgICAgICAgICAgICkKICAgICAgICB7CgogICAgICAgICAgICAjIGRlbGV0ZSBhbGwgZXhpc3RpbmcgbWFwcGluZyBkYXRhCiAgICAgICAgICAgICRLZXJuZWw6Ok9NLT5HZXQoJ0tlcm5lbDo6U3lzdGVtOjpJbXBvcnRFeHBvcnQnKS0+TWFwcGluZ0RlbGV0ZSgKICAgICAgICAgICAgICAgIFRlbXBsYXRlSUQgPT4KICAgICAgICAgICAgICAgICAgICAkU2VydmljZU1hcHBpbmdEYXRhLT57U291cmNlU2VydmljZURhdGF9LT57U2VydmljZURhdGFHZXR9CiAgICAgICAgICAgICAgICAgICAgLT57VGVtcGxhdGVJRH0sCiAgICAgICAgICAgICAgICBVc2VySUQgPT4gMSwKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICMgYWRkIHRoZSBtYXBwaW5nIG9iamVjdCByb3dzCgogICAgICAgICAgICBmb3IgbXkgJE1hcHBpbmdPYmplY3REYXRhICgKICAgICAgICAgICAgICAgIEB7ICRTZXJ2aWNlTWFwcGluZ0RhdGEtPntTb3VyY2VTZXJ2aWNlRGF0YX0tPntNYXBwaW5nT2JqZWN0RGF0YX0gfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICB7CgogICAgICAgICAgICAgICAgIyBhZGQgYSBuZXcgbWFwcGluZyByb3cKICAgICAgICAgICAgICAgIG15ICRNYXBwaW5nSUQgPSAkS2VybmVsOjpPTS0+R2V0KCdLZXJuZWw6OlN5c3RlbTo6SW1wb3J0RXhwb3J0JyktPk1hcHBpbmdBZGQoCiAgICAgICAgICAgICAgICAgICAgVGVtcGxhdGVJRCA9PgogICAgICAgICAgICAgICAgICAgICAgICAkU2VydmljZU1hcHBpbmdEYXRhLT57U291cmNlU2VydmljZURhdGF9LT57U2VydmljZURhdGFHZXR9CiAgICAgICAgICAgICAgICAgICAgICAgIC0+e1RlbXBsYXRlSUR9LAogICAgICAgICAgICAgICAgICAgIFVzZXJJRCA9PiAxLAogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICAjIGFkZCB0aGUgbWFwcGluZyBvYmplY3QgZGF0YQogICAgICAgICAgICAgICAgJEtlcm5lbDo6T00tPkdldCgnS2VybmVsOjpTeXN0ZW06OkltcG9ydEV4cG9ydCcpLT5NYXBwaW5nT2JqZWN0RGF0YVNhdmUoCiAgICAgICAgICAgICAgICAgICAgTWFwcGluZ0lEICAgICAgICAgPT4gJE1hcHBpbmdJRCwKICAgICAgICAgICAgICAgICAgICBNYXBwaW5nT2JqZWN0RGF0YSA9PiAkTWFwcGluZ09iamVjdERhdGEsCiAgICAgICAgICAgICAgICAgICAgVXNlcklEICAgICAgICAgICAgPT4gMSwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgcmV0dXJuIDE7Cn0KCjE7</File>
    </Filelist>
</otrs_package>